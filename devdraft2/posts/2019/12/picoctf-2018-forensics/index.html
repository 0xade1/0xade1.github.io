<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="[map[name:MindYourPrivacy]]">
<meta name="description" content="forensics, steganography, metadata, headers, fiesystems ...
" />
<meta name="keywords" content=", jq, zsteg, steganography, foremost, pcap, xxd, exiftool, stegsolve, convert, tesseract, python-PIL, magic-header, ext, pwn, DNS" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://0xade1.github.io/devdraft2/posts/2019/12/picoctf-2018-forensics/" />


    <title>
        
            picoCTF 2018 - Forensics :: Poney Island  — Welcome to Pwnie Island
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://0xade1.github.io/devdraft2/main.d5b952c3b0131e8ecd6d80f97c5fae89d216a2c29dfa0754010b808bdb098871.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://0xade1.github.io/devdraft2/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://0xade1.github.io/devdraft2/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://0xade1.github.io/devdraft2/favicon-16x16.png">
    <link rel="manifest" href="https://0xade1.github.io/devdraft2/site.webmanifest">
    <link rel="mask-icon" href="https://0xade1.github.io/devdraft2/safari-pinned-tab.svg" color="#1b1c1d">
    <link rel="shortcut icon" href="https://0xade1.github.io/devdraft2/favicon.ico">
    <meta name="msapplication-TileColor" content="#1b1c1d">
    <meta name="theme-color" content="#1b1c1d">



<meta itemprop="name" content="picoCTF 2018 - Forensics">
<meta itemprop="description" content="forensics, steganography, metadata, headers, fiesystems ...
"><meta itemprop="datePublished" content="2019-12-19T00:54:12+08:00" />
<meta itemprop="dateModified" content="2019-12-19T00:54:12+08:00" />
<meta itemprop="wordCount" content="1538"><meta itemprop="image" content="https://0xade1.github.io/devdraft2"/>
<meta itemprop="keywords" content="jq,zsteg,steganography,foremost,pcap,xxd,exiftool,stegsolve,convert,tesseract,python-PIL,magic-header,ext,pwn,DNS," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://0xade1.github.io/devdraft2"/>

<meta name="twitter:title" content="picoCTF 2018 - Forensics"/>
<meta name="twitter:description" content="forensics, steganography, metadata, headers, fiesystems ...
"/>




    <meta property="og:title" content="picoCTF 2018 - Forensics" />
<meta property="og:description" content="forensics, steganography, metadata, headers, fiesystems ...
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://0xade1.github.io/devdraft2/posts/2019/12/picoctf-2018-forensics/" /><meta property="og:image" content="https://0xade1.github.io/devdraft2"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-12-19T00:54:12+08:00" />
<meta property="article:modified_time" content="2019-12-19T00:54:12+08:00" />
<meta property="og:see_also" content="https://0xade1.github.io/devdraft2/posts/2019/12/picoctf-2018-binary-exploitation/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft2/posts/2019/12/picoctf-2018-cryptography/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft2/posts/2019/12/picoctf-2018-general-skills/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft2/posts/2019/12/picoctf-2018-reversing/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft2/posts/2019/12/picoctf-2018-web-exploitation/" />





    <meta property="article:section" content="picoCTF" />

    <meta property="article:section" content="forensics" />



    <meta property="article:published_time" content="2019-12-19 00:54:12 &#43;0800 &#43;0800" />








    </head>

    
        <body>
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://0xade1.github.io/devdraft2/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text"># cd /root/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://0xade1.github.io/devdraft2/about/">About</a></li><li><a href="https://0xade1.github.io/devdraft2/categories/">Categories</a></li><li><a href="https://0xade1.github.io/devdraft2/posts/">Posts</a></li><li><a href="https://0xade1.github.io/devdraft2/series/">Series</a></li><li><a href="https://0xade1.github.io/devdraft2/tags/">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-lin      ecap="round" stroke-linejoin="round" class="feather feather-calendar">
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
  <line x1="16" y1="2" x2="16" y2="6"></line>
  <line x1="8" y1="2" x2="8" y2="6"></line>
  <line x1="3" y1="10" x2="21" y2="10"></line>
</svg>

  2019-12-18 


  
 |

      

      

      
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft2/categories/picoctf/">picoCTF</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/categories/forensics/">forensics</a></span>
        
        |


      
        |
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft2/series/picoctf/">picoCTF</a></span>
        
        |


      

    </div>

    <article>
      <h1 class="post-title">
        <a href="https://0xade1.github.io/devdraft2/posts/2019/12/picoctf-2018-forensics/">picoCTF 2018 - Forensics</a>
      </h1>

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/jq/">jq</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/zsteg/">zsteg</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/steganography/">steganography</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/foremost/">foremost</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/pcap/">pcap</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/xxd/">xxd</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/exiftool/">exiftool</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/stegsolve/">stegsolve</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/convert/">convert</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/tesseract/">tesseract</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/python-pil/">python-PIL</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/magic-header/">magic-header</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/ext/">ext</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/pwn/">pwn</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft2/tags/dns/">DNS</a></span>
        
    </p>


    </div>

      
        <div class="post-excerpt">forensics, steganography, metadata, headers, fiesystems ...
</div>
      

      
        <hr />
        <aside id="toc">
          <div class="toc-title"></div>

            
            <link rel="stylesheet" href="https://0xade1.github.io/devdraft2/scss/_toc.min.381569c9197e6da109df728dd267dd570bde7f7e967b92d59404483a017f498b00b0434e20302334ff67d09c721024494068c58c94a8a44aa3128e5aef4ef8f0.css" integrity="sha512-OBVpyRl&#43;baEJ33KN0mfdVwvef36We5LVlARIOgF/SYsAsENOIDAjNP9n0JxyECRJQGjFjJSopEqjEo5a70748A==">
             <div class="toc">
                <input id="_toc" type="checkbox" name="_toc">
                <label class="collapse" for="_toc">Table of Contents&nbsp;
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline class="chevron-down" points="6 10 14 18 22 10"></polyline><polyline class="chevron-up" points="22 18 14 10 6 18"></polyline></svg>
                </label>
                <nav id="TableOfContents">
                     <nav id="TableOfContents">
  <ul>
    <li><a href="#forensics-warmup-001">forensics-warmup-001</a></li>
    <li><a href="#forensics-warmup-002">forensics-warmup-002</a></li>
    <li><a href="#desrouleaux">desrouleaux</a></li>
    <li><a href="#reading-between-the-eyes">reading-between-the-eyes</a></li>
    <li><a href="#recovering-from-the-snap">recovering-from-the-snap</a></li>
    <li><a href="#admin-panel">admin-panel</a></li>
    <li><a href="#hex-editor">hex-editor</a></li>
    <li><a href="#truly-an-artist">truly-an-artist</a></li>
    <li><a href="#now-you-dont">now-you-dont</a></li>
    <li><a href="#ext-super-magic">ext-super-magic</a></li>
    <li><a href="#lying-out">lying-out</a></li>
    <li><a href="#whats-my-name">whats-my-name</a></li>
  </ul>
</nav>
                </nav>
             </div>

        </aside>
        <hr />

      <div class="post-content">
        <h2 id="forensics-warmup-001">forensics-warmup-001</h2>
<p>We download a zipfile with the command <code>curl -Ok url</code>. The <code>-k</code> switch allows to by-pass ssl certificates checking when downloading a file in TLS (with https).
we first check the zipfile with the command <code>file</code>: it&rsquo;s indeed effectively a zip so we can unzip and explore the content.
Apparently there is an image, we open it with <code>eog</code> and we can observe the flag</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl -Ok https://&lt;URL&gt;/flag.zip
file flag.zip
unzip flag.zip
eog flag.png
</code></pre></td></tr></table>
</div>
</div><h2 id="forensics-warmup-002">forensics-warmup-002</h2>
<p>We download a png file that we are not able to open with the command <code>eog</code>. There is obviously soething wrong about this file that requires us to investigate with forensics tool. We first do some reconnaissance on the file itself with the command <code>file</code> which informs us that the fyle type is not a png but a jepg file. Simply changing the extension to jpg solves our problem.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">file flag.png
mv flag.png flag.png.jpg
eog flag.png.jpg
</code></pre></td></tr></table>
</div>
</div><h2 id="desrouleaux">desrouleaux</h2>
<p>The user connect with netcat <code>nc</code> on a remote shell and is then prompted to answer a set of multiple questions with a time constraint. Once the user has answered all the questions correctly, he obtains the flag; however upon wrong answer or timeout, he is being kicked-out of the shell and has to re-iterate the process.</p>
<p>All 4 questions are based on the exploration of a json file <code>cat incidents.json</code>
My first approach was to script all the answer, but then I realise that questions are sometime changing, and therefore make it a bit more tricky to copy-paste valid answer.</p>
<p>While I could have scripted using regex extraction, I chose instead a second approach that leverages the command <code>jq</code> followed by copy-paste:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">jq <span style="color:#f1fa8c">&#39;.tickets[].src_ip&#39;</span> incidents.json | sort -r | uniq -c
      <span style="color:#bd93f9">4</span> <span style="color:#f1fa8c">&#34;251.165.34.242&#34;</span>
      <span style="color:#bd93f9">4</span> <span style="color:#f1fa8c">&#34;246.69.53.233&#34;</span>
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;231.205.245.44&#34;</span>
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;215.239.98.18&#34;</span>


jq <span style="color:#f1fa8c">&#39;.tickets[] | select (..| .src_ip? == &#34;215.239.98.18&#34;).dst_ip&#39;</span> incidents.json
<span style="color:#f1fa8c">&#34;231.12.49.241&#34;</span>

jq  <span style="color:#f1fa8c">&#39;.tickets[] | .file_hash + &#34; &#34; + .dst_ip&#39;</span> incidents.json | sort -r | uniq -c
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;f2d2c758fe8853b5 164.217.208.88&#34;</span>
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;8aa16b403ac7de3e 231.12.49.241&#34;</span>
      <span style="color:#bd93f9">3</span> <span style="color:#f1fa8c">&#34;8aa16b403ac7de3e 168.138.219.19&#34;</span>
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;6629fde09ed2dab7 187.229.175.225&#34;</span>
      <span style="color:#bd93f9">2</span> <span style="color:#f1fa8c">&#34;581dc312cc8c16c6 48.173.183.246&#34;</span>
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;33d81fec987b8a8c 48.173.183.246&#34;</span>
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;33d81fec987b8a8c 125.130.154.106&#34;</span>

python -c <span style="color:#f1fa8c">&#39;print 7.0 / 5&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="reading-between-the-eyes">reading-between-the-eyes</h2>
<p><img src="./resources/reading-between-the-eyes/husky.png" alt="husky.png"></p>
<ul>
<li><a href="./resources/reading-between-the-eyes/husky.png">husky.png</a></li>
<li><a href="https://github.com/zed-0xff/zsteg.git">zsteg</a> github repo</li>
</ul>
<p>We download a beautiful husky picture but the flag is hidden somewhere in this image so we have to leverage some forensics tools.</p>
<p>We assume this is a steganography challenge, so we first try to solve this challenge by simply leveraging <code>zsteg</code> command. This command tries basic and common steganography algorithm for us:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">zsteg husky.png | grep picoCTF | cut -d <span style="color:#f1fa8c">&#39;&#34;&#39;</span> -f2
</code></pre></td></tr></table>
</div>
</div><h2 id="recovering-from-the-snap">recovering-from-the-snap</h2>
<p>we download a block device dump file <code>animals.dd</code>. We create a folder to mount the file</p>
<pre tabindex="0"><code>mkdir mnt; mount animals.dd mnt; ls mnt
</code></pre><p>It contains several images but none of them contains an obvious flag.</p>
<p>Before we investigate each image independently, we want to look whether some images have been deleted from the block device
because we know that following the <code>rm</code> command, files are still recoverable unless the disk allocated space has been over-written.
We use <code>foremost animals.dd</code>, and indeed a folder <code>output/jpg/</code> is created and contains deleted images we could recover.
One of the recovered image contains the flag.</p>
<h2 id="admin-panel">admin-panel</h2>
<ul>
<li><a href="./resources/admin-panel/data.pcap">data.pcap</a></li>
</ul>
<p>We download a network packet capture file <a href="./resources/admin-panel/data.pcap">data.pcap</a> which we can open using <code>wireshark</code>. From wireshark, we observe couple of <code>HTTP POST /login</code> requests. We simply leverages the wireshark &ldquo;Follow tcp stream&rdquo; on the second POST /login to observe the login password which actually is the flag</p>
<h2 id="hex-editor">hex-editor</h2>
<p><img src="./resources/hex-editor/hex_editor.jpg" alt="hex_editor.jpg"></p>
<ul>
<li><a href="./resources/hex-editor/hex_editor.jpg">hex_editor.jpg</a></li>
</ul>
<p>We download a cat image that hides a flag. The hint is to used a command such as <code>xxd hexedit bvi</code>. Why a cat image? porbably another hint to pipe a cat command with xxd &hellip; Indeed, the flag is right at the end.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat hex_editor.jpg | xxd
</code></pre></td></tr></table>
</div>
</div><h2 id="truly-an-artist">truly-an-artist</h2>
<p><img src="./resources/truly-an-artist/2018.png" alt="2018.png"></p>
<ul>
<li><a href="./resources/truly-an-artist/2018.png">2018.png</a></li>
<li><a href="https://github.com/zed-0xff/zsteg.git">zsteg</a></li>
</ul>
<p>We have a download link called &ldquo;Meta material&rdquo; pointing to an image 2018.png which apparently contains a flag. However this is just diversion. The image url name &ldquo;meta-material&rdquo;, makes us suspect we have to look for meta-information embedded in the file instead of the file data itself.</p>
<p>We will use <code>exiftool</code> or <code>zsteg</code> to extract meta-information</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">exiftool 2018.jpg | grep pico
</code></pre></td></tr></table>
</div>
</div><p>Another useful tool is <a href="https://github.com/zed-0xff/zsteg.git">zsteg</a> which can be downloaded from git</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">zsteg 2018.jpg | grep pico
</code></pre></td></tr></table>
</div>
</div><h2 id="now-you-dont">now-you-dont</h2>
<ul>
<li><a href="./resources/now-you-dont/nowYouDont.png">nowYouDont.png</a> &ndash;&gt; This image is apparently filled with plain red, but what the eyes can&rsquo;t see, the computer can.</li>
<li><a href="https://github.com/eugenekolo/sec-tools/tree/master/stego/stegsolve">stegsolve</a> git repo</li>
</ul>
<p>The hint is:</p>
<pre tabindex="0"><code>Is it really all one shade of red?
</code></pre><p>To tackle this challenge, we figure out <code>stegsolve</code> can help us get the flag lazily.
Another approach is to create a plain monochramatic red image and then substract it from the original image to get the difference.
The result should contain only pixels with a different color shade then the plain monochromatic image.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#6272a4">#Image size is 857x703</span>
exiftool nowYouDont.png

<span style="color:#6272a4">#first pixel color is #912020FF</span>
convert resources/now-you-dont/nowYouDont.png -crop <span style="color:#f1fa8c">&#39;1x1+100+200&#39;</span> txt:-
<span style="color:#6272a4"># ImageMagick pixel enumeration: 1,1,65535,srgba</span>
<span style="color:#6272a4">#0,0: (37265,8224,8224,65535)  #912020FF  srgba(145,32,32,1)</span>

<span style="color:#6272a4">#create an image canva with the unique color above</span>
convert -size 857x703 canvas:<span style="color:#f1fa8c">&#34;#912020&#34;</span> monochrome.png

<span style="color:#6272a4">#substract the canvas color from the original image</span>
compare nowYouDont.png monochrome.png substracted.png

<span style="color:#6272a4">#Now we should see the flag with eog or do simple OCR with tesseract</span>
eog substracted.png
tesseract substracted.png flag.txt
</code></pre></td></tr></table>
</div>
</div><p>Another approach is to use PIL python image library</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#6272a4">#!/usr/bin/env python</span>
<span style="color:#ff79c6">from</span> PIL <span style="color:#ff79c6">import</span> Image, ImageFile
<span style="color:#ff79c6">from</span> pathlib <span style="color:#ff79c6">import</span> Path

imageFile <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;/root/Documents/ctf_writeups/forensics/resources/now-you-dont/nowYouDont.png&#39;</span>
path <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(Path(imageFile)<span style="color:#ff79c6">.</span>parents[<span style="color:#bd93f9">0</span>])
basename <span style="color:#ff79c6">=</span> Path(imageFile)<span style="color:#ff79c6">.</span>resolve()<span style="color:#ff79c6">.</span>stem

img <span style="color:#ff79c6">=</span> Image<span style="color:#ff79c6">.</span>open(imageFile)
pixels <span style="color:#ff79c6">=</span> img<span style="color:#ff79c6">.</span>load()

(w,  h) <span style="color:#ff79c6">=</span> img<span style="color:#ff79c6">.</span>size
<span style="color:#8be9fd;font-style:italic">print</span> (w, h)
<span style="color:#8be9fd;font-style:italic">print</span> path <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;/&#34;</span> <span style="color:#ff79c6">+</span> basename

<span style="color:#6272a4">#w = 10</span>
<span style="color:#6272a4">#h = 10</span>
colors <span style="color:#ff79c6">=</span> {}

<span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, w):
    <span style="color:#ff79c6">for</span> j <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, h):
        (r, g, b, x) <span style="color:#ff79c6">=</span> pixels[i,j]
        key <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(<span style="color:#8be9fd;font-style:italic">hex</span>(r))<span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(<span style="color:#8be9fd;font-style:italic">hex</span>(g))<span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(<span style="color:#8be9fd;font-style:italic">hex</span>(b))
        <span style="color:#ff79c6">if</span> key <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">in</span> colors<span style="color:#ff79c6">.</span>keys():
            colors[key] <span style="color:#ff79c6">=</span> (r, g, b)
            <span style="color:#8be9fd;font-style:italic">print</span> (key, r, g, b)

background <span style="color:#ff79c6">=</span> (<span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">0</span>)
foreground <span style="color:#ff79c6">=</span> (<span style="color:#bd93f9">255</span>, <span style="color:#bd93f9">255</span>, <span style="color:#bd93f9">255</span>)

<span style="color:#ff79c6">for</span> k <span style="color:#ff79c6">in</span> colors<span style="color:#ff79c6">.</span>keys():
    outimg <span style="color:#ff79c6">=</span> Image<span style="color:#ff79c6">.</span>new(<span style="color:#f1fa8c">&#39;RGB&#39;</span>, (w, h), (<span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">0</span>))
    outpixels <span style="color:#ff79c6">=</span> outimg<span style="color:#ff79c6">.</span>load()
    <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, w):
        <span style="color:#ff79c6">for</span> j <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, h):
            (r, g, b, x) <span style="color:#ff79c6">=</span> pixels[i,j]
            key <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(<span style="color:#8be9fd;font-style:italic">hex</span>(r))<span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(<span style="color:#8be9fd;font-style:italic">hex</span>(g))<span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(<span style="color:#8be9fd;font-style:italic">hex</span>(b))
            <span style="color:#ff79c6">if</span> key <span style="color:#ff79c6">==</span> k:
                outpixels[i, j] <span style="color:#ff79c6">=</span> foreground
    outimg<span style="color:#ff79c6">.</span>save(path <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;/&#34;</span> <span style="color:#ff79c6">+</span> basename <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;_&#34;</span> <span style="color:#ff79c6">+</span> k <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;.png&#34;</span>)
</code></pre></td></tr></table>
</div>
</div><h2 id="ext-super-magic">ext-super-magic</h2>
<ul>
<li><a href="https://www.garykessler.net/library/file_sigs.html">file_sigs</a>: table of magic header signatures</li>
<li><a href="https://superuser.com/questions/239088/whats-a-file-systems-magic-number-in-a-super-block">resource</a>: EXT2 magic header</li>
</ul>
<p>We download a filesystem image file ext-super-magic.img which appears to be corrupted as the <code>file</code> commande cannot identify the filesystem file:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">file ext-super-magic.img
ext-super-magic.img: data
</code></pre></td></tr></table>
</div>
</div><p>Hints are provided <a href="https://www.garykessler.net/library/file_sigs.html">here</a>: if you are using a Linux/Mac OS X/Unix system, you can use the <code>file</code> command to determine the file type based upon the file signature, per the system&rsquo;s <code>magic</code> file.</p>
<p>Googling &ldquo;ext2 magic number&rdquo;, we found this <a href="https://superuser.com/questions/239088/whats-a-file-systems-magic-number-in-a-super-block">resource</a>:
For example, an ext2/ext3/ext4 filesystem always has the bytes <code>0x53 0xEF</code> at positions <strong>1080–1081</strong>.</p>
<p>So theoretically we just have to patch bytes 1080-1081 with value 0x53EF to have our file being recognized as Ext filesystem</p>
<p>We can use xxd to swiftly patch manually the file:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cp ext-super-magic.img ext-patched.img
<span style="color:#6272a4">#BEFORE: seek 16 bits at offset 1080</span>
xxd -s <span style="color:#bd93f9">1080</span> -l <span style="color:#bd93f9">16</span>  ext-patched.img
00000438: <span style="color:#bd93f9">0000</span> <span style="color:#bd93f9">0100</span> <span style="color:#bd93f9">0100</span> <span style="color:#bd93f9">0000</span> b328 995c <span style="color:#bd93f9">0000</span> <span style="color:#bd93f9">0000</span>  S........<span style="color:#ff79c6">(</span>.<span style="color:#f1fa8c">\.</span>...
<span style="color:#6272a4">#PATCH</span>
<span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#39;00000438: 53EF&#39;</span> | xxd -r - ext-patched.img
<span style="color:#6272a4">#AFTER</span>
xxd -s <span style="color:#bd93f9">1080</span> -l <span style="color:#bd93f9">16</span>  ext-patched
00000438: 53ef <span style="color:#bd93f9">0100</span> <span style="color:#bd93f9">0100</span> <span style="color:#bd93f9">0000</span> b328 995c <span style="color:#bd93f9">0000</span> <span style="color:#bd93f9">0000</span>  S........<span style="color:#ff79c6">(</span>.<span style="color:#f1fa8c">\.</span>...
</code></pre></td></tr></table>
</div>
</div><p>Alternatively, we can use python pwn library in a file patch.py</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#ff79c6">import</span> pwn

<span style="color:#ff79c6">with</span> <span style="color:#8be9fd;font-style:italic">open</span>(<span style="color:#f1fa8c">&#39;./ext-super-magic.img&#39;</span>, <span style="color:#f1fa8c">&#39;rb&#39;</span>) <span style="color:#ff79c6">as</span> f:
  data <span style="color:#ff79c6">=</span> f<span style="color:#ff79c6">.</span>read()

<span style="color:#8be9fd;font-style:italic">print</span> pwn<span style="color:#ff79c6">.</span>enhex(data[<span style="color:#bd93f9">1024</span><span style="color:#ff79c6">+</span><span style="color:#bd93f9">56</span>:<span style="color:#bd93f9">1024</span><span style="color:#ff79c6">+</span><span style="color:#bd93f9">56</span><span style="color:#ff79c6">+</span><span style="color:#bd93f9">2</span>])

data <span style="color:#ff79c6">=</span> data[:<span style="color:#bd93f9">1024</span><span style="color:#ff79c6">+</span><span style="color:#bd93f9">56</span>] <span style="color:#ff79c6">+</span> p16(<span style="color:#bd93f9">0xEF53</span>) <span style="color:#ff79c6">+</span> data[<span style="color:#bd93f9">1024</span><span style="color:#ff79c6">+</span><span style="color:#bd93f9">56</span><span style="color:#ff79c6">+</span><span style="color:#bd93f9">2</span>:]

<span style="color:#ff79c6">with</span> <span style="color:#8be9fd;font-style:italic">open</span>(<span style="color:#f1fa8c">&#39;fixed.img&#39;</span>, <span style="color:#f1fa8c">&#39;wb&#39;</span>) <span style="color:#ff79c6">as</span> f:
  f<span style="color:#ff79c6">.</span>write(data)
</code></pre></td></tr></table>
</div>
</div><h2 id="lying-out">lying-out</h2>
<p><img src="./resources/lying-out/traffic.png" alt="traffic.png"></p>
<p>You&rsquo;ll need to consult the file <a href="./resources/lying-out/traffic.png">traffic.png</a> to answer the following questions:</p>
<pre><code>Which of these logs have significantly higher traffic than is usual for their time of day?
You can see usual traffic on the attached plot. There may be multiple logs with higher than usual traffic,
so answer all of them! Give your answer as a list of `log_ID` values separated by spaces.
For example, if you want to answer that logs 2 and 7 are the ones with higher than usual traffic, type 2 7.
</code></pre>
<p>table:</p>
<pre><code>log_ID time num_IPs
0 0 00:15:00 9786
1 1 02:00:00 10235
2 2 02:15:00 11594
3 3 03:30:00 9685
4 4 04:30:00 9992
5 5 05:15:00 10005
6 6 05:45:00 11642
7 7 06:30:00 10151
8 8 08:45:00 10326
9 9 10:45:00 10176
10 10 15:30:00 11620
11 11 15:45:00 10163
12 12 16:30:00 11707
13 13 19:30:00 11847
2 6 10 12
Correct!
</code></pre>
<h2 id="whats-my-name">whats-my-name</h2>
<ul>
<li><a href="./resources/whats-my-name/myname.pcap">myname.pcap</a></li>
</ul>
<p>Some Hints, points us to investigate DNS protocol in the above pcap file</p>
<p>Opening the file with wireshark, we can then use the <code>dnsserver</code> filter to get rid of all other protocols. Remain two DNS messages; one of them contains the flag in cleartext</p>
<p>we could have just used the <code>strings</code> command but it is interesting</p>

      </div>
    </article>

    <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=picoCTF%202018%20-%20Forensics&amp;caption=picoCTF%202018%20-%20Forensics&amp;canonicalUrl=https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=picoCTF%202018%20-%20Forensics&amp;body=https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f&amp;media=https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f;description=picoCTF%202018%20-%20Forensics" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f&amp;title=picoCTF%202018%20-%20Forensics&amp;summary=picoCTF%202018%20-%20Forensics&amp;source=https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f&amp;resubmit=true&amp;title=picoCTF%202018%20-%20Forensics" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f;title=picoCTF%202018%20-%20Forensics" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=picoCTF%202018%20-%20Forensics%20https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f&amp;t=picoCTF%202018%20-%20Forensics" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=picoCTF%202018%20-%20Forensics&amp;url=https%3a%2f%2f0xade1.github.io%2fdevdraft2%2fposts%2f2019%2f12%2fpicoctf-2018-forensics%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>
          <hr />

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
        </div>

        <div class="pagination__buttons">
          
            <a href="https://0xade1.github.io/devdraft2/posts/2019/12/picoctf-2018-general-skills/" class="button previous">
                <span class="button__icon">←</span>
                <span class="button__text">picoCTF 2018 - General Skills</span>
            </a>
          

          
            <a href="https://0xade1.github.io/devdraft2/posts/2019/12/picoctf-2018-cryptography/" class="button next">
                <span class="button__text">picoCTF 2018 - Cryptography</span>
                <span class="button__icon">→</span>
            </a>
          
        </div>
      </div>
    

      <hr />

        










  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
            <span><a href="https://0xade1.github.io/devdraft2/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084;</span>
          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="https://0xade1.github.io/devdraft2/bundle.min.7015b843bafc394b6094818242f153559f5ca94b331b9faaf6132652c59619aefe60ae36e1637f7ee14fd953892639f466c25095c36d42203a1c195313e93212.js" integrity="sha512-cBW4Q7r8OUtglIGCQvFTVZ9cqUszG5&#43;q9hMmUsWWGa7&#43;YK424WN/fuFP2VOJJjn0ZsJQlcNtQiA6HBlTE&#43;kyEg=="></script>



    </body>
</html>
