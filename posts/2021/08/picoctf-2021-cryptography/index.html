<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="[map[name:MindYourPrivacy]]"><meta name=description content="RSA AES rot13
"><meta name=keywords content=",rsa,aes,pycipher,vigenere,rot13,john,caesar,substitution,ngrams"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://0xade1.github.io/posts/2021/08/picoctf-2021-cryptography/><title>picoCTF 2021 - Cryptography :: Poney Island — Welcome to Pwnie Island</title><link rel=stylesheet href=https://0xade1.github.io/main.cd71908e0ee72a8733aeb9216405d664d48b2598bb3b750ec082bbf1b5b458cc.css integrity="sha256-zXGQjg7nKoczrrkhZAXWZNSLJZi7O3UOwIK78bW0WMw="><link rel=apple-touch-icon sizes=180x180 href=https://0xade1.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://0xade1.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://0xade1.github.io/favicon-16x16.png><link rel=manifest href=https://0xade1.github.io/site.webmanifest><link rel=mask-icon href=https://0xade1.github.io/safari-pinned-tab.svg color><link rel="shortcut icon" href=https://0xade1.github.io/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="picoCTF 2021 - Cryptography"><meta itemprop=description content="RSA AES rot13
"><meta itemprop=datePublished content="2021-08-16T00:00:00+00:00"><meta itemprop=dateModified content="2021-08-16T00:00:00+00:00"><meta itemprop=wordCount content="658"><meta itemprop=image content="https://0xade1.github.io"><meta itemprop=keywords content="rsa,aes,pycipher,vigenere,rot13,john,caesar,substitution,ngrams,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://0xade1.github.io"><meta name=twitter:title content="picoCTF 2021 - Cryptography"><meta name=twitter:description content="RSA AES rot13
"><meta property="og:title" content="picoCTF 2021 - Cryptography"><meta property="og:description" content="RSA AES rot13
"><meta property="og:type" content="article"><meta property="og:url" content="https://0xade1.github.io/posts/2021/08/picoctf-2021-cryptography/"><meta property="og:image" content="https://0xade1.github.io"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-08-16T00:00:00+00:00"><meta property="article:modified_time" content="2021-08-16T00:00:00+00:00"><meta property="og:see_also" content="https://0xade1.github.io/posts/2022/08/picoctf2019-cryptography/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2022/08/picoctf2019-forensics/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2022/08/picoctf2019-general-skills/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2022/08/picoctf2019-reverse-engineering/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2022/08/picoctf2019-web-exploitation/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2021/08/picoctf-2021-binary-exploitation/"><meta property="article:section" content="picoCTF"><meta property="article:section" content="cryptography"><meta property="article:published_time" content="2021-08-16 00:00:00 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=https://0xade1.github.io/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text># cd /root/</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://0xade1.github.io/about/>About</a></li><li><a href=https://0xade1.github.io/categories/>Categories</a></li><li><a href=https://0xade1.github.io/posts/>Posts</a></li><li><a href=https://0xade1.github.io/series/>Series</a></li><li><a href=https://0xade1.github.io/tags/>Tags</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p></p></div><article><h1 class=post-title><a href=https://0xade1.github.io/posts/2021/08/picoctf-2021-cryptography/>picoCTF 2021 - Cryptography</a></h1><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://0xade1.github.io/tags/rsa/>rsa</a></span>
<span class=tag><a href=https://0xade1.github.io/tags/aes/>aes</a></span>
<span class=tag><a href=https://0xade1.github.io/tags/pycipher/>pycipher</a></span>
<span class=tag><a href=https://0xade1.github.io/tags/vigenere/>vigenere</a></span>
<span class=tag><a href=https://0xade1.github.io/tags/rot13/>rot13</a></span>
<span class=tag><a href=https://0xade1.github.io/tags/john/>john</a></span>
<span class=tag><a href=https://0xade1.github.io/tags/caesar/>caesar</a></span>
<span class=tag><a href=https://0xade1.github.io/tags/substitution/>substitution</a></span>
<span class=tag><a href=https://0xade1.github.io/tags/ngrams/>ngrams</a></span></p></div><div class=post-excerpt>RSA AES rot13</div><hr><aside id=toc><div class=toc-title></div><link rel=stylesheet href=https://0xade1.github.io/scss/_toc.min.381569c9197e6da109df728dd267dd570bde7f7e967b92d59404483a017f498b00b0434e20302334ff67d09c721024494068c58c94a8a44aa3128e5aef4ef8f0.css integrity="sha512-OBVpyRl+baEJ33KN0mfdVwvef36We5LVlARIOgF/SYsAsENOIDAjNP9n0JxyECRJQGjFjJSopEqjEo5a70748A=="><div class=toc><input id=_toc type=checkbox name=_toc>
<label class=collapse for=_toc>Table of Contents&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline class="chevron-down" points="6 10 14 18 22 10"/><polyline class="chevron-up" points="22 18 14 10 6 18"/></svg></label><nav id=TableOfContents><nav id=TableOfContents><ul><li><a href=#mod-26>Mod 26</a></li><li><a href=#mind-your-ps-and-qs>Mind your Ps and Qs</a></li><li><a href=#easy-peasy>Easy Peasy</a></li></ul></nav></nav></div></aside><hr><div class=post-content><h2 id=mod-26>Mod 26</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;cvpbPGS{arkg_gvzr_V&#39;yy_gel_2_ebhaqf_bs_ebg13_hyLicInt}&#34;</span> | tr <span style=color:#f1fa8c>&#39;[n-za-m]&#39;</span> <span style=color:#f1fa8c>&#39;[a-z]&#39;</span> | tr <span style=color:#f1fa8c>&#39;[N-ZA-M]&#39;</span> <span style=color:#f1fa8c>&#39;[A-Z]&#39;</span>
</span></span></code></pre></div><h2 id=mind-your-ps-and-qs>Mind your Ps and Qs</h2><pre><code>Decrypt my super sick RSA:
c: 861270243527190895777142537838333832920579264010533029282104230006461420086153423
n: 1311097532562595991877980619849724606784164430105441327897358800116889057763413423
e: 65537
</code></pre><p>if n is small then it can be factorized on <a href="http://factordb.com/index.php?query=831416828080417866340504968188990032810316193533653516022175784399720141076262857">factordb.com</a></p><p>FactorDB is also available in python with <code>pip3 install factordb-pycli</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=display:flex><span><span style=color:#ff79c6>from</span> factordb.factordb <span style=color:#ff79c6>import</span> FactorDB
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>n <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1311097532562595991877980619849724606784164430105441327897358800116889057763413423</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>f <span style=color:#ff79c6>=</span> FactorDB(n)
</span></span><span style=display:flex><span>f<span style=color:#ff79c6>.</span>connect()
</span></span><span style=display:flex><span>p, q <span style=color:#ff79c6>=</span> f<span style=color:#ff79c6>.</span>get_factor_list()
</span></span></code></pre></div><p>Once factorized, we can calculate the totient ph and perform some arithmetic with an optimized C-coded python library <code>pip3 install gmpy2</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=display:flex><span>ph <span style=color:#ff79c6>=</span> (p<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>)<span style=color:#ff79c6>*</span>(q<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> gmpy2
</span></span><span style=display:flex><span>c <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>861270243527190895777142537838333832920579264010533029282104230006461420086153423</span>
</span></span><span style=display:flex><span>e <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>65537</span>
</span></span><span style=display:flex><span>d <span style=color:#ff79c6>=</span> gmpy2<span style=color:#ff79c6>.</span>invert(e, ph)
</span></span><span style=display:flex><span>plaintext <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>pow</span>(c, d, n)
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#8be9fd;font-style:italic>bytearray</span><span style=color:#ff79c6>.</span>fromhex(<span style=color:#8be9fd;font-style:italic>hex</span>(plaintext)[<span style=color:#bd93f9>2</span>:])<span style=color:#ff79c6>.</span>decode())
</span></span></code></pre></div><h2 id=easy-peasy>Easy Peasy</h2><p>Running the program below shows a 32 bytes HEX representation of the encrypted flag.
A custom input of 32 * &lsquo;A&rsquo; will generate the encrypted version of our custom input.</p><pre><code>python -c &quot;print 'A'*32&quot; | nc mercury.picoctf.net 36981
</code></pre><p>output:</p><pre><code>******************Welcome to our OTP implementation!******************
This is the encrypted flag!
5541103a246e415e036c4c5f0e3d415a513e4a560050644859536b4f57003d4c

What data would you like to encrypt? Here ya go!
70207f1d3923751d3978762a741416131d3922711d3923701d3925751d397075

What data would you like to encrypt?
</code></pre><p>Download the source code otp.py and execute, notice we need to create a key and a flag files, then open otp.py and notice the key size</p><pre><code>curl -LO https://mercury.picoctf.net/static/6920807ae08f883dbb50f6f301f92684/otp.py
python -c &quot;print 'A'*32&quot; &gt; flag
python -c &quot;print 'A'*50000&quot; &gt; key
python3 otp.py
</code></pre><p>Audit the source code and notice this is an XOR encryption.
There is a rule in cryptography to never reuse a key for Vigenere or equivalent algorithm because encrypt and decrypt methods are the same.</p><p>The simplest solution to our problem is to encrypt the encrypted message with the exact same key to retrieve the plaintext.
However, the key is being rotated at each encryption and will be reused only every 50000 bytes.</p><pre><code>      |&lt;---- key size = 50000 ---------&gt;|&lt;------- same key reused -------&gt;| etc ....
      |&lt;-- 32 bytes --&gt;|&lt;- 50000 - 32 -&gt;|&lt;-- 32 bytes --&gt;|&lt;- 50000 - 32 -&gt;|
L1    | plaintext flag | whatever junk  | encrypted flag | whatever junk  |
L2    | key[0:32]      |  key[32:50000] | key[0:32]      | key[32:50000]  |
L1^L2 | encrypted flag | encrypted junk | plaintext flag | encrypted junk |
</code></pre><p>We can use this code to send the junk message of size (50000-32) followed by the unhexified encrypted flag</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=display:flex><span><span style=color:#6272a4>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> pwn
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> re
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>get_process</span>():
</span></span><span style=display:flex><span>    h , p <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;mercury.picoctf.net&#39;</span>, <span style=color:#bd93f9>36981</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>#return pwn.remote(h, p)</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> pwn<span style=color:#ff79c6>.</span>process(<span style=color:#f1fa8c>&#39;./otp.py&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>junk</span>():
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> (<span style=color:#f1fa8c>&#39;A&#39;</span> <span style=color:#ff79c6>*</span> (<span style=color:#bd93f9>50000</span> <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>32</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>unhex</span>(encrypted_flag):
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#f1fa8c>&#39;&#39;</span><span style=color:#ff79c6>.</span>join([<span style=color:#8be9fd;font-style:italic>chr</span>(<span style=color:#8be9fd;font-style:italic>int</span>(encrypted_flag[i:i<span style=color:#ff79c6>+</span><span style=color:#bd93f9>2</span>], <span style=color:#bd93f9>16</span>)) <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>64</span>, <span style=color:#bd93f9>2</span>)])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p <span style=color:#ff79c6>=</span> get_process()
</span></span><span style=display:flex><span>prompt <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span>recvuntil(<span style=color:#f1fa8c>&#34;like to encrypt?&#34;</span>)
</span></span><span style=display:flex><span>encrypted_flag <span style=color:#ff79c6>=</span> re<span style=color:#ff79c6>.</span>findall(<span style=color:#f1fa8c>&#34;This is the encrypted flag!</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>([a-f0-9]</span><span style=color:#f1fa8c>{64}</span><span style=color:#f1fa8c>)</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, prompt<span style=color:#ff79c6>.</span>decode())[<span style=color:#bd93f9>0</span>]
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#39;encrypted_flag&#39;</span>, encrypted_flag, unhex(encrypted_flag))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#ff79c6>.</span>sendline(junk())
</span></span><span style=display:flex><span>prompt <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span>recvuntil(<span style=color:#f1fa8c>&#34;like to encrypt?&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#ff79c6>.</span>sendline(unhex(encrypted_flag))
</span></span><span style=display:flex><span>prompt <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span>recvuntil(<span style=color:#f1fa8c>&#34;like to encrypt?&#34;</span>)
</span></span><span style=display:flex><span>output <span style=color:#ff79c6>=</span> re<span style=color:#ff79c6>.</span>findall(<span style=color:#f1fa8c>&#34;Here ya go!</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>([a-f0-9]*)</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, prompt<span style=color:#ff79c6>.</span>decode())[<span style=color:#bd93f9>0</span>]
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#39;plaintext_flag&#39;</span>, unhex(output))
</span></span></code></pre></div><p>Another way to proceed is to leverage XOR arithmetic with a separate message (e.g sequence of 32 &lsquo;A&rsquo;a) instead of passing the unhexified flag:</p><pre><code>XOR encryption rule:
    plaintext_flag  ^ key = encrypted_flag
    plaintext_aaaa  ^ key = encrypted_aaaa
is equivalent to:
    key = plaintext_aaaa ^ encrypted_aaaa
    key = plaintext_flag ^ encrypted_aaaa
Therefore:
    plaintext_flag = encrypted_flag ^ key
    plaintext_flag = encrypted_flag ^ plaintext_aaaa ^ encrypted_aaaa
</code></pre><p>In python:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=display:flex><span><span style=color:#6272a4>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> pwn
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> re
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>get_process</span>():
</span></span><span style=display:flex><span>    h , p <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;mercury.picoctf.net&#39;</span>, <span style=color:#bd93f9>36981</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>#return pwn.remote(h, p)</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> pwn<span style=color:#ff79c6>.</span>process(<span style=color:#f1fa8c>&#39;./otp.py&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>junk</span>():
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> (<span style=color:#f1fa8c>&#39;A&#39;</span> <span style=color:#ff79c6>*</span> (<span style=color:#bd93f9>50000</span> <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>32</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>unhex</span>(encrypted_flag):
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#f1fa8c>&#39;&#39;</span><span style=color:#ff79c6>.</span>join([<span style=color:#8be9fd;font-style:italic>chr</span>(<span style=color:#8be9fd;font-style:italic>int</span>(encrypted_flag[i:i<span style=color:#ff79c6>+</span><span style=color:#bd93f9>2</span>], <span style=color:#bd93f9>16</span>)) <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>64</span>, <span style=color:#bd93f9>2</span>)])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p <span style=color:#ff79c6>=</span> get_process()
</span></span><span style=display:flex><span>prompt <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span>recvuntil(<span style=color:#f1fa8c>&#34;like to encrypt?&#34;</span>)
</span></span><span style=display:flex><span>encrypted_flag <span style=color:#ff79c6>=</span> re<span style=color:#ff79c6>.</span>findall(<span style=color:#f1fa8c>&#34;This is the encrypted flag!</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>([a-f0-9]</span><span style=color:#f1fa8c>{64}</span><span style=color:#f1fa8c>)</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, prompt<span style=color:#ff79c6>.</span>decode())[<span style=color:#bd93f9>0</span>]
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#39;encrypted_flag&#39;</span>, encrypted_flag, unhex(encrypted_flag))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#ff79c6>.</span>sendline(junk())
</span></span><span style=display:flex><span>prompt <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span>recvuntil(<span style=color:#f1fa8c>&#34;like to encrypt?&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plaintext_aaaa <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;A&#39;</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>32</span>
</span></span><span style=display:flex><span>p<span style=color:#ff79c6>.</span>sendline(plaintext_aaaa)
</span></span><span style=display:flex><span>prompt <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span>recvuntil(<span style=color:#f1fa8c>&#34;like to encrypt?&#34;</span>)
</span></span><span style=display:flex><span>encrypted_aaaa <span style=color:#ff79c6>=</span> re<span style=color:#ff79c6>.</span>findall(<span style=color:#f1fa8c>&#34;Here ya go!</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>([a-f0-9]*)</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, prompt<span style=color:#ff79c6>.</span>decode())[<span style=color:#bd93f9>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plaintext_aaaa <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>list</span>(<span style=color:#8be9fd;font-style:italic>map</span>(<span style=color:#ff79c6>lambda</span> a: <span style=color:#8be9fd;font-style:italic>ord</span>(a),  plaintext_aaaa))
</span></span><span style=display:flex><span>encrypted_flag <span style=color:#ff79c6>=</span> [<span style=color:#8be9fd;font-style:italic>int</span>(encrypted_flag[i:i<span style=color:#ff79c6>+</span><span style=color:#bd93f9>2</span>], <span style=color:#bd93f9>16</span>) <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#8be9fd;font-style:italic>len</span>(encrypted_flag), <span style=color:#bd93f9>2</span>)]
</span></span><span style=display:flex><span>encrypted_aaaa <span style=color:#ff79c6>=</span> [<span style=color:#8be9fd;font-style:italic>int</span>(encrypted_aaaa[i:i<span style=color:#ff79c6>+</span><span style=color:#bd93f9>2</span>], <span style=color:#bd93f9>16</span>) <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#8be9fd;font-style:italic>len</span>(encrypted_aaaa), <span style=color:#bd93f9>2</span>)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plaintext_flag <span style=color:#ff79c6>=</span> [<span style=color:#8be9fd;font-style:italic>chr</span>(encrypted_flag[i] <span style=color:#ff79c6>^</span> encrypted_aaaa[i] <span style=color:#ff79c6>^</span> plaintext_aaaa[i]) <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#8be9fd;font-style:italic>len</span>(encrypted_flag), <span style=color:#bd93f9>1</span>)]
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#39;plaintext_flag&#39;</span>, <span style=color:#f1fa8c>&#39;&#39;</span><span style=color:#ff79c6>.</span>join(plaintext_flag))
</span></span></code></pre></div><p>To get the real flag, simply invert the commented lines to match the below:</p><pre><code>return pwn.remote(h, p)
#return pwn.process('./otp.py')
</code></pre></div></article><hr><div class=post-info><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg><span class=tag><a href=https://0xade1.github.io/series/picoctf/>picoCTF</a></span><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg><span class=tag><a href=https://0xade1.github.io/categories/picoctf/>picoCTF</a></span>
<span class=tag><a href=https://0xade1.github.io/categories/cryptography/>cryptography</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>658 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2021-08-16</p></div><hr><div class=sharing-buttons><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f" target=_blank rel=noopener aria-label title="Share on facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f" target=_blank rel=noopener aria-label title="Share on twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=picoCTF%202021%20-%20Cryptography&amp;caption=picoCTF%202021%20-%20Cryptography&amp;canonicalUrl=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f" target=_blank rel=noopener aria-label title="Share on tumblr"><div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093.0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941.0 9.999.0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=picoCTF%202021%20-%20Cryptography&amp;body=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f" target=_self rel=noopener aria-label title="Share via email"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></div></div></a><a class=resp-sharing-button__link href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f&amp;media=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f;description=picoCTF%202021%20-%20Cryptography" target=_blank rel=noopener aria-label title="Share on pinterest"><div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12.017.0C5.396.0.029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024.0 1.518.769 1.518 1.688.0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128.0 3.768-2.245 3.768-5.487.0-2.861-2.063-4.869-5.008-4.869-3.41.0-5.409 2.562-5.409 5.199.0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646.0-3.776 2.748-7.252 7.92-7.252 4.158.0 7.392 2.967 7.392 6.923.0 4.135-2.607 7.462-6.233 7.462-1.214.0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607.0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017.0z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f&amp;title=picoCTF%202021%20-%20Cryptography&amp;summary=picoCTF%202021%20-%20Cryptography&amp;source=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f" target=_blank rel=noopener aria-label title="Share on linkedin"><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f&amp;resubmit=true&amp;title=picoCTF%202021%20-%20Cryptography" target=_blank rel=noopener aria-label title="Share on reddit"><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f;title=picoCTF%202021%20-%20Cryptography" target=_blank rel=noopener aria-label title="Share on xing"><div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg></div></div></a><a class=resp-sharing-button__link href="whatsapp://send?text=picoCTF%202021%20-%20Cryptography%20https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f" target=_blank rel=noopener aria-label title="Share on whatsapp"><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893a11.821 11.821.0 00-3.48-8.413z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f&amp;t=picoCTF%202021%20-%20Cryptography" target=_blank rel=noopener aria-label title="Share on hacker news"><div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://telegram.me/share/url?text=picoCTF%202021%20-%20Cryptography&amp;url=https%3a%2f%2f0xade1.github.io%2fposts%2f2021%2f08%2fpicoctf-2021-cryptography%2f" target=_blank rel=noopener aria-label title="Share on telegram"><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></div></div></a></div><div class=pagination><hr><div class=pagination__buttons><a href=https://0xade1.github.io/posts/2021/08/picoctf-2021-binary-exploitation/ class="button next"><span class=button__icon>←</span>
<span class=button__text>picoCTF 2021 - Binary Exploitation</span></a>
<a href=https://0xade1.github.io/posts/2021/08/picoctf-2021-forensics/ class="button previous"><span class=button__text>picoCTF 2021 - Forensics</span>
<span class=button__icon>→</span></a></div><hr></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2023</span>
<span><a href=https://0xade1.github.io></a></span>
<span></span>
<span><a href=https://0xade1.github.io/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span><span>Made with &#10084;</span></div></div></footer></div><script type=text/javascript src=https://0xade1.github.io/bundle.min.4037dc94fd1565c4fd3354e2b4a2d1ff11842c906242435350b4d2d8d6e8b7890da46c0a865173f543a6161c1f4d1c94147f1b907db36489fc2bf5e20d4af75c.js integrity="sha512-QDfclP0VZcT9M1TitKLR/xGELJBiQkNTULTS2Nbot4kNpGwKhlFz9UOmFhwfTRyUFH8bkH2zZIn8K/XiDUr3XA=="></script><div id=fastSearch><ul id=searchResults></ul><input id=searchInput tabindex=0></div><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js></script>
<script src=https://0xade1.github.io/js/fastsearch.js></script></body></html>