<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="ie=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=author content="[map[name:MindYourPrivacy]]">
<meta name=description content="Short description of your site here">
<meta name=keywords content=",untagged">
<meta name=robots content="noodp">
<meta name=theme-color content>
<link rel=canonical href=https://0xade1.github.io/posts/2022/08/picoctf2019/>
<title>
PicoCTF2019 :: Poney Island — Welcome to Pwnie Island
</title>
<link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css>
<link rel=stylesheet href=https://0xade1.github.io/main.d5b952c3b0131e8ecd6d80f97c5fae89d216a2c29dfa0754010b808bdb098871.css>
<link rel=apple-touch-icon sizes=180x180 href=https://0xade1.github.io/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=https://0xade1.github.io/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://0xade1.github.io/favicon-16x16.png>
<link rel=manifest href=https://0xade1.github.io/site.webmanifest>
<link rel=mask-icon href=https://0xade1.github.io/safari-pinned-tab.svg color=#1b1c1d>
<link rel="shortcut icon" href=https://0xade1.github.io/favicon.ico>
<meta name=msapplication-TileColor content="#1b1c1d">
<meta name=theme-color content="#1b1c1d">
<meta itemprop=name content="PicoCTF2019">
<meta itemprop=description content="Short description of your site here"><meta itemprop=datePublished content="2022-08-17T03:42:29+08:00">
<meta itemprop=dateModified content="2022-08-17T03:42:29+08:00">
<meta itemprop=wordCount content="6594"><meta itemprop=image content="https://0xade1.github.io">
<meta itemprop=keywords content="untagged,">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://0xade1.github.io">
<meta name=twitter:title content="PicoCTF2019">
<meta name=twitter:description content="Short description of your site here">
<meta property="og:title" content="PicoCTF2019">
<meta property="og:description" content="Short description of your site here">
<meta property="og:type" content="article">
<meta property="og:url" content="https://0xade1.github.io/posts/2022/08/picoctf2019/"><meta property="og:image" content="https://0xade1.github.io"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-08-17T03:42:29+08:00">
<meta property="article:modified_time" content="2022-08-17T03:42:29+08:00">
<meta property="og:see_also" content="https://0xade1.github.io/posts/2021/08/picoctf-2021-binary-exploitation/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2021/08/picoctf-2021-forensics/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2021/08/picoctf-2021-general-skills/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2021/08/picoctf-2021-reverse-engineering/"><meta property="og:see_also" content="https://0xade1.github.io/posts/2021/08/picoctf-2021-web-exploitation/">
<meta property="article:section" content="picoCTF">
<meta property="article:published_time" content="2022-08-17 03:42:29 +0800 +0800">
</head>
<body>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=https://0xade1.github.io/ style=text-decoration:none>
<div class=logo>
<span class=logo__mark>></span>
<span class=logo__text># cd /root/</span>
<span class=logo__cursor>
</span>
</div>
</a>
<span class=header__right>
<nav class=menu>
<ul class=menu__inner><li><a href=https://0xade1.github.io/about/>About</a></li><li><a href=https://0xade1.github.io/categories/>Categories</a></li><li><a href=https://0xade1.github.io/posts/>Posts</a></li><li><a href=https://0xade1.github.io/series/>Series</a></li><li><a href=https://0xade1.github.io/tags/>Tags</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<main class=post>
<div class=post-info><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" ecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2022-08-16
|<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
<span class=tag><a href=https://0xade1.github.io/categories/picoctf/>picoCTF</a></span>
|
|<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
<span class=tag><a href=https://0xade1.github.io/series/picoctf/>picoCTF</a></span>
|
</div>
<article>
<h1 class=post-title>
<a href=https://0xade1.github.io/posts/2022/08/picoctf2019/>PicoCTF2019</a>
</h1>
<div class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://0xade1.github.io/tags/untagged/>untagged</a></span>
</p>
</div>
<div class=post-excerpt>Short description of your site here</div>
<figure class=post-cover>
<img src=https://play.picoctf.org/static/media/picoctf-logo-horizontal-white.17fdf0dcdef08dc3396a195b95e3bc29.svg alt=PicoCTF2019>
</figure>
<div class=post-content>
<h2 id=vault-door-training>vault-door-training</h2>
<pre><code>grep password.equals VaultDoorTraining.java | cut -d'&quot;' -f2 | awk '{printf &quot;picoCTF{%s}\n&quot;, $1}'
</code></pre>
<h2 id=insp3ct0r>Insp3ct0r</h2>
<pre><code>for i in &quot;&quot; mycss.css myjs.js ; do curl -s https://jupiter.challenges.picoctf.org/problem/9670/$i | grep flag | cut -d':' -f2 | cut -d' ' -f2 | tr -d &quot;\n&quot; ; done &amp;&amp; echo
</code></pre>
<h2 id=lets-warm-up>Lets Warm Up</h2>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;picoCTF{</span><span style=color:#f1fa8c>%s</span><span style=color:#f1fa8c>}&#34;</span> <span style=color:#ff79c6>%</span> (<span style=color:#8be9fd;font-style:italic>chr</span>(<span style=color:#8be9fd;font-style:italic>int</span>(<span style=color:#f1fa8c>&#39;70&#39;</span>, <span style=color:#bd93f9>16</span>))))
</code></pre></td></tr></table>
</div>
</div><h2 id=glory-of-the-garden>Glory of the Garden</h2>
<pre><code>strings garden.jpg | grep pico
xxd garden.jpg | tail
</code></pre>
<h2 id=warmed-up>Warmed Up</h2>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;picoCTF{</span><span style=color:#f1fa8c>%s</span><span style=color:#f1fa8c>}&#34;</span> <span style=color:#ff79c6>%</span> <span style=color:#8be9fd;font-style:italic>int</span>(<span style=color:#f1fa8c>&#39;3d&#39;</span>, <span style=color:#bd93f9>16</span>))
</code></pre></td></tr></table>
</div>
</div><h2 id=the-numbers>The Numbers</h2>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3>tbl <span style=color:#ff79c6>=</span> [<span style=color:#bd93f9>16</span>,<span style=color:#bd93f9>9</span>,<span style=color:#bd93f9>3</span>,<span style=color:#bd93f9>15</span>,<span style=color:#bd93f9>3</span>,<span style=color:#bd93f9>20</span>,<span style=color:#bd93f9>6</span>,<span style=color:#bd93f9>20</span>,<span style=color:#bd93f9>8</span>,<span style=color:#bd93f9>5</span>,<span style=color:#bd93f9>14</span>,<span style=color:#bd93f9>21</span>,<span style=color:#bd93f9>13</span>,<span style=color:#bd93f9>2</span>,<span style=color:#bd93f9>5</span>,<span style=color:#bd93f9>18</span>,<span style=color:#bd93f9>19</span>,<span style=color:#bd93f9>13</span>,<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>19</span>,<span style=color:#bd93f9>15</span>,<span style=color:#bd93f9>14</span>]
<span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;picoCTF{</span><span style=color:#f1fa8c>%s</span><span style=color:#f1fa8c>}&#34;</span> <span style=color:#ff79c6>%</span> <span style=color:#f1fa8c>&#39;&#39;</span><span style=color:#ff79c6>.</span>join([<span style=color:#8be9fd;font-style:italic>chr</span>(x<span style=color:#ff79c6>+</span><span style=color:#bd93f9>96</span>) <span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> tbl[<span style=color:#bd93f9>7</span>:]]))
</code></pre></td></tr></table>
</div>
</div><h2 id=2warm>2Warm</h2>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;picoCTF{</span><span style=color:#f1fa8c>%s</span><span style=color:#f1fa8c>}&#34;</span> <span style=color:#ff79c6>%</span> <span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{0:b}</span><span style=color:#f1fa8c>&#34;</span><span style=color:#ff79c6>.</span>format(<span style=color:#bd93f9>42</span>))
</code></pre></td></tr></table>
</div>
</div><h2 id=where-are-the-robots>where are the robots</h2>
<pre><code>URL=https://jupiter.challenges.picoctf.org/problem/56830/
page=$(curl -Ls $URL/robots.txt | grep Disallow | cut -d' ' -f2)
curl -Ls $URL/$page | grep picoCTF | cut -d'&gt;' -f2 | cut -d'&lt;' -f1
</code></pre>
<h2 id=vault-door-1>vault-door-1</h2>
<pre><code>flag=$(
  curl -sL https://jupiter.challenges.picoctf.org/static/87e103a8db01087de9ccf5a7a022ddf8/VaultDoor1.java |
  grep charAt | cut -d'(' -f2 | sort -n | cut -d&quot;'&quot; -f2 | tr -d &quot;\n&quot;
)
echo &quot;picoCTF{$flag}&quot;
</code></pre>
<h2 id=what-s-a-netcat>what s a netcat?</h2>
<pre><code>nc jupiter.challenges.picoctf.org 41120 | grep pico
</code></pre>
<h2 id=strings-it>strings it</h2>
<pre><code>curl -sL https://jupiter.challenges.picoctf.org/static/fae9ac5267cd6e44124e559b901df177/strings | strings | grep pico
</code></pre>
<h2 id=easy1>Easy1</h2>
<p>Cyberchef: <a href="https://cyberchef.org/#recipe=Vigen%C3%A8re_Decode('SOLVECRYPTO')&input=VUZKS1hRWlFVTkI">https://cyberchef.org/#recipe=Vigen%C3%A8re_Decode('SOLVECRYPTO')&input=VUZKS1hRWlFVTkI</a></p>
<h2 id=logon>logon</h2>
<ol>
<li>sign in with <code>joe:joe</code></li>
<li>with developer tools, look at the cookies</li>
<li>change <code>admin</code> cookie from <code>False</code> to <code>True</code></li>
<li>reload the page</li>
</ol>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -Ls --cookie <span style=color:#f1fa8c>&#34;admin=True&#34;</span> https://jupiter.challenges.picoctf.org/problem/44573/flag |
grep pico | cut -d<span style=color:#f1fa8c>&#39;&gt;&#39;</span> -f5 | cut -d<span style=color:#f1fa8c>&#39;&lt;&#39;</span> -f1
</code></pre></td></tr></table>
</div>
</div><h2 id=13>13</h2>
<pre><code>echo &quot;cvpbPGS{abg_gbb_onq_bs_n_ceboyrz}&quot; | tr &quot;[a-zA-Z]&quot; &quot;[n-za-mN-ZA-M]&quot;
</code></pre>
<h2 id=caesar>caesar</h2>
<pre><code>caesar=$(curl -Ls https://jupiter.challenges.picoctf.org/static/7d707a443e95054dc4cf30b1d9522ef0/ciphertext)
echo $caesar | cut -d'{' -f2 | cut -d'}' -f1
</code></pre>
<p>Cyberchef: <a href="https://cyberchef.org/#recipe=Vigen%C3%A8re_Decode('b')&input=ZHNwdHRqb2h1aWZzdmNqZHBvZWtvZnBiZGk">https://cyberchef.org/#recipe=Vigen%C3%A8re_Decode('b')&input=ZHNwdHRqb2h1aWZzdmNqZHBvZWtvZnBiZGk</a></p>
<h2 id=dont-use-client-side>dont-use-client-side</h2>
<pre><code>curl -Ls https://jupiter.challenges.picoctf.org/problem/17682/ |
grep &quot;checkpass.substring&quot; | cut -d'(' -f3 | cut -d',' -f2 | sort | cut -d&quot;'&quot; -f2 |  tr -d &quot;\n&quot; &amp;&amp; echo
</code></pre>
<h2 id=bases>Bases</h2>
<pre><code>echo &quot;bDNhcm5fdGgzX3IwcDM1&quot; | base64 -d | awk '{printf &quot;picoCTF{%s}\n&quot;, $1}'
</code></pre>
<h2 id=first-grep>First Grep</h2>
<pre><code>curl -Ls https://jupiter.challenges.picoctf.org/static/515f19f3612bfd97cd3f0c0ba32bd864/file | grep pico
</code></pre>
<h2 id=so-meta>So Meta</h2>
<pre><code>curl -Ls https://jupiter.challenges.picoctf.org/static/916b07b4c87062c165ace1d3d31ef655/pico_img.png | exiftool  - | grep pico | awk '{print $3}'
</code></pre>
<h2 id=shark-on-wire-1>shark on wire 1</h2>
<ol>
<li>Download pcap</li>
<li>open with Wireshark</li>
<li>select filter <code>udp.stream eq 6</code></li>
<li>Follow UDP stream</li>
</ol>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>tshark -q -r capture.pcap -z follow,udp,raw,6 | egrep <span style=color:#f1fa8c>&#34;^[0-9]&#34;</span> | xxd -r -p
</code></pre></td></tr></table>
</div>
</div><p>We can also iterate over every udp streams:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#ff79c6>for</span> stream in <span style=color:#f1fa8c>`</span>tshark -q -r capture.pcap -T fields -e udp.stream | sort -n | uniq<span style=color:#f1fa8c>`</span> ;
<span style=color:#ff79c6>do</span>
    tshark -q -r capture.pcap -z follow,udp,raw,<span style=color:#8be9fd;font-style:italic>$stream</span> | egrep <span style=color:#f1fa8c>&#34;^[0-9]&#34;</span> | xxd -r -p | grep picoCTF ;
<span style=color:#ff79c6>done</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=extensions>extensions</h2>
<pre><code>curl -sLO https://jupiter.challenges.picoctf.org/static/e7e5d188621ee705ceeb0452525412ef/flag.txt
file flag.txt
</code></pre>
<p>According to <code>file</code> command, this is not a text file, but a png</p>
<pre><code>mv flag.txt flag.png
tesseract flag.png flag.txt
cat flag.txt.txt
</code></pre>
<h2 id=what-lies-within>What Lies Within</h2>
<pre><code>zsteg buildings.png | grep pico | cut -d'&quot;' -f2
</code></pre>
<h2 id=la-cifra-de>la cifra de</h2>
<p>The fastest way to crack this challenge is to use this <a href=https://www.guballa.de/vigenere-solver>online Vigenere solver</a></p>
<pre tabindex=0><code>nc jupiter.challenges.picoctf.org 5726 | tee enc.txt
Encrypted message:
Ne iy nytkwpsznyg nth it mtsztcy vjzprj zfzjy rkhpibj nrkitt ltc tnnygy ysee itd tte cxjltk

Ifrosr tnj noawde uk siyyzre, yse Bnretèwp Cousex mls hjpn xjtnbjytki xatd eisjd

Iz bls lfwskqj azycihzeej yz Brftsk ip Volpnèxj ls oy hay tcimnyarqj dkxnrogpd os 1553 my Mnzvgs Mazytszf Merqlsu ny hox moup Wa inqrg ipl. Ynr. Gotgat Gltzndtg Gplrfdo

Ltc tnj tmvqpmkseaznzn uk ehox nivmpr g ylbrj ts ltcmki my yqtdosr tnj wocjc hgqq ol fy oxitngwj arusahje fuw ln guaaxjytrd catizm tzxbkw zf vqlckx hizm ceyupcz yz tnj fpvjc hgqqpohzCZK{m311a50_0x_a1rn3x3_h1ah3x6kp60egf}

Ehk ktryy herq-ooizxetypd jjdcxnatoty ol f aordllvmlbkytc inahkw socjgex, bls sfoe gwzuti 1467 my Rjzn Hfetoxea Gqmexyt.

Tnj Gimjyèrk Htpnjc iy ysexjqoxj dosjeisjd cgqwej yse Gqmexyt Doxn ox Fwbkwei Inahkw.

Tn 1508, Ptsatsps Zwttnjxiax tnbjytki ehk xz-cgqwej ylbaql rkhea (g rltxni ol xsilypd gqahggpty) ysaz bzuri wazjc bk f nroytcgq nosuznkse ol yse Bnretèwp Cousex.

Gplrfdo’y xpcuso butvlky lpvjlrki tn 1555 gx l cuseitzltoty ol yse lncsz. Yse rthex mllbjd ol yse gqahggpty fce tth snnqtki cemzwaxqj, bay ehk fwpnfmezx lnj yse osoed qptzjcs gwp mocpd hd xegsd ol f xnkrznoh vee usrgxp, wnnnh ify bk itfljcety hizm paim noxwpsvtydkse.
</code></pre><ul>
<li>We clearly see a section which looks like an encoded flag: <code>pohzCZK{m311a50_0x_a1rn3x3_h1ah3x6kp60egf}</code>.</li>
<li>And we can assume that <code>pohzCZK</code> translates into <code>picoCTF</code>.</li>
<li>It can t be a substitution algorithm because letter &lsquo;c&rsquo; and &lsquo;C&rsquo; are not mapping with &lsquo;h&rsquo; and &lsquo;C&rsquo; which are not the same letter.</li>
<li>Therefore it is more likely a Vigenere and we can get 7 characters from the key with this code:</li>
</ul>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3>enc <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;pohzCZK&#34;</span>
dec <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;picoCTF&#34;</span>
enc <span style=color:#ff79c6>=</span> [<span style=color:#8be9fd;font-style:italic>ord</span>(x) <span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> enc]
dec <span style=color:#ff79c6>=</span> [<span style=color:#8be9fd;font-style:italic>ord</span>(x) <span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> dec]
key <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;&#34;</span>
<span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#8be9fd;font-style:italic>len</span>(enc)):
  key <span style=color:#ff79c6>+=</span> <span style=color:#8be9fd;font-style:italic>chr</span>(<span style=color:#8be9fd;font-style:italic>ord</span>(<span style=color:#f1fa8c>&#39;a&#39;</span>) <span style=color:#ff79c6>+</span> (enc[i] <span style=color:#ff79c6>-</span> dec[i]))
<span style=color:#8be9fd;font-style:italic>print</span>(key)
</code></pre></td></tr></table>
</div>
</div><p>output:</p>
<pre><code>agflagf
</code></pre>
<p>We can see a 4 letters pattern, so it could be a 4 letters key: <code>agfl</code> or <code>gfla</code> or <code>flag</code> or <code>lagf</code></p>
<p>We can try them all, but <code>flag</code> seems to be a good first candidates:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#6272a4>#!/usr/bin/env python</span>

file <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>open</span>(<span style=color:#f1fa8c>&#34;enc.txt&#34;</span>, <span style=color:#f1fa8c>&#34;r&#34;</span>, encoding<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;utf-8&#34;</span>)
ctext <span style=color:#ff79c6>=</span> file<span style=color:#ff79c6>.</span>read()

keyword <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;flag&#39;</span>

<span style=color:#ff79c6>def</span> <span style=color:#50fa7b>do_vigenere</span>(char):
    <span style=color:#ff79c6>if</span> char<span style=color:#ff79c6>.</span>isalpha() <span style=color:#ff79c6>and</span> <span style=color:#8be9fd;font-style:italic>ord</span>(char) <span style=color:#ff79c6>&gt;</span> <span style=color:#8be9fd;font-style:italic>ord</span>(<span style=color:#f1fa8c>&#39;a&#39;</span>) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span> <span style=color:#ff79c6>and</span> <span style=color:#8be9fd;font-style:italic>ord</span>(char) <span style=color:#ff79c6>&lt;</span> <span style=color:#8be9fd;font-style:italic>ord</span>(<span style=color:#f1fa8c>&#39;z&#39;</span>) <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>:
        <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>True</span>
    <span style=color:#ff79c6>elif</span> char<span style=color:#ff79c6>.</span>isalpha() <span style=color:#ff79c6>and</span> <span style=color:#8be9fd;font-style:italic>ord</span>(char) <span style=color:#ff79c6>&gt;</span> <span style=color:#8be9fd;font-style:italic>ord</span>(<span style=color:#f1fa8c>&#39;A&#39;</span>) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span> <span style=color:#ff79c6>and</span> <span style=color:#8be9fd;font-style:italic>ord</span>(char) <span style=color:#ff79c6>&lt;</span> <span style=color:#8be9fd;font-style:italic>ord</span>(<span style=color:#f1fa8c>&#39;Z&#39;</span>) <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>:
        <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>True</span>
    <span style=color:#ff79c6>else</span>:
        <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>False</span>

<span style=color:#ff79c6>def</span> <span style=color:#50fa7b>vigenere_decrypt</span>(encrypted_vigener, keyword):
    keyword_length <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>len</span>(keyword)
    keyword_as_int <span style=color:#ff79c6>=</span> [<span style=color:#8be9fd;font-style:italic>ord</span>(i) <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> keyword]
    keyword_caps_as_int <span style=color:#ff79c6>=</span> [<span style=color:#8be9fd;font-style:italic>ord</span>(i) <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> keyword<span style=color:#ff79c6>.</span>upper()]
    encrypted_vigener_int <span style=color:#ff79c6>=</span> [<span style=color:#8be9fd;font-style:italic>ord</span>(i) <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> encrypted_vigener]
    plaintext <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;&#39;</span>
    j <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>
    <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#8be9fd;font-style:italic>len</span>(encrypted_vigener_int)):
        <span style=color:#ff79c6>if</span> do_vigenere(ctext[i]):
            j <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>1</span>
            offset <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>65</span>
            flag_key <span style=color:#ff79c6>=</span> keyword_caps_as_int[j <span style=color:#ff79c6>%</span> keyword_length]
            <span style=color:#ff79c6>if</span> encrypted_vigener_int[i] <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>96</span>:
                offset <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>97</span>
                flag_key <span style=color:#ff79c6>=</span> keyword_as_int[j <span style=color:#ff79c6>%</span> keyword_length]
            value <span style=color:#ff79c6>=</span> (encrypted_vigener_int[i] <span style=color:#ff79c6>-</span> flag_key) <span style=color:#ff79c6>%</span> <span style=color:#bd93f9>26</span>
            plaintext <span style=color:#ff79c6>+=</span> <span style=color:#8be9fd;font-style:italic>chr</span>(value <span style=color:#ff79c6>+</span> offset)
        <span style=color:#ff79c6>else</span>:
            <span style=color:#6272a4>#if ord(ctext[i]) == 232:</span>
            <span style=color:#6272a4>#    print(ctext[i]*64)</span>
            plaintext <span style=color:#ff79c6>+=</span> ctext[i]
    <span style=color:#ff79c6>return</span> plaintext

<span style=color:#8be9fd;font-style:italic>print</span>(vigenere_decrypt(ctext, <span style=color:#f1fa8c>&#39;flag&#39;</span>))

<span style=color:#6272a4>#from pycipher import Vigenere</span>
<span style=color:#6272a4>#plaintext = Vigenere(&#39;FLAG&#39;).decipher(ctext)</span>
<span style=color:#6272a4>#print (plaintext.lower())</span>
</code></pre></td></tr></table>
</div>
</div><p>output:</p>
<pre tabindex=0><code>python3 test.py
Zccltetyy bemnpgy:
It is interesting how in history people often receive credit for things they did not create

During the course of history, the Vigenère Cipher has been reinvented many times

It was falsely attributed to Blaise de Vigenère as it was originally described in 1553 by Giovan Battista Bellaso in his book La cifra del. Sig. Giovan Battista Bellaso

For the implementation of this cipher a table is formed by sliding the lower half of an ordinary alphabet for an apparently random number of places with respect to the upper halfpicoCTF{b311a50_0r_v1gn3r3_[..SNIP..]}

The first well-documented description of a polyalphabetic cipher however, was made around 1467 by Leon Battista Alberti.

The Vigenère Cipher is therefore sometimes called the Alberti Disc or Alberti Cipher.

In 1508, Johannes Trithemius invented the so-called tabula recta (a matrix of shifted alphabets) that would later be a critical component of the Vigenère Cipher.

Bellaso’s second booklet appeared in 1555 as a continuation of the first. The lower halves of the alphabets are now shifted regularly, but the alphabets and the index letters are mixed by means of a mnemonic key phrase, which can be different with each correspondent.
</code></pre><h2 id=picobrowser>picobrowser</h2>
<ol>
<li>click the Flag button</li>
<li>Read the message <code>You re not picobrowser! Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0 </code></li>
<li>We simply have to change the User-Agent on developer tools or with curl</li>
</ol>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -sX GET https://jupiter.challenges.picoctf.org/problem/28921/flag -H <span style=color:#f1fa8c>&#34;User-Agent: picobrowser&#34;</span> |
grep <span style=color:#f1fa8c>&#34;picoCTF{&#34;</span> | cut -d<span style=color:#f1fa8c>&#39;&gt;&#39;</span> -f5 | cut -d<span style=color:#f1fa8c>&#39;&lt;&#39;</span> -f1
</code></pre></td></tr></table>
</div>
</div><h2 id=asm1>asm1</h2>
<p>This is how the stack looks like after the prolog:</p>
<pre><code>| old ebp   |
| ret       | &lt;-- ebp+4
| 0x8be     | &lt;-- ebp+8
</code></pre>
<p>Lets audit the program with <a href=https://www.tutorialspoint.com/assembly_programming/assembly_conditions.htm>this doc</a>
as a reference:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#8be9fd;font-style:italic>asm1:</span>
        &lt;+0&gt;:   <span style=color:#50fa7b>push</span>   ebp                              <span style=color:#6272a4>; prolog ;
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>1</span>&gt;:   mov    ebp,esp                          <span style=color:#6272a4>; prolog ; ebp+8 = 0x8be
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>3</span>&gt;:   cmp    DWORD PTR [ebp+<span style=color:#bd93f9>0x8</span>],<span style=color:#bd93f9>0x71c</span>        <span style=color:#6272a4>; 0x8be &gt;  0x71c
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>10</span>&gt;:  jg     <span style=color:#bd93f9>0x512</span> &lt;asm1+<span style=color:#bd93f9>37</span>&gt;                  <span style=color:#6272a4>; jump as greater
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>12</span>&gt;:  cmp    DWORD PTR [ebp+<span style=color:#bd93f9>0x8</span>],<span style=color:#bd93f9>0x6cf</span>
        &lt;+19&gt;:  <span style=color:#50fa7b>jne</span>    <span style=color:#bd93f9>0x50a</span> &lt;asm1+<span style=color:#bd93f9>29</span>&gt;
        &lt;+21&gt;:  <span style=color:#50fa7b>mov</span>    eax,DWORD PTR [ebp+<span style=color:#bd93f9>0x8</span>]
        &lt;+24&gt;:  <span style=color:#50fa7b>add</span>    eax,<span style=color:#bd93f9>0x3</span>
        &lt;+27&gt;:  <span style=color:#50fa7b>jmp</span>    <span style=color:#bd93f9>0x529</span> &lt;asm1+<span style=color:#bd93f9>60</span>&gt;
        &lt;+29&gt;:  <span style=color:#50fa7b>mov</span>    eax,DWORD PTR [ebp+<span style=color:#bd93f9>0x8</span>]
        &lt;+32&gt;:  <span style=color:#50fa7b>sub</span>    eax,<span style=color:#bd93f9>0x3</span>
        &lt;+35&gt;:  <span style=color:#50fa7b>jmp</span>    <span style=color:#bd93f9>0x529</span> &lt;asm1+<span style=color:#bd93f9>60</span>&gt;
        &lt;+37&gt;:  <span style=color:#50fa7b>cmp</span>    DWORD PTR [ebp+<span style=color:#bd93f9>0x8</span>],<span style=color:#bd93f9>0x8be</span>        <span style=color:#6272a4>; 0x8be = 0x8be (dec 2238)
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>44</span>&gt;:  jne    <span style=color:#bd93f9>0x523</span> &lt;asm1+<span style=color:#bd93f9>54</span>&gt;                  <span style=color:#6272a4>; don&#39;t jump because equal
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>46</span>&gt;:  mov    eax,DWORD PTR [ebp+<span style=color:#bd93f9>0x8</span>]          <span style=color:#6272a4>; eax = 0x8be
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>49</span>&gt;:  sub    eax,<span style=color:#bd93f9>0x3</span>                          <span style=color:#6272a4>; eax = 0x8be - 0x3 = 0x8bb
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>52</span>&gt;:  jmp    <span style=color:#bd93f9>0x529</span> &lt;asm1+<span style=color:#bd93f9>60</span>&gt;
        &lt;+54&gt;:  <span style=color:#50fa7b>mov</span>    eax,DWORD PTR [ebp+<span style=color:#bd93f9>0x8</span>]
        &lt;+57&gt;:  <span style=color:#50fa7b>add</span>    eax,<span style=color:#bd93f9>0x3</span>
        &lt;+60&gt;:  <span style=color:#50fa7b>pop</span>    ebp                              <span style=color:#6272a4>; epilog ;
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>61</span>&gt;:  ret                                     <span style=color:#6272a4>; epilog ; return eax = 0x8bb
</span></code></pre></td></tr></table>
</div>
</div><h2 id=tapping>Tapping</h2>
<pre tabindex=0><code>.--. .. -.-. --- -.-. - ..-. { -- ----- .-. ... ...-- -.-. ----- -.. ...-- .---- ... ..-. ..- -. .---- ..--- -.... .---- ....- ...-- ---.. .---- ---.. .---- }&gt;&gt;
</code></pre><p>copy paste the above morse code in <a href=https://morsedecoder.com/>https://morsedecoder.com/</a> to get the flag</p>
<h2 id=flags>Flags</h2>
<p>This is a visual challenge where some images replaces letters, we can guess part of it:</p>
<pre><code>picoctf{f????????t?ff}
</code></pre>
<p>it is impossible to solve or guess, so there must be a meaning. It looks like Marine flags which can indeed be found in Wikipedia: <a href=https://en.wikipedia.org/wiki/International_maritime_signal_flags#Letter_flags_(with_ICS_meaning)>International Maritime Signal Flag</a></p>
<p>it translates into:</p>
<pre><code>picoctf{f1ag5and5tuff}
</code></pre>
<h2 id=based>Based</h2>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#6272a4>#!/usr/bin/env python3</span>
<span style=color:#ff79c6>import</span> pwn
<span style=color:#ff79c6>import</span> re

host, port <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;jupiter.challenges.picoctf.org&#39;</span>, <span style=color:#bd93f9>29956</span>
s <span style=color:#ff79c6>=</span> pwn<span style=color:#ff79c6>.</span>remote(host, port)

prompt <span style=color:#ff79c6>=</span> s<span style=color:#ff79c6>.</span>recvuntil(<span style=color:#f1fa8c>&#39;Input:</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#39;</span>)<span style=color:#ff79c6>.</span>decode()
code <span style=color:#ff79c6>=</span> re<span style=color:#ff79c6>.</span>findall(<span style=color:#f1fa8c>&#34;Please give the ([^a]*)as a word.</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, prompt)[<span style=color:#bd93f9>0</span>]<span style=color:#ff79c6>.</span>strip()<span style=color:#ff79c6>.</span>split(<span style=color:#f1fa8c>&#39; &#39;</span>)
code <span style=color:#ff79c6>=</span> [<span style=color:#8be9fd;font-style:italic>chr</span>(<span style=color:#8be9fd;font-style:italic>int</span>(x,<span style=color:#bd93f9>2</span>)) <span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> code]
s<span style=color:#ff79c6>.</span>sendline(<span style=color:#f1fa8c>&#39;&#39;</span><span style=color:#ff79c6>.</span>join(code))

prompt <span style=color:#ff79c6>=</span> s<span style=color:#ff79c6>.</span>recvuntil(<span style=color:#f1fa8c>&#39;Input:</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#39;</span>)<span style=color:#ff79c6>.</span>decode()
code <span style=color:#ff79c6>=</span> re<span style=color:#ff79c6>.</span>findall(<span style=color:#f1fa8c>&#34;Please give me the ([^a]*)as a word.</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, prompt)[<span style=color:#bd93f9>0</span>]<span style=color:#ff79c6>.</span>strip()<span style=color:#ff79c6>.</span>split(<span style=color:#f1fa8c>&#39; &#39;</span>)
code <span style=color:#ff79c6>=</span> [<span style=color:#8be9fd;font-style:italic>chr</span>(<span style=color:#8be9fd;font-style:italic>int</span>(x,<span style=color:#bd93f9>8</span>)) <span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> code]
s<span style=color:#ff79c6>.</span>sendline(<span style=color:#f1fa8c>&#39;&#39;</span><span style=color:#ff79c6>.</span>join(code))

prompt <span style=color:#ff79c6>=</span> s<span style=color:#ff79c6>.</span>recvuntil(<span style=color:#f1fa8c>&#39;Input:</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#39;</span>)<span style=color:#ff79c6>.</span>decode()
<span style=color:#8be9fd;font-style:italic>print</span>(prompt)

code <span style=color:#ff79c6>=</span> re<span style=color:#ff79c6>.</span>findall(<span style=color:#f1fa8c>&#34;Please give me the ([^a]*)as a word.</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, prompt)[<span style=color:#bd93f9>0</span>]<span style=color:#ff79c6>.</span>strip()
bytes_array <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(code)
code <span style=color:#ff79c6>=</span> bytes_array<span style=color:#ff79c6>.</span>decode()
s<span style=color:#ff79c6>.</span>sendline(<span style=color:#f1fa8c>&#39;&#39;</span><span style=color:#ff79c6>.</span>join(code))

prompt <span style=color:#ff79c6>=</span> s<span style=color:#ff79c6>.</span>recvall()<span style=color:#ff79c6>.</span>ecode()
flag <span style=color:#ff79c6>=</span> re<span style=color:#ff79c6>.</span>findall(<span style=color:#f1fa8c>&#34;Flag: (picoCTF{.*})&#34;</span>, prompt)[<span style=color:#bd93f9>0</span>]
<span style=color:#8be9fd;font-style:italic>print</span>(flag)
</code></pre></td></tr></table>
</div>
</div><h2 id=mr-worldwide>Mr-Worldwide</h2>
<p>Those are obvious geographic coordinates</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#ff79c6>import</span> requests<span style=color:#ff79c6>,</span> re
<span style=color:#ff79c6>import</span> time

flag <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;picoCTF{(35.028309, 135.753082)(46.469391, 30.740883)(39.758949, -84.191605)(41.015137, 28.979530)(24.466667, 54.366669)(3.140853, 101.693207)_(9.005401, 38.763611)(-3.989038, -79.203560)(52.377956, 4.897070)(41.085651, -73.858467)(57.790001, -152.407227)(31.205753, 29.924526)}&#34;</span>

<span style=color:#ff79c6>def</span> <span style=color:#50fa7b>get_letter_from_coordinate</span>(match):
    lat <span style=color:#ff79c6>=</span> match<span style=color:#ff79c6>.</span>group(<span style=color:#bd93f9>1</span>)
    long <span style=color:#ff79c6>=</span> match<span style=color:#ff79c6>.</span>group(<span style=color:#bd93f9>2</span>)

    <span style=color:#ff79c6>while</span> <span style=color:#ff79c6>True</span>:                         <span style=color:#6272a4># Because we are being throttled</span>
        <span style=color:#ff79c6>try</span>:
            r <span style=color:#ff79c6>=</span> requests<span style=color:#ff79c6>.</span>get(<span style=color:#f1fa8c>&#34;https://geocode.xyz/</span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>,</span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>?json=1&#34;</span><span style=color:#ff79c6>.</span>format(lat, long))
            j <span style=color:#ff79c6>=</span> r<span style=color:#ff79c6>.</span>json()
            <span style=color:#8be9fd;font-style:italic>print</span>(j)
            <span style=color:#ff79c6>if</span> j<span style=color:#ff79c6>.</span>get(<span style=color:#f1fa8c>&#34;success&#34;</span>) <span style=color:#ff79c6>and</span> <span style=color:#ff79c6>not</span> j[<span style=color:#f1fa8c>&#34;success&#34;</span>] <span style=color:#ff79c6>and</span> j[<span style=color:#f1fa8c>&#34;error&#34;</span>][<span style=color:#f1fa8c>&#34;code&#34;</span>] <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;006&#34;</span>:  <span style=color:#6272a4># We are being throttled</span>
                <span style=color:#ff79c6>raise</span> Exception(<span style=color:#f1fa8c>&#34;Throttled by goecode.xyz&#34;</span>)
            <span style=color:#ff79c6>return</span> j[<span style=color:#f1fa8c>&#34;geocode&#34;</span>][<span style=color:#bd93f9>0</span>]
        <span style=color:#ff79c6>except</span>:
            time<span style=color:#ff79c6>.</span>sleep(<span style=color:#bd93f9>10</span>)              <span style=color:#6272a4># Due to throttling</span>


<span style=color:#8be9fd;font-style:italic>print</span>(re<span style=color:#ff79c6>.</span>sub(<span style=color:#f1fa8c>r</span><span style=color:#f1fa8c>&#39;\(([\d\.-]+), ([\d\.-]+)\)&#39;</span>, get_letter_from_coordinate, flag))
</code></pre></td></tr></table>
</div>
</div><p>output:</p>
<pre><code>picoCTF{KODIAK_ALANKA}
</code></pre>
<p>When searching the Internet for <code>KODIAK_ALANKA</code>, auto-correction points us to <code>Kodiak, Alaska</code>, therefore we can correct our flag:</p>
<pre><code>picoCTF{KODIAK_ALASKA}
</code></pre>
<h2 id=plumbing>Plumbing</h2>
<pre><code>nc jupiter.challenges.picoctf.org 4427 | grep pico
</code></pre>
<h2 id=vault-door-3>vault-door-3</h2>
<pre><code>curl -sL https://jupiter.challenges.picoctf.org/static/a4018cec1446761cb2e8cce05db925fa/VaultDoor3.java | tail -22
</code></pre>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>boolean</span> <span style=color:#50fa7b>checkPassword</span><span style=color:#ff79c6>(</span>String password<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
    <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>(</span>password<span style=color:#ff79c6>.</span><span style=color:#50fa7b>length</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>!=</span> 32<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
        <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>false</span><span style=color:#ff79c6>;</span>
    <span style=color:#ff79c6>}</span>
    <span style=color:#8be9fd>char</span><span style=color:#ff79c6>[]</span> buffer <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> <span style=color:#8be9fd>char</span><span style=color:#ff79c6>[</span>32<span style=color:#ff79c6>];</span>
    <span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>;</span>
    <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span>i<span style=color:#ff79c6>=</span>0<span style=color:#ff79c6>;</span> i<span style=color:#ff79c6>&lt;</span>8<span style=color:#ff79c6>;</span> i<span style=color:#ff79c6>++)</span> <span style=color:#ff79c6>{</span>
        buffer<span style=color:#ff79c6>[</span>i<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>=</span> password<span style=color:#ff79c6>.</span><span style=color:#50fa7b>charAt</span><span style=color:#ff79c6>(</span>i<span style=color:#ff79c6>);</span>
    <span style=color:#ff79c6>}</span>
    <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(;</span> i<span style=color:#ff79c6>&lt;</span>16<span style=color:#ff79c6>;</span> i<span style=color:#ff79c6>++)</span> <span style=color:#ff79c6>{</span>
        buffer<span style=color:#ff79c6>[</span>i<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>=</span> password<span style=color:#ff79c6>.</span><span style=color:#50fa7b>charAt</span><span style=color:#ff79c6>(</span>23<span style=color:#ff79c6>-</span>i<span style=color:#ff79c6>);</span>
    <span style=color:#ff79c6>}</span>
    <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(;</span> i<span style=color:#ff79c6>&lt;</span>32<span style=color:#ff79c6>;</span> i<span style=color:#ff79c6>+=</span>2<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
        buffer<span style=color:#ff79c6>[</span>i<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>=</span> password<span style=color:#ff79c6>.</span><span style=color:#50fa7b>charAt</span><span style=color:#ff79c6>(</span>46<span style=color:#ff79c6>-</span>i<span style=color:#ff79c6>);</span>
    <span style=color:#ff79c6>}</span>
    <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span>i<span style=color:#ff79c6>=</span>31<span style=color:#ff79c6>;</span> i<span style=color:#ff79c6>&gt;=</span>17<span style=color:#ff79c6>;</span> i<span style=color:#ff79c6>-=</span>2<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
        buffer<span style=color:#ff79c6>[</span>i<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>=</span> password<span style=color:#ff79c6>.</span><span style=color:#50fa7b>charAt</span><span style=color:#ff79c6>(</span>i<span style=color:#ff79c6>);</span>
    <span style=color:#ff79c6>}</span>
    String s <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> String<span style=color:#ff79c6>(</span>buffer<span style=color:#ff79c6>);</span>
    <span style=color:#ff79c6>return</span> s<span style=color:#ff79c6>.</span><span style=color:#50fa7b>equals</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;jU5t_a_sna_3lpm12g94c_u_4_m7ra41&#34;</span><span style=color:#ff79c6>);</span>
<span style=color:#ff79c6>}</span>
</code></pre></td></tr></table>
</div>
</div><p>translated into python:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3>not_the_flag <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;jU5t_a_sna_3lpm12g94c_u_4_m7ra41&#34;</span>

buffer <span style=color:#ff79c6>=</span> [<span style=color:#ff79c6>None</span>] <span style=color:#ff79c6>*</span> <span style=color:#8be9fd;font-style:italic>len</span>(not_the_flag)

<span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>8</span>):
    buffer[i] <span style=color:#ff79c6>=</span> not_the_flag[i]

<span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>8</span>,<span style=color:#bd93f9>16</span>):
    buffer[i] <span style=color:#ff79c6>=</span> not_the_flag[<span style=color:#bd93f9>23</span> <span style=color:#ff79c6>-</span>i]

<span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>16</span>,<span style=color:#bd93f9>32</span>, <span style=color:#bd93f9>2</span>):
    buffer[i] <span style=color:#ff79c6>=</span> not_the_flag[<span style=color:#bd93f9>46</span><span style=color:#ff79c6>-</span>i]

<span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>31</span>,<span style=color:#bd93f9>16</span>, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>):
    buffer[i] <span style=color:#ff79c6>=</span> not_the_flag[i]

<span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;picoCTF{</span><span style=color:#f1fa8c>%s</span><span style=color:#f1fa8c>}&#34;</span> <span style=color:#ff79c6>%</span> <span style=color:#f1fa8c>&#39;&#39;</span><span style=color:#ff79c6>.</span>join(buffer))
</code></pre></td></tr></table>
</div>
</div><h2 id=rsa-pop-quiz>rsa-pop-quiz</h2>
<h3 id=quizz-1>Quizz #1</h3>
<pre tabindex=0><code>#### NEW PROBLEM ###
q : 60413
p : 76753
##### PRODUCE THE FOLLOWING ####
n
IS THIS POSSIBLE and FEASIBLE? (Y/N):Y
</code></pre><p>to calculate n we can use simple python because the number are very small:</p>
<pre tabindex=0><code>&gt;&gt;&gt; q = 60413
&gt;&gt;&gt; p = 76753
&gt;&gt;&gt; q * p
4636878989
</code></pre><h3 id=quizz-2>Quizz #2</h3>
<pre tabindex=0><code>#### NEW PROBLEM ####
p : 54269
n : 5051846941
##### PRODUCE THE FOLLOWING ####
q
IS THIS POSSIBLE and FEASIBLE? (Y/N):Y
</code></pre><p>To</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#ff79c6>&gt;&gt;&gt;</span> n <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>5051846941</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> p <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>54269</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> n <span style=color:#ff79c6>/</span> p
<span style=color:#bd93f9>93089</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=quizz-3>Quizz #3</h3>
<pre tabindex=0><code>#### NEW PROBLEM ####
e : 3
n : 12738162802910546503821920886905393316386362759567480839428456525224226445173031635306683726182522494910808518920409019414034814409330094245825749680913204566832337704700165993198897029795786969124232138869784626202501366135975223827287812326250577148625360887698930625504334325804587329905617936581116392784684334664204309771430814449606147221349888320403451637882447709796221706470239625292297988766493746209684880843111138170600039888112404411310974758532603998608057008811836384597579147244737606088756299939654265086899096359070667266167754944587948695842171915048619846282873769413489072243477764350071787327913
##### PRODUCE THE FOLLOWING ####
q
p
IS THIS POSSIBLE and FEASIBLE? (Y/N):Y
</code></pre><h3 id=quizz-4>Quizz #4</h3>
<p>n is too big, no solutions on factorDB.com</p>
<pre tabindex=0><code>#### NEW PROBLEM ####
e : 3
n : 12738162802910546503821920886905393316386362759567480839428456525224226445173031635306683726182522494910808518920409019414034814409330094245825749680913204566832337704700165993198897029795786969124232138869784626202501366135975223827287812326250577148625360887698930625504334325804587329905617936581116392784684334664204309771430814449606147221349888320403451637882447709796221706470239625292297988766493746209684880843111138170600039888112404411310974758532603998608057008811836384597579147244737606088756299939654265086899096359070667266167754944587948695842171915048619846282873769413489072243477764350071787327913
##### PRODUCE THE FOLLOWING ####
q
p
IS THIS POSSIBLE and FEASIBLE? (Y/N):N
Outstanding move!!!
</code></pre><h3 id=quizz-5>Quizz #5</h3>
<pre tabindex=0><code>#### NEW PROBLEM ####
q : 66347
p : 12611
##### PRODUCE THE FOLLOWING ####
totient(n)
IS THIS POSSIBLE and FEASIBLE? (Y/N):Y
</code></pre><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#ff79c6>&gt;&gt;&gt;</span> p <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>12611</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> q <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>66347</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> ph <span style=color:#ff79c6>=</span> (p<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>)<span style=color:#ff79c6>*</span>(q<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>)
<span style=color:#ff79c6>&gt;&gt;&gt;</span> ph
<span style=color:#bd93f9>836623060</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=quizz-6>Quizz #6</h3>
<p>No solutions to factorize n in factorDB.com</p>
<pre tabindex=0><code>#### NEW PROBLEM ####
plaintext : 6357294171489311547190987615544575133581967886499484091352661406414044440475205342882841236357665973431462491355089413710392273380203038793241564304774271529108729717
e : 3
n : 29129463609326322559521123136222078780585451208149138547799121083622333250646678767769126248182207478527881025116332742616201890576280859777513414460842754045651093593251726785499360828237897586278068419875517543013545369871704159718105354690802726645710699029936754265654381929650494383622583174075805797766685192325859982797796060391271817578087472948205626257717479858369754502615173773514087437504532994142632207906501079835037052797306690891600559321673928943158514646572885986881016569647357891598545880304236145548059520898133142087545369179876065657214225826997676844000054327141666320553082128424707948750331
##### PRODUCE THE FOLLOWING ####
ciphertext
IS THIS POSSIBLE and FEASIBLE? (Y/N):
</code></pre><p>Given <code>n</code> and <code>e</code> , there is a simple formula to encrypt any <code>plaintext</code>:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#ff79c6>&gt;&gt;&gt;</span> plaintext <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>6357294171489311547190987615544575133581967886499484091352661406414044440475205342882841236357665973431462491355089413710392273380203038793241564304774271529108729717</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> n <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>29129463609326322559521123136222078780585451208149138547799121083622333250646678767769126248182207478527881025116332742616201890576280859777513414460842754045651093593251726785499360828237897586278068419875517543013545369871704159718105354690802726645710699029936754265654381929650494383622583174075805797766685192325859982797796060391271817578087472948205626257717479858369754502615173773514087437504532994142632207906501079835037052797306690891600559321673928943158514646572885986881016569647357891598545880304236145548059520898133142087545369179876065657214225826997676844000054327141666320553082128424707948750331</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> e <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>3</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> <span style=color:#8be9fd;font-style:italic>pow</span>(plaintext, e, n)
<span style=color:#bd93f9>256931246631782714357241556582441991993437399854161372646318659020994329843524306570818293602492485385337029697819837182169818816821461486018802894936801257629375428544752970630870631166355711254848465862207765051226282541748174535990314552471546936536330397892907207943448897073772015986097770443616540466471245438117157152783246654401668267323136450122287983612851171545784168132230208726238881861407976917850248110805724300421712827401063963117423718797887144760360749619552577176382615108244813</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=quizz-7>Quizz #7</h3>
<p>If I am notable to factorize n on factorDB.com, then there is no chance I can decrypt:</p>
<pre tabindex=0><code>#### NEW PROBLEM ####
ciphertext : 107524013451079348539944510756143604203925717262185033799328445011792760545528944993719783392542163428637172323512252624567111110666168664743115203791510985709942366609626436995887781674651272233566303814979677507101168587739375699009734588985482369702634499544891509228440194615376339573685285125730286623323
e : 3
n : 27566996291508213932419371385141522859343226560050921196294761870500846140132385080994630946107675330189606021165260590147068785820203600882092467797813519434652632126061353583124063944373336654246386074125394368479677295167494332556053947231141336142392086767742035970752738056297057898704112912616565299451359791548536846025854378347423520104947907334451056339439706623069503088916316369813499705073573777577169392401411708920615574908593784282546154486446779246790294398198854547069593987224578333683144886242572837465834139561122101527973799583927411936200068176539747586449939559180772690007261562703222558103359
##### PRODUCE THE FOLLOWING ####
plaintext
IS THIS POSSIBLE and FEASIBLE? (Y/N):N
</code></pre><h3 id=quizz-8>Quizz 8</h3>
<pre tabindex=0><code>#### NEW PROBLEM ####
q : 92092076805892533739724722602668675840671093008520241548191914215399824020372076186460768206814914423802230398410980218741906960527104568970225804374404612617736579286959865287226538692911376507934256844456333236362669879347073756238894784951597211105734179388300051579994253565459304743059533646753003894559
p : 97846775312392801037224396977012615848433199640105786119757047098757998273009741128821931277074555731813289423891389911801250326299324018557072727051765547115514791337578758859803890173153277252326496062476389498019821358465433398338364421624871010292162533041884897182597065662521825095949253625730631876637
e : 65537
##### PRODUCE THE FOLLOWING ####
d
IS THIS POSSIBLE and FEASIBLE? (Y/N):Y
</code></pre><p>to obtain d, we need to:</p>
<ol>
<li>calculate the totient ph</li>
<li>use module <code>gmpy2</code> to calculate <code>d</code> the modular multiplicative inverse of e (mod λ(n)) according to <a href=https://en.wikipedia.org/wiki/RSA_(cryptosystem)>Wikipedia</a></li>
</ol>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#ff79c6>&gt;&gt;&gt;</span> q <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>92092076805892533739724722602668675840671093008520241548191914215399824020372076186460768206814914423802230398410980218741906960527104568970225804374404612617736579286959865287226538692911376507934256844456333236362669879347073756238894784951597211105734179388300051579994253565459304743059533646753003894559</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> p <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>97846775312392801037224396977012615848433199640105786119757047098757998273009741128821931277074555731813289423891389911801250326299324018557072727051765547115514791337578758859803890173153277252326496062476389498019821358465433398338364421624871010292162533041884897182597065662521825095949253625730631876637</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> e <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>65537</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> n <span style=color:#ff79c6>=</span> p <span style=color:#ff79c6>*</span> q
<span style=color:#ff79c6>&gt;&gt;&gt;</span> ph <span style=color:#ff79c6>=</span> (p <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>*</span> (q <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>)
<span style=color:#ff79c6>&gt;&gt;&gt;</span> <span style=color:#ff79c6>import</span> gmpy2
<span style=color:#ff79c6>&gt;&gt;&gt;</span> d <span style=color:#ff79c6>=</span> gmpy2<span style=color:#ff79c6>.</span>invert(e, ph)
<span style=color:#ff79c6>&gt;&gt;&gt;</span> d
mpz(<span style=color:#bd93f9>1405046269503207469140791548403639533127416416214210694972085079171787580463776820425965898174272870486015739516125786182821637006600742140682552321645503743280670839819078749092730110549881891271317396450158021688253989767145578723458252769465545504142139663476747479225923933192421405464414574786272963741656223941750084051228611576708609346787101088759062724389874160693008783334605903142528824559223515203978707969795087506678894006628296743079886244349469131831225757926844843554897638786146036869572653204735650843186722732736888918789379054050122205253165705085538743651258400390580971043144644984654914856729</span>)
</code></pre></td></tr></table>
</div>
</div><h3 id=quizz-9>Quizz #9</h3>
<pre tabindex=0><code>#### NEW PROBLEM ####
p : 153143042272527868798412612417204434156935146874282990942386694020462861918068684561281763577034706600608387699148071015194725533394126069826857182428660427818277378724977554365910231524827258160904493774748749088477328204812171935987088715261127321911849092207070653272176072509933245978935455542420691737433
ciphertext : 18031488536864379496089550017272599246134435121343229164236671388038630752847645738968455413067773166115234039247540029174331743781203512108626594601293283737392240326020888417252388602914051828980913478927759934805755030493894728974208520271926698905550119698686762813722190657005740866343113838228101687566611695952746931293926696289378849403873881699852860519784750763227733530168282209363348322874740823803639617797763626570478847423136936562441423318948695084910283653593619962163665200322516949205854709192890808315604698217238383629613355109164122397545332736734824591444665706810731112586202816816647839648399
e : 65537
n : 23952937352643527451379227516428377705004894508566304313177880191662177061878993798938496818120987817049538365206671401938265663712351239785237507341311858383628932183083145614696585411921662992078376103990806989257289472590902167457302888198293135333083734504191910953238278860923153746261500759411620299864395158783509535039259714359526738924736952759753503357614939203434092075676169179112452620687731670534906069845965633455748606649062394293289967059348143206600765820021392608270528856238306849191113241355842396325210132358046616312901337987464473799040762271876389031455051640937681745409057246190498795697239
##### PRODUCE THE FOLLOWING ####
plaintext
IS THIS POSSIBLE and FEASIBLE? (Y/N):Y
</code></pre><p>In python:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#ff79c6>&gt;&gt;&gt;</span> p <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>153143042272527868798412612417204434156935146874282990942386694020462861918068684561281763577034706600608387699148071015194725533394126069826857182428660427818277378724977554365910231524827258160904493774748749088477328204812171935987088715261127321911849092207070653272176072509933245978935455542420691737433</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> ciphertext <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>18031488536864379496089550017272599246134435121343229164236671388038630752847645738968455413067773166115234039247540029174331743781203512108626594601293283737392240326020888417252388602914051828980913478927759934805755030493894728974208520271926698905550119698686762813722190657005740866343113838228101687566611695952746931293926696289378849403873881699852860519784750763227733530168282209363348322874740823803639617797763626570478847423136936562441423318948695084910283653593619962163665200322516949205854709192890808315604698217238383629613355109164122397545332736734824591444665706810731112586202816816647839648399</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> e <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>65537</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> n <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>23952937352643527451379227516428377705004894508566304313177880191662177061878993798938496818120987817049538365206671401938265663712351239785237507341311858383628932183083145614696585411921662992078376103990806989257289472590902167457302888198293135333083734504191910953238278860923153746261500759411620299864395158783509535039259714359526738924736952759753503357614939203434092075676169179112452620687731670534906069845965633455748606649062394293289967059348143206600765820021392608270528856238306849191113241355842396325210132358046616312901337987464473799040762271876389031455051640937681745409057246190498795697239</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> q <span style=color:#ff79c6>=</span> n <span style=color:#ff79c6>//</span> p
<span style=color:#ff79c6>&gt;&gt;&gt;</span> ph <span style=color:#ff79c6>=</span> (p <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>*</span> (q <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>)
<span style=color:#ff79c6>&gt;&gt;&gt;</span> d <span style=color:#ff79c6>=</span> gmpy2<span style=color:#ff79c6>.</span>invert(e, ph)
<span style=color:#ff79c6>&gt;&gt;&gt;</span> plaintext <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>pow</span>(ciphertext, d, n)
<span style=color:#ff79c6>&gt;&gt;&gt;</span> plaintext
mpz(<span style=color:#bd93f9>14311663942709674867122208214901970650496788151239520971623411712977120586163535880168563325</span>)
</code></pre></td></tr></table>
</div>
</div><h3 id=flag>Flag</h3>
<pre><code>If you convert the last plaintext to a hex number, then ascii, you'll find what you need! ;)
</code></pre>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#ff79c6>&gt;&gt;&gt;</span> plaintext <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>14311663942709674867122208214901970650496788151239520971623411712977120586163535880168563325</span>
<span style=color:#ff79c6>&gt;&gt;&gt;</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(<span style=color:#8be9fd;font-style:italic>hex</span>(plaintext)[<span style=color:#bd93f9>2</span>:])<span style=color:#ff79c6>.</span>decode()
<span style=color:#f1fa8c>&#39;picoCTF{wA8_th4t$_ill3aGal[..SNIP..]}&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=client-side-again>Client-side-again</h2>
<p>We can observe some Javascript with elements of flag. We use a JS beautifier to improve the code clarity:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#8be9fd;font-style:italic>var</span> <span style=color:#bd93f9>_0</span>x5a46 <span style=color:#ff79c6>=</span> [<span style=color:#f1fa8c>&#39;f49bf}&#39;</span>, <span style=color:#f1fa8c>&#39;_again_e&#39;</span>, <span style=color:#f1fa8c>&#39;this&#39;</span>, <span style=color:#f1fa8c>&#39;Password\x20Verified&#39;</span>, <span style=color:#f1fa8c>&#39;Incorrect\x20password&#39;</span>, <span style=color:#f1fa8c>&#39;getElementById&#39;</span>, <span style=color:#f1fa8c>&#39;value&#39;</span>, <span style=color:#f1fa8c>&#39;substring&#39;</span>, <span style=color:#f1fa8c>&#39;picoCTF{&#39;</span>, <span style=color:#f1fa8c>&#39;not_this&#39;</span>];

(<span style=color:#8be9fd;font-style:italic>function</span>(<span style=color:#bd93f9>_0</span>x4bd822, <span style=color:#bd93f9>_0</span>x2bd6f7) {
    <span style=color:#8be9fd;font-style:italic>var</span> <span style=color:#bd93f9>_0</span>xb4bdb3 <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>function</span>(<span style=color:#bd93f9>_0</span>x1d68f6) {
        <span style=color:#ff79c6>while</span> (<span style=color:#ff79c6>--</span><span style=color:#bd93f9>_0</span>x1d68f6) {
            <span style=color:#bd93f9>_0</span>x4bd822[<span style=color:#f1fa8c>&#39;push&#39;</span>](<span style=color:#bd93f9>_0</span>x4bd822[<span style=color:#f1fa8c>&#39;shift&#39;</span>]());
        }
    };
    <span style=color:#bd93f9>_0</span>xb4bdb3(<span style=color:#ff79c6>++</span><span style=color:#bd93f9>_0</span>x2bd6f7);
}(<span style=color:#bd93f9>_0</span>x5a46, <span style=color:#bd93f9>0x1b3</span>));

<span style=color:#8be9fd;font-style:italic>var</span> <span style=color:#bd93f9>_0</span>x4b5b <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>function</span>(<span style=color:#bd93f9>_0</span>x2d8f05, <span style=color:#bd93f9>_0</span>x4b81bb) {
    <span style=color:#bd93f9>_0</span>x2d8f05 <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>_0</span>x2d8f05 <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>0x0</span>;
    <span style=color:#8be9fd;font-style:italic>var</span> <span style=color:#bd93f9>_0</span>x4d74cb <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>_0</span>x5a46[<span style=color:#bd93f9>_0</span>x2d8f05];
    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>_0</span>x4d74cb;
};

<span style=color:#8be9fd;font-style:italic>function</span> verify() {
    checkpass <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>document</span>[<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x0&#39;</span>)](<span style=color:#f1fa8c>&#39;pass&#39;</span>)[<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x1&#39;</span>)];
    split <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0x4</span>;
    <span style=color:#ff79c6>if</span> (checkpass[<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x2&#39;</span>)](<span style=color:#bd93f9>0x0</span>, split <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x2</span>) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x3&#39;</span>)) {
        <span style=color:#ff79c6>if</span> (checkpass[<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x2&#39;</span>)](<span style=color:#bd93f9>0x7</span>, <span style=color:#bd93f9>0x9</span>) <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#39;{n&#39;</span>) {
            <span style=color:#ff79c6>if</span> (checkpass[<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x2&#39;</span>)](split <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x2</span>, split <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x2</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x2</span>) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x4&#39;</span>)) {
                <span style=color:#ff79c6>if</span> (checkpass[<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x2&#39;</span>)](<span style=color:#bd93f9>0x3</span>, <span style=color:#bd93f9>0x6</span>) <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#39;oCT&#39;</span>) {
                    <span style=color:#ff79c6>if</span> (checkpass[<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x2&#39;</span>)](split <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x3</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x2</span>, split <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x4</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x2</span>) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x5&#39;</span>)) {
                        <span style=color:#ff79c6>if</span> (checkpass[<span style=color:#f1fa8c>&#39;substring&#39;</span>](<span style=color:#bd93f9>0x6</span>, <span style=color:#bd93f9>0xb</span>) <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#39;F{not&#39;</span>) {
                            <span style=color:#ff79c6>if</span> (checkpass[<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x2&#39;</span>)](split <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x2</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x2</span>, split <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x3</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x2</span>) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x6&#39;</span>)) {
                                <span style=color:#ff79c6>if</span> (checkpass[<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x2&#39;</span>)](<span style=color:#bd93f9>0xc</span>, <span style=color:#bd93f9>0x10</span>) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x7&#39;</span>)) {
                                    alert(<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x8&#39;</span>));
                                }
                            }
                        }
                    }
                }
            }
        }
    } <span style=color:#ff79c6>else</span> {
        alert(<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x9&#39;</span>));
    }
}
</code></pre></td></tr></table>
</div>
</div><p>At this stage, I am only interested the verify <code>function</code> with rows starting with <code>if (checkpass</code>.
But to make code more readable, I use the Firefox console to translate some of the code:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>_0x4b5b(&lsquo;0x2&rsquo;)</td>
<td>substring</td>
</tr>
<tr>
<td>checkpass[_0x4b5b(&lsquo;0x2&rsquo;)]</td>
<td>function substring</td>
</tr>
<tr>
<td>_0x4b5b(&lsquo;0x3&rsquo;)</td>
<td>&ldquo;picoCTF{&rdquo;</td>
</tr>
<tr>
<td>_0x4b5b(&lsquo;0x4&rsquo;)</td>
<td>&ldquo;not_this&rdquo;</td>
</tr>
<tr>
<td>_0x4b5b(&lsquo;0x5&rsquo;)</td>
<td>&ldquo;f49bf}&rdquo;</td>
</tr>
<tr>
<td>_0x4b5b(&lsquo;0x6&rsquo;)</td>
<td>&ldquo;_again_e&rdquo;</td>
</tr>
<tr>
<td>_0x4b5b(&lsquo;0x7&rsquo;)</td>
<td>&ldquo;this&rdquo;</td>
</tr>
<tr>
<td>_0x4b5b(&lsquo;0x8&rsquo;)</td>
<td>&ldquo;Password Verified&rdquo;</td>
</tr>
<tr>
<td>split * 0x2</td>
<td>8</td>
</tr>
<tr>
<td>split * 0x2 * 0x2</td>
<td>16</td>
</tr>
<tr>
<td>split * 0x3 * 0x2</td>
<td>24</td>
</tr>
<tr>
<td>split * 0x4 * 0x2</td>
<td>32</td>
</tr>
</tbody>
</table>
<p>We can now rewrite the code in a way it is more readable:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#8be9fd;font-style:italic>function</span> verify() {
    checkpass <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>document</span>[<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x0&#39;</span>)](<span style=color:#f1fa8c>&#39;pass&#39;</span>)[<span style=color:#bd93f9>_0</span>x4b5b(<span style=color:#f1fa8c>&#39;0x1&#39;</span>)];
    split <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0x4</span>;
    <span style=color:#ff79c6>if</span> (substring(<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>8</span>) <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;picoCTF{&#34;</span> {
        <span style=color:#ff79c6>if</span> (substring(<span style=color:#bd93f9>7</span>, <span style=color:#bd93f9>9</span>) <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#39;{n&#39;</span>) {
            <span style=color:#ff79c6>if</span> (substring(<span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>16</span>) <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;not_this&#34;</span> {
                <span style=color:#ff79c6>if</span> (substring(<span style=color:#bd93f9>3</span>, <span style=color:#bd93f9>6</span>) <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#39;oCT&#39;</span>) {
                    <span style=color:#ff79c6>if</span> (substring(<span style=color:#bd93f9>24</span>, <span style=color:#bd93f9>32</span>) <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;f49bf}&#34;</span> {
                        <span style=color:#ff79c6>if</span> (substring(<span style=color:#bd93f9>6</span>, <span style=color:#bd93f9>11</span>) <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#39;F{not&#39;</span>) {
                            <span style=color:#ff79c6>if</span> (substring(<span style=color:#bd93f9>16</span>, <span style=color:#bd93f9>24</span>) <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;_again_e&#34;</span> {
                                <span style=color:#ff79c6>if</span> (substring(<span style=color:#bd93f9>12</span>, <span style=color:#bd93f9>16</span>) <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;this&#34;</span> {
                                    alert(<span style=color:#f1fa8c>&#34;Password Verified&#34;</span>);
                                }
                            }
                        }
                    }
                }
            }
        }
</code></pre></td></tr></table>
</div>
</div><p>Flag is: <code>picoCTF{not_this_again_ef49bf}</code></p>
<h2 id=asm2>asm2</h2>
<pre><code>What does asm2(0xb,0x2e) return?
</code></pre>
<p>This is how the stack looks like after the prolog:</p>
<pre><code>| 0x2e      | &lt;-- ebp+0xc (ebp+12)
| 0xb       | &lt;-- ebp+8
| ret       | &lt;-- ebp+4
| old ebp   | &lt;-- new ebp
</code></pre>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#8be9fd;font-style:italic>asm2:</span>
	&lt;+0&gt;:	<span style=color:#50fa7b>push</span>   ebp                      <span style=color:#6272a4>; prolog ;
</span><span style=color:#6272a4></span>	&lt;+<span style=color:#bd93f9>1</span>&gt;:	mov    ebp,esp                  <span style=color:#6272a4>; prolog ; ebp+8 = 0xb and ebp+0xc = 0x2e
</span><span style=color:#6272a4></span>	&lt;+<span style=color:#bd93f9>3</span>&gt;:	sub    esp,<span style=color:#bd93f9>0x10</span>
	&lt;+6&gt;:	<span style=color:#50fa7b>mov</span>    eax,DWORD PTR [ebp+<span style=color:#bd93f9>0xc</span>]  <span style=color:#6272a4>; eax = 0x2e
</span><span style=color:#6272a4></span>	&lt;+<span style=color:#bd93f9>9</span>&gt;:	mov    DWORD PTR [ebp-0x4],eax  <span style=color:#6272a4>; tmp = 0x2e (let&#39;s label ebp-4 as tmp local variable)
</span><span style=color:#6272a4></span>	&lt;+<span style=color:#bd93f9>12</span>&gt;:	mov    eax,DWORD PTR [ebp+<span style=color:#bd93f9>0x8</span>]  <span style=color:#6272a4>; eax = 0xb
</span><span style=color:#6272a4></span>	&lt;+<span style=color:#bd93f9>15</span>&gt;:	mov    DWORD PTR [ebp-0x8],eax  <span style=color:#6272a4>; tmp2 = 0xb (let&#39;s label ebp-8 as tmp2 local variable)
</span><span style=color:#6272a4></span>	&lt;+<span style=color:#bd93f9>18</span>&gt;:	jmp    <span style=color:#bd93f9>0x509</span> &lt;asm2+<span style=color:#bd93f9>28</span>&gt;
	&lt;+20&gt;:	<span style=color:#50fa7b>add</span>    DWORD PTR [ebp-0x4],<span style=color:#bd93f9>0x1</span>          <span style=color:#6272a4>; tmp += 1
</span><span style=color:#6272a4></span>	&lt;+<span style=color:#bd93f9>24</span>&gt;:	sub    DWORD PTR [ebp-0x8],<span style=color:#bd93f9>0xffffff80</span>   <span style=color:#6272a4>; tmp2 -= -128 (because 0xffffff80 = -128)
</span><span style=color:#6272a4></span>	&lt;+<span style=color:#bd93f9>28</span>&gt;:	cmp    DWORD PTR [ebp-0x8],<span style=color:#bd93f9>0x63f3</span>       <span style=color:#6272a4>; tmp2 &lt; 0x63f3
</span><span style=color:#6272a4></span>	&lt;+<span style=color:#bd93f9>35</span>&gt;:	jle    <span style=color:#bd93f9>0x501</span> &lt;asm2+<span style=color:#bd93f9>20</span>&gt;                  <span style=color:#6272a4>; while(tmp2 &lt;= 0x63f3)
</span><span style=color:#6272a4></span>	&lt;+<span style=color:#bd93f9>37</span>&gt;:	mov    eax,DWORD PTR [ebp-0x4]          <span style=color:#6272a4>; eax = tmp
</span><span style=color:#6272a4></span>	&lt;+<span style=color:#bd93f9>40</span>&gt;:	leave
	&lt;+41&gt;:	<span style=color:#50fa7b>ret</span>                                     <span style=color:#6272a4>; ret tmp
</span></code></pre></td></tr></table>
</div>
</div><p>Note that <code>0xffffff80</code> is a signed integer with value <code>-128</code>.
This is because the most significant bit represents the sign (0 if positive, 1 if negative) and the remaining 7 bits are the actual value.
it can be represented in this table:</p>
<table>
<thead>
<tr>
<th style=text-align:right>byte4</th>
<th style=text-align:right>byte3</th>
<th style=text-align:right>byte2</th>
<th style=text-align:right>byte1</th>
<th style=text-align:left></th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:right></td>
<td style=text-align:right></td>
<td style=text-align:right></td>
<td style=text-align:right>80</td>
<td style=text-align:left>8 bit signed</td>
</tr>
<tr>
<td style=text-align:right></td>
<td style=text-align:right></td>
<td style=text-align:right></td>
<td style=text-align:right>10000000</td>
<td style=text-align:left>8 bit signed</td>
</tr>
<tr>
<td style=text-align:right></td>
<td style=text-align:right></td>
<td style=text-align:right>ff</td>
<td style=text-align:right>80</td>
<td style=text-align:left>16 bit signed</td>
</tr>
<tr>
<td style=text-align:right></td>
<td style=text-align:right></td>
<td style=text-align:right>11111111</td>
<td style=text-align:right>10000000</td>
<td style=text-align:left>16 bit signed</td>
</tr>
<tr>
<td style=text-align:right>ff</td>
<td style=text-align:right>ff</td>
<td style=text-align:right>ff</td>
<td style=text-align:right>80</td>
<td style=text-align:left>32 bit signed</td>
</tr>
<tr>
<td style=text-align:right>11111111</td>
<td style=text-align:right>11111111</td>
<td style=text-align:right>11111111</td>
<td style=text-align:right>10000000</td>
<td style=text-align:left>32 bit signed</td>
</tr>
</tbody>
</table>
<p>The above assembly code translates into python:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>asm2</span>(arg1, arg2):
    tmp  <span style=color:#ff79c6>=</span> arg2
    tmp2 <span style=color:#ff79c6>=</span> arg1
    <span style=color:#ff79c6>while</span> tmp2 <span style=color:#ff79c6>&lt;=</span> <span style=color:#bd93f9>0x63f3</span>:
      tmp <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>1</span>
      tmp2 <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>128</span>
    <span style=color:#ff79c6>return</span> tmp

<span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#8be9fd;font-style:italic>hex</span>(asm2(<span style=color:#bd93f9>0xb</span>, <span style=color:#bd93f9>0x2e</span>))
</code></pre></td></tr></table>
</div>
</div><h2 id=m00nwalk>m00nwalk</h2>
<p>pass</p>
<h2 id=whitepages>WhitePages</h2>
<pre><code>file whitepages.txt
whitepages.txt: UTF-8 Unicode text, with very long lines, with no line terminators
</code></pre>
<p>We can note a pattern <code>e28083</code> and <code>e2808320</code>:</p>
<pre><code>cat whitepages.txt | xxd | head
00000000: e280 83e2 8083 e280 83e2 8083 20e2 8083  ............ ...
00000010: 20e2 8083 e280 83e2 8083 e280 83e2 8083   ...............
00000020: 20e2 8083 e280 8320 e280 83e2 8083 e280   ...... ........
00000030: 83e2 8083 20e2 8083 e280 8320 e280 8320  .... ...... ...
00000040: 2020 e280 83e2 8083 e280 83e2 8083 e280    ..............
00000050: 8320 20e2 8083 20e2 8083 e280 8320 e280  .  ... ...... ..
00000060: 8320 20e2 8083 e280 83e2 8083 2020 e280  .  .........  ..
00000070: 8320 20e2 8083 2020 2020 e280 8320 e280  .  ...    ... ..
00000080: 83e2 8083 e280 83e2 8083 2020 e280 8320  ..........  ...
00000090: e280 8320 e280 8320 e280 83e2 8083 e280  ... ... ........
</code></pre>
<p>Since there is only two values, maybe it&rsquo;s some kind of binary encoding.
I first tried with <code>\u2003</code> as binary 1 and <code>\x20</code> as binary 0, but it did not show anything readable.</p>
<p>Then I have rewritten the below code and switch 0 and 1 to see that the flag was indeed visible:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#6272a4>#!/usr/bin/env python3</span>
<span style=color:#ff79c6>import</span> re

f <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>open</span>(<span style=color:#f1fa8c>&#34;./whitepages.txt&#34;</span>, mode<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#39;r&#39;</span>, encoding<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;utf-8&#34;</span>)
whitespace <span style=color:#ff79c6>=</span> f<span style=color:#ff79c6>.</span>read()
binary <span style=color:#ff79c6>=</span> [<span style=color:#f1fa8c>&#39;0&#39;</span> <span style=color:#ff79c6>if</span> x <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>\u2003</span><span style=color:#f1fa8c>&#34;</span> <span style=color:#ff79c6>else</span> <span style=color:#f1fa8c>&#39;1&#39;</span> <span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> whitespace]
binary_str <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;&#39;</span><span style=color:#ff79c6>.</span>join(binary)

hex_str <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>hex</span>(<span style=color:#8be9fd;font-style:italic>int</span>(binary_str, <span style=color:#bd93f9>2</span>))

<span style=color:#ff79c6>def</span> <span style=color:#50fa7b>pad_hex</span>(some_hex_str):
    <span style=color:#ff79c6>if</span> <span style=color:#8be9fd;font-style:italic>len</span>(some_hex_str) <span style=color:#ff79c6>%</span> <span style=color:#bd93f9>2</span>:
        <span style=color:#ff79c6>return</span> <span style=color:#f1fa8c>&#34;0&#34;</span> <span style=color:#ff79c6>+</span> hex_str[<span style=color:#bd93f9>2</span>:]
    <span style=color:#ff79c6>return</span> hex_str[<span style=color:#bd93f9>2</span>:]


byte_array <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(pad_hex(hex_str))

flag <span style=color:#ff79c6>=</span> re<span style=color:#ff79c6>.</span>findall(<span style=color:#f1fa8c>&#34;picoCTF{.*}&#34;</span>, byte_array<span style=color:#ff79c6>.</span>decode())[<span style=color:#bd93f9>0</span>]
<span style=color:#8be9fd;font-style:italic>print</span>(flag)
</code></pre></td></tr></table>
</div>
</div><h2 id=c0rrupt>c0rrupt</h2>
<p>Unable to detect the file type</p>
<pre><code>file mystery
mystery: data
</code></pre>
<p>There is a Hint:</p>
<pre><code>Try fixing the file header
</code></pre>
<p>Examining the header, we can see words <code>gAMA</code>, <code>sRGB</code> and <code>pHYs</code> so perhaps it is an image?</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat mystery | xxd | head
00000000: <span style=color:#bd93f9>8965</span> 4e34 0d0a b0aa <span style=color:#bd93f9>0000</span> 000d <span style=color:#bd93f9>4322</span> <span style=color:#bd93f9>4452</span>  .eN4........C<span style=color:#f1fa8c>&#34;DR
</span><span style=color:#f1fa8c>00000010: 0000 066a 0000 0447 0802 0000 007c 8bab  ...j...G.....|..
</span><span style=color:#f1fa8c>00000020: 7800 0000 0173 5247 4200 aece 1ce9 0000  x....sRGB.......
</span><span style=color:#f1fa8c>00000030: 0004 6741 4d41 0000 b18f 0bfc 6105 0000  ..gAMA......a...
</span><span style=color:#f1fa8c>00000040: 0009 7048 5973 aa00 1625 0000 1625 0149  ..pHYs...%...%.I
</span><span style=color:#f1fa8c>00000050: 5224 f0aa aaff a5ab 4445 5478 5eec bd3f  R</span>$<span style=color:#f1fa8c>......DETx^..?
</span><span style=color:#f1fa8c>00000060: 8e64 cd71 bd2d 8b20 2080 9041 8302 08d0  .d.q.-.  ..A....
</span><span style=color:#f1fa8c>00000070: f9ed 40a0 f36e 407b 9023 8f1e d720 8b3e  ..@..n@{.#... .&gt;
</span><span style=color:#f1fa8c>00000080: b7c1 0d70 0374 b503 ae41 6bf8 bea8 fbdc  ...p.t...Ak.....
</span><span style=color:#f1fa8c>00000090: 3e7d 2a22 336f de5b 55dd 3d3d f920 9188  &gt;}*&#34;</span>3o.<span style=color:#ff79c6>[</span>U.<span style=color:#ff79c6>==</span>. ..
</code></pre></td></tr></table>
</div>
</div><p>I am examining another PNG file, and find A LOT of similarities:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat flag.png | xxd | head
00000000: <span style=color:#bd93f9>8950</span> 4e47 0d0a 1a0a <span style=color:#bd93f9>0000</span> 000d <span style=color:#bd93f9>4948</span> <span style=color:#bd93f9>4452</span>  .PNG........IHDR
00000010: <span style=color:#bd93f9>0000</span> 066a <span style=color:#bd93f9>0000</span> <span style=color:#bd93f9>0447</span> <span style=color:#bd93f9>0802</span> <span style=color:#bd93f9>0000</span> 007c 8bab  ...j...G.....|..
00000020: <span style=color:#bd93f9>7800</span> <span style=color:#bd93f9>0000</span> <span style=color:#bd93f9>0173</span> <span style=color:#bd93f9>5247</span> <span style=color:#bd93f9>4200</span> aece 1ce9 <span style=color:#bd93f9>0000</span>  x....sRGB.......
00000030: <span style=color:#bd93f9>0004</span> <span style=color:#bd93f9>6741</span> 4d41 <span style=color:#bd93f9>0000</span> b18f 0bfc <span style=color:#bd93f9>6105</span> <span style=color:#bd93f9>0000</span>  ..gAMA......a...
00000040: <span style=color:#bd93f9>0009</span> <span style=color:#bd93f9>7048</span> <span style=color:#bd93f9>5973</span> <span style=color:#bd93f9>0000</span> <span style=color:#bd93f9>1625</span> <span style=color:#bd93f9>0000</span> <span style=color:#bd93f9>1625</span> <span style=color:#bd93f9>0149</span>  ..pHYs...%...%.I
00000050: <span style=color:#bd93f9>5224</span> f000 00a8 8e49 <span style=color:#bd93f9>4441</span> <span style=color:#bd93f9>5478</span> 5eec dd2d  R$.....IDATx^..-
00000060: 94dc 46da 30ec <span style=color:#bd93f9>0718</span> 0e34 0c34 0c0c dab3  ..F.0....4.4....
00000070: <span style=color:#bd93f9>3030</span> 70e1 c23d 8b0c 0d0d 0d03 <span style=color:#bd93f9>1618</span> <span style=color:#bd93f9>0606</span>  00p..<span style=color:#ff79c6>=</span>..........
00000080: 06e6 3cc8 e001 <span style=color:#bd93f9>8686</span> 666b <span style=color:#bd93f9>1868</span> e8f3 a29c  ..&lt;.....fk.h....
00000090: f37d 25d5 8fee 2aa9 66ba 67ba c73f b9ae  .<span style=color:#ff79c6>}</span>%...*.f.g..?..
</code></pre></td></tr></table>
</div>
</div><p>As per the <a href=http://www.libpng.org/pub/png/spec/1.2/PNG-Rationale.html#R.PNG-file-signature>PNG specifications - 12.12. PNG file signature</a>,
the first eight bytes of a PNG file always contain the following values:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>(hexadecimal)</td>
<td>89 50 4e 47 0d 0a 1a 0a</td>
</tr>
<tr>
<td>(ASCII C notation)</td>
<td>\211 P N G \r \n \032 \n</td>
</tr>
</tbody>
</table>
<p>A decoder may further verify that the next eight bytes contain an IHDR chunk header.
According to <a href=http://www.libpng.org/pub/png/spec/1.2/PNG-Structure.html>PNG Structure - 3.2. Chunk layout</a>,
the Chunk structure is:</p>
<table>
<thead>
<tr>
<th></th>
<th>Length</th>
<th>Type</th>
<th>Data</th>
<th>CRC</th>
</tr>
</thead>
<tbody>
<tr>
<td>size</td>
<td>4 bytes</td>
<td>4 bytes</td>
<td>see Chunk Length</td>
<td>4 bytes</td>
</tr>
<tr>
<td>type</td>
<td>unsigned int</td>
<td>Ascii</td>
<td></td>
<td>Hex</td>
</tr>
</tbody>
</table>
<p>Let&rsquo;s verify the IHDR chunk:</p>
<table>
<thead>
<tr>
<th></th>
<th>Length</th>
<th>Type</th>
<th>Data</th>
<th>CRC</th>
</tr>
</thead>
<tbody>
<tr>
<td>we have</td>
<td>0xd (13)</td>
<td>C"DR</td>
<td>0000 066a 0000 0447 0802 0000 00</td>
<td>7c 8bab 78</td>
</tr>
<tr>
<td>we should have</td>
<td>0xd (13)</td>
<td>IHDR</td>
<td>0000 066a 0000 0447 0802 0000 00</td>
<td>7c 8bab 78</td>
</tr>
</tbody>
</table>
<p>Let&rsquo;s try to patch the first line (16 bytes) of this file header:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cp mystery mystery-patched

<span style=color:#6272a4># BEFORE seek 16 bytes at offset 0</span>
xxd -s <span style=color:#bd93f9>0</span> -l <span style=color:#bd93f9>16</span> mystery-patched
<span style=color:#6272a4>#00000000: 8965 4e34 0d0a b0aa 0000 000d 4322 4452  .eN4........C&#34;DR</span>

<span style=color:#6272a4># PATCH</span>
<span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;00000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452&#34;</span> | xxd -r - mystery-patched

<span style=color:#6272a4># AFTER show 16 bytes at offset 0</span>
xxd -s <span style=color:#bd93f9>0</span> -l <span style=color:#bd93f9>16</span> mystery-patched
<span style=color:#6272a4>#00000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452  .PNG........IHDR</span>

<span style=color:#6272a4># Check file</span>
file mystery-patched
<span style=color:#6272a4>#mystery-patched: PNG image data, 1642 x 1095, 8-bit/color RGB, non-interlaced</span>
</code></pre></td></tr></table>
</div>
</div><p>The file can&rsquo;t be open so there may be another corruption. We can examine the PNG is valid with a small utility:</p>
<pre><code>sudo apt install pngcheck
pngcheck mystery-patched
mystery-patched  CRC error in chunk pHYs (computed 38d82c82, expected 495224f0
</code></pre>
<p>Lets examine the pHYs header:</p>
<table>
<thead>
<tr>
<th></th>
<th>Length</th>
<th>Type</th>
<th>Data</th>
<th>CRC</th>
</tr>
</thead>
<tbody>
<tr>
<td>we have</td>
<td>0x9</td>
<td>pHYs</td>
<td>aa00 1625 0000 1625 01</td>
<td>49 5224 f0</td>
</tr>
</tbody>
</table>
<p>Either the checksum or the Data is corrupted.
According to <a href=http://www.libpng.org/pub/png/spec/1.2/PNG-Chunks.html#C.pHYs>4.2.4.2. pHYs Physical pixel dimensions</a>,
this particular chunk has this structure:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Pixels per unit, X axis: 4 bytes (unsigned integer)</td>
<td>aa00 1625</td>
</tr>
<tr>
<td>Pixels per unit, Y axis: 4 bytes (unsigned integer)</td>
<td>0000 1625</td>
</tr>
<tr>
<td>Unit specifier: 1 byte</td>
<td>0x1</td>
</tr>
</tbody>
</table>
<p>Pixels per unit on the X axis with value <code>aa001625</code> is a huge number which does not makes any sense,
it is more probable that the value should be same as for the Y axis with <code>0x1625</code></p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#6272a4># BEFORE see byte at position 0x46</span>
xxd -s 0x46 -l <span style=color:#bd93f9>1</span> mystery-patched
<span style=color:#6272a4># 00000046: aa                                       .</span>

<span style=color:#6272a4># PATCH</span>
<span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;00000046: 00&#34;</span> | xxd -r - mystery-patched

<span style=color:#6272a4># VERIFY PATCHING</span>
xxd -s 0x46 -l <span style=color:#bd93f9>1</span> mystery-patched
<span style=color:#6272a4># 00000046: 00</span>

<span style=color:#6272a4># CHECKSUM VERIFICATION</span>
pngcheck -v mystery-patched
File: mystery-patched <span style=color:#ff79c6>(</span><span style=color:#bd93f9>202940</span> bytes<span style=color:#ff79c6>)</span>
  chunk IHDR at offset 0x0000c, length <span style=color:#bd93f9>13</span>
    <span style=color:#bd93f9>1642</span> x <span style=color:#bd93f9>1095</span> image, 24-bit RGB, non-interlaced
  chunk sRGB at offset 0x00025, length <span style=color:#bd93f9>1</span>
    rendering <span style=color:#8be9fd;font-style:italic>intent</span> <span style=color:#ff79c6>=</span> perceptual
  chunk gAMA at offset 0x00032, length 4: 0.45455
  chunk pHYs at offset 0x00042, length 9: 5669x5669 pixels/meter <span style=color:#ff79c6>(</span><span style=color:#bd93f9>144</span> dpi<span style=color:#ff79c6>)</span>
:  invalid chunk length <span style=color:#ff79c6>(</span>too large<span style=color:#ff79c6>)</span>
</code></pre></td></tr></table>
</div>
</div><p>No more errors on <code>pHYs</code> chunk but an issue is detected on the following chunk <code>.DET</code> which is invalid (first character is not ascii)
and does not exist in the spec; The closest that comes to mind when comparing with other PNG is <code>IDAT</code>. Let&rsquo;s examine the Chunk</p>
<table>
<thead>
<tr>
<th></th>
<th>Length</th>
<th>Type</th>
<th>Data</th>
<th>CRC</th>
</tr>
</thead>
<tbody>
<tr>
<td>we have</td>
<td>0xaaaaffa5 ()</td>
<td>.DET</td>
<td>aa00 1625 0000 1625 01</td>
<td>49 5224 f0</td>
</tr>
</tbody>
</table>
<p>We can obtain the true size of the IDAT chunk if we can find the offset of the next chunk.
The next chunk is either another <code>IDAT </code> or an <code>IEND</code> chunk of size zero, which terminates the file:</p>
<pre tabindex=0><code>xxd mystery-patched | grep IDAT
00000050: 5224 f000 0318 4b49 4441 5478 5eec bd3f  R$....KIDATx^..?
00010000: 6927 db59 0000 fff4 4944 4154 3697 4678  i'.Y....IDAT6.Fx
00020000: ba6b c1fa 0000 fff4 4944 4154 d5df c0b7  .k......IDAT....
00030000: 5997 d200 0000 18a0 4944 4154 bb9d f54c  Y.......IDAT...L
</code></pre><p>Because I am using grep to find IDAT chunks, I have to run the xxd command twice.
This is to avoid missing an IDAT chunk being split between two rows of the xxd output.</p>
<ul>
<li>The first xxd uses default 16 columns (see above)</li>
<li>The second uses 8 columns (see below)</li>
</ul>
<pre tabindex=0><code>xxd -c 8 mystery-patched | grep IDAT
00010008: 4944 4154 3697 4678  IDAT6.Fx
00020008: 4944 4154 d5df c0b7  IDAT....
00030008: 4944 4154 bb9d f54c  IDAT...L
</code></pre><p>Now it becomes simpler, and we can calculate the size with <code>0xffa5 = hex(0x10004 -4 -0x5b)</code></p>
<table>
<thead>
<tr>
<th>chunk</th>
<th>field</th>
<th>offset</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr>
<td>IDAT</td>
<td>length</td>
<td>0x53</td>
<td>4</td>
</tr>
<tr>
<td>IDAT</td>
<td>Type</td>
<td>0x57</td>
<td>4</td>
</tr>
<tr>
<td>IDAT</td>
<td>Data</td>
<td>0x5b</td>
<td><code>0x10004 -4 -0x5b</code></td>
</tr>
<tr>
<td>IDAT</td>
<td>CRC</td>
<td><code>0x10004 -4</code></td>
<td>4</td>
</tr>
<tr>
<td>next IDAT</td>
<td>length</td>
<td>0x10004</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>Patching type</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#6272a4># Before seek 4-bytes Type at offset 0x57</span>
xxd -s 0x53 -l <span style=color:#bd93f9>8</span> mystery-patched
00000053: aaaa ffa5 ab44 <span style=color:#bd93f9>4554</span>                                .....DET

<span style=color:#6272a4># PATCH</span>
<span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;00000053: 0000 ffa5 4944 4154&#34;</span> | xxd -r - mystery-patched

<span style=color:#6272a4># After</span>
xxd -s 0x53 -l <span style=color:#bd93f9>8</span> mystery-patched
00000053: <span style=color:#bd93f9>0000</span> ffa5 <span style=color:#bd93f9>4944</span> <span style=color:#bd93f9>4154</span>                      ....IDAT

<span style=color:#6272a4># Verify header</span>
pngcheck -v mystery-patched
File: mystery-patched <span style=color:#ff79c6>(</span><span style=color:#bd93f9>202940</span> bytes<span style=color:#ff79c6>)</span>
  chunk IHDR at offset 0x0000c, length <span style=color:#bd93f9>13</span>
    <span style=color:#bd93f9>1642</span> x <span style=color:#bd93f9>1095</span> image, 24-bit RGB, non-interlaced
  chunk sRGB at offset 0x00025, length <span style=color:#bd93f9>1</span>
    rendering <span style=color:#8be9fd;font-style:italic>intent</span> <span style=color:#ff79c6>=</span> perceptual
  chunk gAMA at offset 0x00032, length 4: 0.45455
  chunk pHYs at offset 0x00042, length 9: 5669x5669 pixels/meter <span style=color:#ff79c6>(</span><span style=color:#bd93f9>144</span> dpi<span style=color:#ff79c6>)</span>
  chunk IDAT at offset 0x00057, length <span style=color:#bd93f9>65445</span>
    zlib: deflated, 32K window, fast compression
  chunk IDAT at offset 0x10008, length <span style=color:#bd93f9>65524</span>
  chunk IDAT at offset 0x20008, length <span style=color:#bd93f9>65524</span>
  chunk IDAT at offset 0x30008, length <span style=color:#bd93f9>6304</span>
  chunk IEND at offset 0x318b4, length <span style=color:#bd93f9>0</span>
No errors detected in mystery-patched <span style=color:#ff79c6>(</span><span style=color:#bd93f9>9</span> chunks, 96.3% compression<span style=color:#ff79c6>)</span>.
</code></pre></td></tr></table>
</div>
</div><p>Et voila! now the PNG files can be opened, but it seems all black image :/</p>
<p>picoCTF{c0rrupt10n_1847995}</p>
<h2 id=vault-door-4>vault-door-4</h2>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>boolean</span> <span style=color:#50fa7b>checkPassword</span><span style=color:#ff79c6>(</span>String password<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
        <span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> passBytes <span style=color:#ff79c6>=</span> password<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getBytes</span><span style=color:#ff79c6>();</span>
        <span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> myBytes <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>{</span>
            106 <span style=color:#ff79c6>,</span> 85  <span style=color:#ff79c6>,</span> 53  <span style=color:#ff79c6>,</span> 116 <span style=color:#ff79c6>,</span> 95  <span style=color:#ff79c6>,</span> 52  <span style=color:#ff79c6>,</span> 95  <span style=color:#ff79c6>,</span> 98  <span style=color:#ff79c6>,</span>
            0x55<span style=color:#ff79c6>,</span> 0x6e<span style=color:#ff79c6>,</span> 0x43<span style=color:#ff79c6>,</span> 0x68<span style=color:#ff79c6>,</span> 0x5f<span style=color:#ff79c6>,</span> 0x30<span style=color:#ff79c6>,</span> 0x66<span style=color:#ff79c6>,</span> 0x5f<span style=color:#ff79c6>,</span>
            0142<span style=color:#ff79c6>,</span> 0131<span style=color:#ff79c6>,</span> 0164<span style=color:#ff79c6>,</span> 063 <span style=color:#ff79c6>,</span> 0163<span style=color:#ff79c6>,</span> 0137<span style=color:#ff79c6>,</span> 0146<span style=color:#ff79c6>,</span> 064 <span style=color:#ff79c6>,</span>
            <span style=color:#f1fa8c>&#39;a&#39;</span> <span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#39;8&#39;</span> <span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#39;c&#39;</span> <span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#39;d&#39;</span> <span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#39;8&#39;</span> <span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#39;f&#39;</span> <span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#39;7&#39;</span> <span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#39;e&#39;</span> <span style=color:#ff79c6>,</span>
        <span style=color:#ff79c6>};</span>
        <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span><span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span>0<span style=color:#ff79c6>;</span> i<span style=color:#ff79c6>&lt;</span>32<span style=color:#ff79c6>;</span> i<span style=color:#ff79c6>++)</span> <span style=color:#ff79c6>{</span>
            <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>(</span>passBytes<span style=color:#ff79c6>[</span>i<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>!=</span> myBytes<span style=color:#ff79c6>[</span>i<span style=color:#ff79c6>])</span> <span style=color:#ff79c6>{</span>
                <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>false</span><span style=color:#ff79c6>;</span>
            <span style=color:#ff79c6>}</span>
        <span style=color:#ff79c6>}</span>
        <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>true</span><span style=color:#ff79c6>;</span>
    <span style=color:#ff79c6>}</span>
</code></pre></td></tr></table>
</div>
</div><p>python:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3>password <span style=color:#ff79c6>=</span> [
    <span style=color:#bd93f9>106</span> , <span style=color:#bd93f9>85</span>  , <span style=color:#bd93f9>53</span>  , <span style=color:#bd93f9>116</span> , <span style=color:#bd93f9>95</span>  , <span style=color:#bd93f9>52</span>  , <span style=color:#bd93f9>95</span>  , <span style=color:#bd93f9>98</span>  ,
    <span style=color:#bd93f9>0x55</span>, <span style=color:#bd93f9>0x6e</span>, <span style=color:#bd93f9>0x43</span>, <span style=color:#bd93f9>0x68</span>, <span style=color:#bd93f9>0x5f</span>, <span style=color:#bd93f9>0x30</span>, <span style=color:#bd93f9>0x66</span>, <span style=color:#bd93f9>0x5f</span>,
    <span style=color:#bd93f9>0o142</span>, <span style=color:#bd93f9>0o131</span>, <span style=color:#bd93f9>0o164</span>, <span style=color:#bd93f9>0o63</span> , <span style=color:#bd93f9>0o163</span>, <span style=color:#bd93f9>0o137</span>, <span style=color:#bd93f9>0o146</span>, <span style=color:#bd93f9>0o064</span> ,
    <span style=color:#f1fa8c>&#39;a&#39;</span> , <span style=color:#f1fa8c>&#39;8&#39;</span> , <span style=color:#f1fa8c>&#39;c&#39;</span> , <span style=color:#f1fa8c>&#39;d&#39;</span> , <span style=color:#f1fa8c>&#39;8&#39;</span> , <span style=color:#f1fa8c>&#39;f&#39;</span> , <span style=color:#f1fa8c>&#39;7&#39;</span> , <span style=color:#f1fa8c>&#39;e&#39;</span>
    ]

flag <span style=color:#ff79c6>=</span> []
flag<span style=color:#ff79c6>.</span>extend([<span style=color:#8be9fd;font-style:italic>chr</span>(password[x]) <span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>,<span style=color:#bd93f9>8</span>)] )
flag<span style=color:#ff79c6>.</span>extend([<span style=color:#8be9fd;font-style:italic>chr</span>(password[x]) <span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>8</span>,<span style=color:#bd93f9>16</span>)])
flag<span style=color:#ff79c6>.</span>extend([<span style=color:#8be9fd;font-style:italic>chr</span>(password[x]) <span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>16</span>,<span style=color:#bd93f9>24</span>)])
flag<span style=color:#ff79c6>.</span>extend([    password[x]  <span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>24</span>,<span style=color:#bd93f9>32</span>)])

<span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;picoCTF{</span><span style=color:#f1fa8c>%s</span><span style=color:#f1fa8c>}&#34;</span> <span style=color:#ff79c6>%</span> <span style=color:#f1fa8c>&#39;&#39;</span><span style=color:#ff79c6>.</span>join(flag))
</code></pre></td></tr></table>
</div>
</div><h2 id=like1000>like1000</h2>
<pre><code>curl -LOs https://jupiter.challenges.picoctf.org/static/52084b5ad360b25f9af83933114324e0/1000.tar
for i in `seq 1000 -1 1`; do tar -xvf $i.tar ; rm $i.tar ; done
open flag.png
</code></pre>
<p>Flag: picoCTF{l0t5_0f_TAR5}</p>
<h2 id=droids0>droids0</h2>
<p>Hints:</p>
<ol>
<li>Try using an emulator or device</li>
<li><a href=https://developer.android.com/studio>https://developer.android.com/studio</a></li>
</ol>
<p>pass</p>
<h2 id=mus1c>mus1c</h2>
<p>Rockstar is a programming language which gnerates code that can be sing as the lyric of a metal ballad.
Copying the song lyrics in this <a href=https://codewithrockstar.com/online>online interpreter</a> provides
an output that seems to be ascii. We will parse in python</p>
<pre tabindex=0><code>ascii = &quot;&quot;&quot;
114
114
114
111
99
107
110
114
110
48
49
49
51
114
&quot;&quot;&quot;

flag = &quot;&quot;
for i in ascii.strip().split('\n'):
    flag += chr(int(i))

print(&quot;picoCTF{%s}&quot; % flag)
</code></pre><h2 id=waves-over-lambda>Waves over Lambda</h2>
<p>This is a substitution cipher which reminds me an old challenge called <a href=https://0xade1.github.io/posts/2019/12/picoctf-2018-cryptography/#hertz>picoCTF2018 - Hertz</a> . I can simply reuse the exact same code:</p>
<pre><code>nc jupiter.challenges.picoctf.org 39894 | tee hertz.txt
-------------------------------------------------------------------------------
xealtywj crtr pj geqt iuyl - itrbqraxg_pj_x_evrt_uydksy_yliuxlwgqr
-------------------------------------------------------------------------------
yurfrg igesetevpwxc nytydyzev hyj wcr wcpts jea ei igeset myvuevpwxc nytydyzev, y uyas ehart hruu naeha pa eqt spjwtpxw pa cpj eha syg, yas jwpuu trdrdkrtrs ydeal qj ehpal we cpj lueedg yas wtylpx srywc, hcpxc cymmrars wcptwrra grytj yle, yas hcpxc p jcyuu srjxtpkr pa pwj mtemrt muyxr. iet wcr mtrjraw p hpuu eaug jyg wcyw wcpj uyasehartiet je hr qjrs we xyuu cpd, yuwceqlc cr cytsug jmraw y syg ei cpj upir ea cpj eha rjwywrhyj y jwtyalr wgmr, grw ear mtrwwg itrbqrawug we kr drw hpwc, y wgmr ykorxw yas vpxpeqj yas yw
</code></pre>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>python3 break_substitution_cipher.py
Substitution Cipher solver, you may have to <span style=color:#8be9fd;font-style:italic>wait</span> several iterations
<span style=color:#ff79c6>for</span> the correct result. Press ctrl+c to <span style=color:#8be9fd;font-style:italic>exit</span> program.

best score so far: -4389.788611254096 on iteration <span style=color:#bd93f9>1</span>
best key: YKXSRILCPONUDAEMBTJWQVHFGZ
plaintext: CONGRATSHEREISYOURFLAGFREQUENCYISCOVERLAMBDAAGFLCGTYUEALEXEYFYODOROVITCHKARAMAZOVWASTHETHIRDSONOFFYODORPAVLOVITCHKARAMAZOVALANDOWNERWELLKNOWNINOURDISTRICTINHISOWNDAYANDSTILLREMEMBEREDAMONGUSOWINGTOHISGLOOMYANDTRAGICDEATHWHICHHAPPENEDTHIRTEENYEARSAGOANDWHICHISHALLDESCRIBEINITSPROPERPLACEFORTHEPRESENTIWILLONLYSAYTHATTHISLANDOWNERFORSOWEUSEDTOCALLHIMALTHOUGHHEHARDLYSPENTADAYOFHISLIFEONHISOWNESTATEWASASTRANGETYPEYETONEPRETTYFREQUENTLYTOBEMETWITHATYPEABJECTANDVICIOUSANDATTHESAMETIMESENSELESSBUTHEWASONEOFTHOSESENSELESSPERSONSWHOAREVERYWELLCAPABLEOFLOOKINGAFTERTHEIRWORLDLYAFFAIRSANDAPPARENTLYAFTERNOTHINGELSEFYODORPAVLOVITCHFORINSTANCEBEGANWITHNEXTTONOTHINGHISESTATEWASOFTHESMALLESTHERANTODINEATOTHERMENSTABLESANDFASTENEDONTHEMASATOADYYETATHISDEATHITAPPEAREDTHATHEHADAHUNDREDTHOUSANDROUBLESINHARDCASHATTHESAMETIMEHEWASALLHISLIFEONEOFTHEMOSTSENSELESSFANTASTICALFELLOWSINTHEWHOLEDISTRICTIREPEATITWASNOTSTUPIDITYTHEMAJORITYOFTHESEFANTASTICALFELLOWSARESHREWDANDINTELLIGENTENOUGHBUTJUSTSENSELESSNESSANDAPECULIARNATIONALFORMOFIT
</code></pre></td></tr></table>
</div>
</div><p>Now that it found the substitution key, I can use this python2 script:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python2 data-lang=python2><span style=color:#6272a4>#!/usr/bin/env python</span>
<span style=color:#ff79c6>import</span> string

alphabet <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span><span style=color:#ff79c6>.</span>lower()
best_key <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;YKXSRILCPONUDAEMBTJWQVHFGZ&#39;</span><span style=color:#ff79c6>.</span>lower()

<span style=color:#8be9fd;font-style:italic>file</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>open</span>(<span style=color:#f1fa8c>&#34;hertz.txt&#34;</span>, <span style=color:#f1fa8c>&#34;r&#34;</span>)
ctext <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>file</span><span style=color:#ff79c6>.</span>read()

cleartext <span style=color:#ff79c6>=</span> ctext<span style=color:#ff79c6>.</span>translate(string<span style=color:#ff79c6>.</span>maketrans(best_key, alphabet))

<span style=color:#ff79c6>print</span> (cleartext)
</code></pre></td></tr></table>
</div>
</div><p>output:</p>
<pre><code>-------------------------------------------------------------------------------
congrats here is your flag - frequency_is_c_over_lambda_agflcgtyue
-------------------------------------------------------------------------------
alexey fyodorovitch karamazov was the third son of fyodor pavlovitch karamazov, a land owner well known in our district in his own day, and still remembered among us owing to his gloomy and tragic death, which happened thirteen years ago, and which i shall describe in its proper place. for the present i will only say that this landownerfor so we used to call him, although he hardly spent a day of his life on his own estatewas a strange type, yet one pretty frequently to be met with, a type abject and vicious and at the same time senseless. but he was one of those senseless persons who are very well capable of looking after their worldly affairs, and, apparently, after nothing else. fyodor pavlovitch, for instance, began with next to nothing; his estate was of the smallest; he ran to dine at other men's tables, and fastened on them as a toady, yet at his death it appeared that he had a hundred thousand roubles in hard cash. at the same time, he was all his life one of the most senseless, fantastical fellows in the whole district. i repeat, it was not stupiditythe majority of these fantastical fellows are shrewd and intelligent enoughbut just senselessness, and a peculiar national form of it.
</code></pre>
<h2 id=flag_shop>flag_shop</h2>
<p>The <a href=https://stackoverflow.com/questions/12762040/get-the-maximum-value-of-a-variable-in-c#12762101>maximum size of a signed Integer in C</a> language is <code>2147483647</code>.
Any value above this maximum value will result in the integer turning negative.</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>total_cost <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>900</span><span style=color:#ff79c6>*</span>number_flags;
</code></pre></td></tr></table>
</div>
</div><p>Looking at the above portion of the source code, it is vulnerable to <strong>Integer Overflow</strong> because I have control on the number_flags value.
Therefore, if I put any value above 2147483647 // 900 = 2386092, the total_cost becomes a negative value.</p>
<p>The total_cost being negative, it will always pass the condition of being below our account balance.
What is more fun, is that when deducting the total_cost from my account_balance, because it is negative, my account_balance will actually increase ;P</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>    <span style=color:#ff79c6>if</span>(total_cost <span style=color:#ff79c6>&lt;=</span> account_balance){
        account_balance <span style=color:#ff79c6>=</span> account_balance <span style=color:#ff79c6>-</span> total_cost;
</code></pre></td></tr></table>
</div>
</div><p>solution:</p>
<pre><code>(echo 2; echo 1; echo 2386100; echo 2; echo 2; echo 1; echo 3) | nc jupiter.challenges.picoctf.org 9745 | grep picoCTF
</code></pre>
<h2 id=investigative-reversing-0>Investigative Reversing 0</h2>
<p>We are being provided an ELF64 binary called <code>mystery</code> and a PNG image called <code>mystery.png</code></p>
<p>Simple check of the PNG reveals something wrong about it. There is something after the end of the image:</p>
<pre><code>pngcheck mystery.png
mystery.png  additional data after IEND chunk
ERROR: mystery.png
</code></pre>
<p>Using xxd or strings, we find something that the culprit looks like a corrupted flag: <code>picoCTK.k5zsid6q_3d659f57}</code></p>
<pre><code>xxd mystery.png | tail -4
0001e850: 8220 0882 2008 8220 6417 ffef fffd 7f5e  . .. .. d......^
0001e860: ed5a 9d38 d01f 5600 0000 0049 454e 44ae  .Z.8..V....IEND.
0001e870: 4260 8270 6963 6f43 544b 806b 357a 7369  B`.picoCTK.k5zsi
0001e880: 6436 715f 3364 3635 3966 3537 7d         d6q_3d659f57}
</code></pre>
<p>Because it does not looks like a flag, I can use radare2 to reverse engineer the binary:</p>
<pre><code>radare2 mystery
aaaa
afl
s main
pdf main
</code></pre>
<p>At the very beginning of the binary, we observe that the binary needs both the PNG and a <strong>flag.txt</strong> file.
My intuition is that the binary is used to store or retrieve the content of flag.txt into/from the PNG.</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm>|           0<span style=color:#50fa7b>x000011b3</span>      <span style=color:#bd93f9>488</span>d3d500e00.  lea rdi, str.flag.txt       <span style=color:#6272a4>; 0x200a ; &#34;flag.txt&#34;
</span><span style=color:#6272a4></span>|           <span style=color:#bd93f9>0x000011ba</span>      e8c1feffff     call sym.imp.fopen
|           0<span style=color:#50fa7b>x000011bf</span>      <span style=color:#bd93f9>488945</span>c0       mov qword [var_40h], rax
|           0<span style=color:#50fa7b>x000011c3</span>      <span style=color:#bd93f9>488</span>d35490e00.  lea rsi, [<span style=color:#bd93f9>0x00002013</span>]       <span style=color:#6272a4>; &#34;a&#34;
</span><span style=color:#6272a4></span>|           <span style=color:#bd93f9>0x000011ca</span>      <span style=color:#bd93f9>488</span>d3d440e00.  lea rdi, str.mystery.png    <span style=color:#6272a4>; 0x2015 ; &#34;mystery.png&#34;
</span></code></pre></td></tr></table>
</div>
</div><p>Instead of reverse engineering the code, let&rsquo;s play and manipulate the binary inputs by
creating a false flag.txt of same size with value: <code>picoCTF{aaaaaaaa_aaaaaaaa}</code></p>
<p>After we run the <code>./mystery</code> program, then examine the end of the PNG. We see: <code>picoCTK.fffffff^_aaaaaaaa}</code></p>
<p>So we can infer a transformation table:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>false flag.txt</td>
<td>picoCT</td>
<td>F{</td>
<td>aaaaaaa</td>
<td>a</td>
<td>_aaaaaaaa}</td>
</tr>
<tr>
<td>PNG</td>
<td>picoCT</td>
<td>K.</td>
<td>fffffff</td>
<td>^</td>
<td>_aaaaaaaa}</td>
</tr>
<tr>
<td>transformation</td>
<td>identical</td>
<td>XX</td>
<td>ord(&lsquo;f&rsquo;) - ord(&lsquo;a&rsquo;) = +5</td>
<td>ord('^')-ord(&lsquo;a&rsquo;) = -3</td>
<td>identical</td>
</tr>
</tbody>
</table>
<p>With the above transformation rule in mind, we can infer the real flag:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>reverse transformation</td>
<td>identical</td>
<td>XX</td>
<td>-5</td>
<td>+3</td>
<td>identical</td>
</tr>
<tr>
<td>PNG</td>
<td>picoCT</td>
<td>K.</td>
<td>k5zsid6</td>
<td>q</td>
<td>_3d659f57}</td>
</tr>
<tr>
<td>real flag.txt</td>
<td>picoCT</td>
<td>F{</td>
<td>f0und_1</td>
<td>t</td>
<td>_3d659f57}</td>
</tr>
</tbody>
</table>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#f1fa8c>&#39;&#39;</span><span style=color:#ff79c6>.</span>join([<span style=color:#8be9fd;font-style:italic>chr</span>(<span style=color:#8be9fd;font-style:italic>ord</span>(c)<span style=color:#ff79c6>-</span><span style=color:#bd93f9>5</span>) <span style=color:#ff79c6>for</span> c <span style=color:#ff79c6>in</span> <span style=color:#f1fa8c>&#34;k5zsid6&#34;</span>])     <span style=color:#6272a4># &#39;f0und_1</span>
<span style=color:#8be9fd;font-style:italic>chr</span>(<span style=color:#8be9fd;font-style:italic>ord</span>(<span style=color:#f1fa8c>&#39;q&#39;</span>)<span style=color:#ff79c6>+</span><span style=color:#bd93f9>3</span>)                                 <span style=color:#6272a4># &#39;t&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=asm3>asm3</h2>
<blockquote>
<p>What does asm3(0xba6c5a02,0xd101e3dd,0xbb86a173) return</p>
</blockquote>
<p>After the prolog, the stack looks like this:</p>
<pre><code>| arg3      | &lt;-- ebp+0x10 = 0xbb86a173
| arg2      | &lt;-- ebp+0xc  = 0xd101e3dd
| arg1      | &lt;-- ebp+8    = 0xba6c5a02
| ret       |
| old ebp   | &lt;--new ebp
</code></pre>
<h3 id=internals>Internals</h3>
<p>Lets represent a table with offset relatively to ebp:</p>
<pre><code>&lt;--most significant/least significant-&gt;
offset |    | x12 |    |    |    |    | xd | xc | xb |    |    | x8 |
Bytes  | bb | 86  | a1 | 73 | d1 | 01 | e3 | dd | ba | 6c | 5a | 02 |
</code></pre>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#8be9fd;font-style:italic>asm3:</span>
        &lt;+0&gt;:   <span style=color:#50fa7b>push</span>   ebp      <span style=color:#6272a4>; prolog ;
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>1</span>&gt;:   mov    ebp,esp  <span style=color:#6272a4>; prolog ;
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>3</span>&gt;:   xor    eax,eax                  <span style=color:#6272a4>; eax =0
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>5</span>&gt;:   mov    ah,BYTE PTR [ebp+<span style=color:#bd93f9>0xb</span>]    <span style=color:#6272a4>; ah = xba
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>8</span>&gt;:   shl    ax,<span style=color:#bd93f9>0x10</span>                  <span style=color:#6272a4>; ax = ax &lt;&lt; 16
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>12</span>&gt;:  sub    al,BYTE PTR [ebp+<span style=color:#bd93f9>0xd</span>]    <span style=color:#6272a4>; al -= xe3
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>15</span>&gt;:  add    ah,BYTE PTR [ebp+<span style=color:#bd93f9>0xc</span>]    <span style=color:#6272a4>; ah += xdd
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>18</span>&gt;:  xor    ax,WORD PTR [ebp+<span style=color:#bd93f9>0x12</span>]   <span style=color:#6272a4>; ax = ax ^ xbb86
</span><span style=color:#6272a4></span>        &lt;+<span style=color:#bd93f9>22</span>&gt;:  nop
        &lt;+23&gt;:  <span style=color:#50fa7b>pop</span>    ebp
        &lt;+24&gt;:  <span style=color:#50fa7b>ret</span>
</code></pre></td></tr></table>
</div>
</div><p>Now let&rsquo;s examine the 32 bits EAX register at each step:</p>
<pre><code>&lt;--most significant/least significant-&gt;
|   operation    |       |    AX   |
|                |       | AH | AL |
+----------------+-------+----+----+
|  eax=0         | 00 00 | 00 | 00 |
|  ah=xba        | 00 00 | ba | 00 |
|  ax=ax&lt;&lt;16     | 00 00 | 00 | 00 |
|  al-=0xe3      | 00 00 | 00 | 1d | (2's Complement)
|  ah+=xdd       | 00 00 | dd | 1d |
|  ax=ax^x86a1   | 00 00 | 66 | 9b | hex(0xdd1d ^ 0xbb86) = 0x669b
</code></pre>
<p>x86 utilizes <a href=https://www.tutorialspoint.com/two-s-complement><strong>2&rsquo;s Complement</strong></a> to represent negative numbers.
To calculate the 2&rsquo;s Complement given a certain binary:</p>
<ol>
<li>invert all the bits to obtain the 1&rsquo;s Complement</li>
<li>add +1 to obtain the 2&rsquo;s Complement</li>
</ol>
<table>
<thead>
<tr>
<th>hex</th>
<th>dec</th>
<th>binary</th>
<th>1&rsquo;s complement</th>
<th>2&rsquo;s complement</th>
</tr>
</thead>
<tbody>
<tr>
<td>0xe3</td>
<td>227</td>
<td>1110 0011</td>
<td>0001 1100 (0x1c)</td>
<td>0001 1101 (0x1d)</td>
</tr>
</tbody>
</table>
<h3 id=radare2-way>Radare2 way</h3>
<p>Rewrite the code so that you can compile it:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#6272a4>;intel_syntax noprefix
</span><span style=color:#6272a4>;bits 32
</span><span style=color:#6272a4></span>
<span style=color:#50fa7b>SECTION</span> .data

<span style=color:#50fa7b>SECTION</span> .text
<span style=color:#50fa7b>global</span>  _start

<span style=color:#8be9fd;font-style:italic>_start:</span>
	<span style=color:#50fa7b>push</span> <span style=color:#bd93f9>0xbb86a173</span>		<span style=color:#6272a4>; push arg3
</span><span style=color:#6272a4></span>	push <span style=color:#bd93f9>0xd101e3dd</span>		<span style=color:#6272a4>; push arg2
</span><span style=color:#6272a4></span>	push <span style=color:#bd93f9>0xba6c5a02</span>		<span style=color:#6272a4>; push arg1
</span><span style=color:#6272a4></span>	call asm3

<span style=color:#8be9fd;font-style:italic>asm3:</span>
        <span style=color:#50fa7b>push</span>   ebp      <span style=color:#6272a4>; prolog ;
</span><span style=color:#6272a4></span>        mov    ebp,esp  <span style=color:#6272a4>; prolog ;
</span><span style=color:#6272a4></span>        xor    eax,eax                  <span style=color:#6272a4>; eax =0
</span><span style=color:#6272a4></span>        mov    ah,BYTE [ebp+<span style=color:#bd93f9>0xb</span>]    <span style=color:#6272a4>; ah = x02
</span><span style=color:#6272a4></span>        shl    ax,<span style=color:#bd93f9>0x10</span>                  <span style=color:#6272a4>; ax = ax &lt;&lt; 16
</span><span style=color:#6272a4></span>        sub    al,BYTE [ebp+<span style=color:#bd93f9>0xd</span>]    <span style=color:#6272a4>; al -= x01
</span><span style=color:#6272a4></span>        add    ah,BYTE [ebp+<span style=color:#bd93f9>0xc</span>]    <span style=color:#6272a4>; ah += xd1
</span><span style=color:#6272a4></span>        xor    ax,WORD [ebp+<span style=color:#bd93f9>0x12</span>]   <span style=color:#6272a4>; ax = ax ^ xa173
</span><span style=color:#6272a4></span>        nop
        <span style=color:#50fa7b>pop</span>    ebp
        <span style=color:#50fa7b>ret</span>
</code></pre></td></tr></table>
</div>
</div><p>compile and run</p>
<pre><code>nasm -f elf32 asm3.asm
ld -m elf_i386 asm3.o -o asm3
radare2 ./asm3
</code></pre>
<p>On radare2, analyze <code>aaaa</code> and type <code>pdf</code> to read the assembly code:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm>|           <span style=color:#6272a4>; arg int32_t arg_bh @ ebp+0xb
</span><span style=color:#6272a4></span>|           <span style=color:#6272a4>; arg int32_t arg_ch @ ebp+0xc
</span><span style=color:#6272a4></span>|           <span style=color:#6272a4>; arg int32_t arg_dh @ ebp+0xd
</span><span style=color:#6272a4></span>|           <span style=color:#6272a4>; arg int32_t arg_12h @ ebp+0x12
</span><span style=color:#6272a4></span>|           0<span style=color:#50fa7b>x08049000</span>      <span style=color:#bd93f9>6873</span>a186bb     push <span style=color:#bd93f9>0xbb86a173</span>             <span style=color:#6272a4>; [01] -r-x section size 45 named .text
</span><span style=color:#6272a4></span>|           <span style=color:#bd93f9>0x08049005</span>      <span style=color:#bd93f9>68</span>dde301d1     push <span style=color:#bd93f9>0xd101e3dd</span>
|           0<span style=color:#50fa7b>x0804900a</span>      <span style=color:#bd93f9>68025</span>a6cba     push <span style=color:#bd93f9>0xba6c5a02</span>
|           0<span style=color:#50fa7b>x0804900f</span>      e800000000     call loc.asm3
|           <span style=color:#6272a4>; CALL XREF from entry0 @ 0x804900f
</span><span style=color:#6272a4></span>|           <span style=color:#6272a4>;-- asm3:
</span><span style=color:#6272a4></span>|           0<span style=color:#50fa7b>x08049014</span>      <span style=color:#bd93f9>55</span>             push ebp
|           0<span style=color:#50fa7b>x08049015</span>      <span style=color:#bd93f9>89</span>e5           mov ebp, esp
|           0<span style=color:#50fa7b>x08049017</span>      <span style=color:#bd93f9>31</span>c0           xor eax, eax
|           0<span style=color:#50fa7b>x08049019</span>      <span style=color:#bd93f9>8</span>a650b         mov ah, byte [arg_bh]
|           0<span style=color:#50fa7b>x0804901c</span>      <span style=color:#bd93f9>66</span>c1e010       shl ax, <span style=color:#bd93f9>0x10</span>
|           0<span style=color:#50fa7b>x08049020</span>      <span style=color:#bd93f9>2</span>a450d         sub al, byte [arg_dh]
|           0<span style=color:#50fa7b>x08049023</span>      <span style=color:#bd93f9>02650</span>c         add ah, byte [arg_ch]
|           0<span style=color:#50fa7b>x08049026</span>      <span style=color:#bd93f9>66334512</span>       xor ax, word [arg_12h]
|           0<span style=color:#50fa7b>x0804902a</span>      <span style=color:#bd93f9>90</span>             nop
|           0<span style=color:#50fa7b>x0804902b</span>      <span style=color:#bd93f9>5</span>d             pop ebp
\           0<span style=color:#50fa7b>x0804902c</span>      c3             ret
</code></pre></td></tr></table>
</div>
</div><p>Set a breakpoint at the nop, then launch the program in debug mode, to retrieve the result in EAX register:</p>
<pre><code>db 0x0804902a       ; breakpoint
ood                 ; launch programme in debug mode
dc                  ; continue until next breakpoint
dr eax              ; check eax register, this is your solution
</code></pre>
<p>Some more useful commands to troubleshoot:</p>
<pre><code>ds                  ; next step (when in debugger mode)
p8 4 @ ebp+0x8      ; verify arg1
p8 4 @ ebp+0xc      ; verify arg2
p8 4 @ ebp+0x10     ; verify arg3
px 20 @ ebp         ; dump 20 bytes above ebp
</code></pre>
</div>
</article>
<hr>
<div class=sharing-buttons>
<a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f" target=_blank rel=noopener aria-label title="Share on facebook">
<div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f" target=_blank rel=noopener aria-label title="Share on twitter">
<div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&title=PicoCTF2019&caption=PicoCTF2019&canonicalUrl=https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f" target=_blank rel=noopener aria-label title="Share on tumblr">
<div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093.0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941.0 9.999.0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="mailto:?subject=PicoCTF2019&body=https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f" target=_self rel=noopener aria-label title="Share via email">
<div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f&media=https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f;description=PicoCTF2019" target=_blank rel=noopener aria-label title="Share on pinterest">
<div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12.017.0C5.396.0.029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024.0 1.518.769 1.518 1.688.0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128.0 3.768-2.245 3.768-5.487.0-2.861-2.063-4.869-5.008-4.869-3.41.0-5.409 2.562-5.409 5.199.0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646.0-3.776 2.748-7.252 7.92-7.252 4.158.0 7.392 2.967 7.392 6.923.0 4.135-2.607 7.462-6.233 7.462-1.214.0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607.0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017.0z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f&title=PicoCTF2019&summary=PicoCTF2019&source=https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f" target=_blank rel=noopener aria-label title="Share on linkedin">
<div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f&resubmit=true&title=PicoCTF2019" target=_blank rel=noopener aria-label title="Share on reddit">
<div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f;title=PicoCTF2019" target=_blank rel=noopener aria-label title="Share on xing">
<div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="whatsapp://send?text=PicoCTF2019%20https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f" target=_blank rel=noopener aria-label title="Share on whatsapp">
<div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893a11.821 11.821.0 00-3.48-8.413z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f&t=PicoCTF2019" target=_blank rel=noopener aria-label title="Share on hacker news">
<div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://telegram.me/share/url?text=PicoCTF2019&url=https%3a%2f%2f0xade1.github.io%2fposts%2f2022%2f08%2fpicoctf2019%2f" target=_blank rel=noopener aria-label title="Share on telegram">
<div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
</div>
</div>
</a>
</div>
<hr>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h></span>
</div>
<div class=pagination__buttons>
<a href=https://0xade1.github.io/posts/2021/10/htb-bolt/ class="button previous">
<span class=button__icon>←</span>
<span class=button__text>Htb Bolt</span>
</a>
</div>
</div>
<hr>
</main>
</div>
<footer class=footer>
<div class=footer__inner>
<div class=footer__content>
<span>&copy; 2022</span>
<span><a href=https://0xade1.github.io/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span>
</div>
</div>
<div class=footer__inner>
<div class=footer__content>
<span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Made with &#10084;</span>
</div>
</div>
</footer>
</div>
<script type=text/javascript src=https://0xade1.github.io/bundle.min.7015b843bafc394b6094818242f153559f5ca94b331b9faaf6132652c59619aefe60ae36e1637f7ee14fd953892639f466c25095c36d42203a1c195313e93212.js integrity="sha512-cBW4Q7r8OUtglIGCQvFTVZ9cqUszG5+q9hMmUsWWGa7+YK424WN/fuFP2VOJJjn0ZsJQlcNtQiA6HBlTE+kyEg=="></script>
</body>
</html>