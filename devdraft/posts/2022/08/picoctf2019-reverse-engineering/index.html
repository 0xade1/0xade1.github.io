<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="[map[name:MindYourPrivacy]]">
<meta name="description" content="Short description of your site here" />
<meta name="keywords" content=", untagged" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://0xade1.github.io/devdraft/posts/2022/08/picoctf2019-reverse-engineering/" />


    <title>
        
            PicoCTF2019 - Reverse Engineering :: Poney Island  — Welcome to Pwnie Island
        
    </title>





<link rel="stylesheet" href="https://0xade1.github.io/devdraft/main.cd71908e0ee72a8733aeb9216405d664d48b2598bb3b750ec082bbf1b5b458cc.css" integrity="sha256-zXGQjg7nKoczrrkhZAXWZNSLJZi7O3UOwIK78bW0WMw=">



    <link rel="apple-touch-icon" sizes="180x180" href="https://0xade1.github.io/devdraft/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://0xade1.github.io/devdraft/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://0xade1.github.io/devdraft/favicon-16x16.png">
    <link rel="manifest" href="https://0xade1.github.io/devdraft/site.webmanifest">
    <link rel="mask-icon" href="https://0xade1.github.io/devdraft/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://0xade1.github.io/devdraft/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="PicoCTF2019 - Reverse Engineering">
<meta itemprop="description" content="Short description of your site here"><meta itemprop="datePublished" content="2022-08-17T03:42:29+08:00" />
<meta itemprop="dateModified" content="2022-08-17T03:42:29+08:00" />
<meta itemprop="wordCount" content="4193"><meta itemprop="image" content="https://0xade1.github.io/devdraft"/>
<meta itemprop="keywords" content="untagged," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://0xade1.github.io/devdraft"/>

<meta name="twitter:title" content="PicoCTF2019 - Reverse Engineering"/>
<meta name="twitter:description" content="Short description of your site here"/>



    <meta property="og:title" content="PicoCTF2019 - Reverse Engineering" />
<meta property="og:description" content="Short description of your site here" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://0xade1.github.io/devdraft/posts/2022/08/picoctf2019-reverse-engineering/" /><meta property="og:image" content="https://0xade1.github.io/devdraft"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-17T03:42:29+08:00" />
<meta property="article:modified_time" content="2022-08-17T03:42:29+08:00" />
<meta property="og:see_also" content="https://0xade1.github.io/devdraft/posts/2022/08/picoctf2019-cryptography/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft/posts/2022/08/picoctf2019-forensics/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft/posts/2022/08/picoctf2019-general-skills/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft/posts/2022/08/picoctf2019-web-exploitation/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft/posts/2021/08/picoctf-2021-binary-exploitation/" />





    <meta property="article:section" content="picoCTF" />



    <meta property="article:published_time" content="2022-08-17 03:42:29 &#43;0800 &#43;0800" />











    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://0xade1.github.io/devdraft/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text ">
                # cd /draft/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://0xade1.github.io/devdraft/about/">About</a></li><li><a href="https://0xade1.github.io/devdraft/categories/">Categories</a></li><li><a href="https://0xade1.github.io/devdraft/posts/">Posts</a></li><li><a href="https://0xade1.github.io/devdraft/series/">Series</a></li><li><a href="https://0xade1.github.io/devdraft/tags/">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>


        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://0xade1.github.io/devdraft/posts/2022/08/picoctf2019-reverse-engineering/">PicoCTF2019 - Reverse Engineering</a>
      </h1>

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/untagged/">untagged</a></span>
        
    </p>


    </div>

      
        <div class="post-excerpt">Short description of your site here</div>
      

      
        <figure class="post-cover">
          <img src="https://play.picoctf.org/static/media/picoctf-logo-horizontal-white.17fdf0dcdef08dc3396a195b95e3bc29.svg" alt="PicoCTF2019 - Reverse Engineering" />
          
          
        </figure>
      
        <hr />
        <aside id="toc">
          <div class="toc-title"></div>

            
            <link rel="stylesheet" href="https://0xade1.github.io/devdraft/scss/_toc.min.381569c9197e6da109df728dd267dd570bde7f7e967b92d59404483a017f498b00b0434e20302334ff67d09c721024494068c58c94a8a44aa3128e5aef4ef8f0.css" integrity="sha512-OBVpyRl&#43;baEJ33KN0mfdVwvef36We5LVlARIOgF/SYsAsENOIDAjNP9n0JxyECRJQGjFjJSopEqjEo5a70748A==">
             <div class="toc">
                <input id="_toc" type="checkbox" name="_toc">
                <label class="collapse" for="_toc">Table of Contents&nbsp;
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline class="chevron-down" points="6 10 14 18 22 10"></polyline><polyline class="chevron-up" points="22 18 14 10 6 18"></polyline></svg>
                </label>
                <nav id="TableOfContents">
                     <nav id="TableOfContents">
  <ul>
    <li><a href="#vault-door-training">vault-door-training</a></li>
    <li><a href="#vault-door-1">vault-door-1</a></li>
    <li><a href="#asm1">asm1</a></li>
    <li><a href="#vault-door-3">vault-door-3</a></li>
    <li><a href="#asm2">asm2</a></li>
    <li><a href="#vault-door-4">vault-door-4</a></li>
    <li><a href="#droids0">droids0</a></li>
    <li><a href="#droids1">droids1</a>
      <ul>
        <li><a href="#using-apktool">using apktool</a></li>
        <li><a href="#using-jadx">using jadx</a></li>
      </ul>
    </li>
    <li><a href="#droids2">droids2</a></li>
    <li><a href="#droids3">droids3</a></li>
    <li><a href="#droids4">droids4</a>
      <ul>
        <li><a href="#method-frida">Method Frida</a></li>
      </ul>
    </li>
    <li><a href="#asm3">asm3</a>
      <ul>
        <li><a href="#internals">Internals</a></li>
        <li><a href="#radare2-way">Radare2 way</a></li>
      </ul>
    </li>
    <li><a href="#vault-door-5">vault-door-5</a></li>
    <li><a href="#reverse_cipher">reverse_cipher</a></li>
    <li><a href="#vault-door-6">vault-door-6</a></li>
    <li><a href="#asm4">asm4</a>
      <ul>
        <li><a href="#method-compilation-with-dedicated-assembly-file">Method: compilation with dedicated assembly file</a></li>
      </ul>
</nav>
                </nav>
             </div>

        </aside>
        <hr />

      

      <div class="post-content">
        <h2 id="vault-door-training">vault-door-training</h2>
<pre><code>grep password.equals VaultDoorTraining.java | cut -d'&quot;' -f2 | awk '{printf &quot;picoCTF{%s}\n&quot;, $1}'
</code></pre>
<h2 id="vault-door-1">vault-door-1</h2>
<pre><code>flag=$(
  curl -sL https://jupiter.challenges.picoctf.org/static/87e103a8db01087de9ccf5a7a022ddf8/VaultDoor1.java |
  grep charAt | cut -d'(' -f2 | sort -n | cut -d&quot;'&quot; -f2 | tr -d &quot;\n&quot;
)
echo &quot;picoCTF{$flag}&quot;
</code></pre>
<h2 id="asm1">asm1</h2>
<p>This is how the stack looks like after the prolog:</p>
<pre><code>| old ebp   |
| ret       | &lt;-- ebp+4
| 0x8be     | &lt;-- ebp+8
</code></pre>
<p>Lets audit the program with <a href="https://www.tutorialspoint.com/assembly_programming/assembly_conditions.htm">this doc</a>
as a reference:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">asm1:</span>
</span></span><span style="display:flex;"><span>        &lt;+0&gt;:   <span style="color:#50fa7b">push</span>   ebp                              <span style="color:#6272a4">; prolog ;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+1&gt;:   <span style="color:#50fa7b">mov</span>    ebp,esp                          <span style="color:#6272a4">; prolog ; ebp+8 = 0x8be
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+3&gt;:   <span style="color:#50fa7b">cmp</span>    DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>],<span style="color:#bd93f9">0x71c</span>        <span style="color:#6272a4">; 0x8be &gt;  0x71c
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+10&gt;:  <span style="color:#50fa7b">jg</span>     <span style="color:#bd93f9">0x512</span> &lt;asm1+<span style="color:#bd93f9">37</span>&gt;                  <span style="color:#6272a4">; jump as greater
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+12&gt;:  <span style="color:#50fa7b">cmp</span>    DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>],<span style="color:#bd93f9">0x6cf</span>
</span></span><span style="display:flex;"><span>        &lt;+19&gt;:  <span style="color:#50fa7b">jne</span>    <span style="color:#bd93f9">0x50a</span> &lt;asm1+<span style="color:#bd93f9">29</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;+21&gt;:  <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]
</span></span><span style="display:flex;"><span>        &lt;+24&gt;:  <span style="color:#50fa7b">add</span>    eax,<span style="color:#bd93f9">0x3</span>
</span></span><span style="display:flex;"><span>        &lt;+27&gt;:  <span style="color:#50fa7b">jmp</span>    <span style="color:#bd93f9">0x529</span> &lt;asm1+<span style="color:#bd93f9">60</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;+29&gt;:  <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]
</span></span><span style="display:flex;"><span>        &lt;+32&gt;:  <span style="color:#50fa7b">sub</span>    eax,<span style="color:#bd93f9">0x3</span>
</span></span><span style="display:flex;"><span>        &lt;+35&gt;:  <span style="color:#50fa7b">jmp</span>    <span style="color:#bd93f9">0x529</span> &lt;asm1+<span style="color:#bd93f9">60</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;+37&gt;:  <span style="color:#50fa7b">cmp</span>    DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>],<span style="color:#bd93f9">0x8be</span>        <span style="color:#6272a4">; 0x8be = 0x8be (dec 2238)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+44&gt;:  <span style="color:#50fa7b">jne</span>    <span style="color:#bd93f9">0x523</span> &lt;asm1+<span style="color:#bd93f9">54</span>&gt;                  <span style="color:#6272a4">; don&#39;t jump because equal
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+46&gt;:  <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]          <span style="color:#6272a4">; eax = 0x8be
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+49&gt;:  <span style="color:#50fa7b">sub</span>    eax,<span style="color:#bd93f9">0x3</span>                          <span style="color:#6272a4">; eax = 0x8be - 0x3 = 0x8bb
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+52&gt;:  <span style="color:#50fa7b">jmp</span>    <span style="color:#bd93f9">0x529</span> &lt;asm1+<span style="color:#bd93f9">60</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;+54&gt;:  <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]
</span></span><span style="display:flex;"><span>        &lt;+57&gt;:  <span style="color:#50fa7b">add</span>    eax,<span style="color:#bd93f9">0x3</span>
</span></span><span style="display:flex;"><span>        &lt;+60&gt;:  <span style="color:#50fa7b">pop</span>    ebp                              <span style="color:#6272a4">; epilog ;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+61&gt;:  <span style="color:#50fa7b">ret</span>                                     <span style="color:#6272a4">; epilog ; return eax = 0x8bb
</span></span></span></code></pre></div><h2 id="vault-door-3">vault-door-3</h2>
<pre><code>curl -sL https://jupiter.challenges.picoctf.org/static/a4018cec1446761cb2e8cce05db925fa/VaultDoor3.java | tail -22
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">boolean</span> <span style="color:#50fa7b">checkPassword</span><span style="color:#ff79c6">(</span>String password<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>password<span style="color:#ff79c6">.</span><span style="color:#50fa7b">length</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">!=</span> <span style="color:#bd93f9">32</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">char</span><span style="color:#ff79c6">[]</span> buffer <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd">char</span><span style="color:#ff79c6">[</span><span style="color:#bd93f9">32</span><span style="color:#ff79c6">];</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">int</span> i<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">&lt;</span><span style="color:#bd93f9">8</span><span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">++)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        buffer<span style="color:#ff79c6">[</span>i<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">=</span> password<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(;</span> i<span style="color:#ff79c6">&lt;</span><span style="color:#bd93f9">16</span><span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">++)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        buffer<span style="color:#ff79c6">[</span>i<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">=</span> password<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">23</span><span style="color:#ff79c6">-</span>i<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(;</span> i<span style="color:#ff79c6">&lt;</span><span style="color:#bd93f9">32</span><span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">+=</span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        buffer<span style="color:#ff79c6">[</span>i<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">=</span> password<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">46</span><span style="color:#ff79c6">-</span>i<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">=</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">&gt;=</span><span style="color:#bd93f9">17</span><span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">-=</span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        buffer<span style="color:#ff79c6">[</span>i<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">=</span> password<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    String s <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> String<span style="color:#ff79c6">(</span>buffer<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> s<span style="color:#ff79c6">.</span><span style="color:#50fa7b">equals</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;jU5t_a_sna_3lpm12g94c_u_4_m7ra41&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>translated into python:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>not_the_flag <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;jU5t_a_sna_3lpm12g94c_u_4_m7ra41&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>buffer <span style="color:#ff79c6">=</span> [<span style="color:#ff79c6">None</span>] <span style="color:#ff79c6">*</span> <span style="color:#8be9fd;font-style:italic">len</span>(not_the_flag)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">8</span>):
</span></span><span style="display:flex;"><span>    buffer[i] <span style="color:#ff79c6">=</span> not_the_flag[i]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">8</span>,<span style="color:#bd93f9">16</span>):
</span></span><span style="display:flex;"><span>    buffer[i] <span style="color:#ff79c6">=</span> not_the_flag[<span style="color:#bd93f9">23</span> <span style="color:#ff79c6">-</span>i]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">16</span>,<span style="color:#bd93f9">32</span>, <span style="color:#bd93f9">2</span>):
</span></span><span style="display:flex;"><span>    buffer[i] <span style="color:#ff79c6">=</span> not_the_flag[<span style="color:#bd93f9">46</span><span style="color:#ff79c6">-</span>i]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">31</span>,<span style="color:#bd93f9">16</span>, <span style="color:#ff79c6">-</span><span style="color:#bd93f9">2</span>):
</span></span><span style="display:flex;"><span>    buffer[i] <span style="color:#ff79c6">=</span> not_the_flag[i]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;picoCTF{</span><span style="color:#f1fa8c">%s</span><span style="color:#f1fa8c">}&#34;</span> <span style="color:#ff79c6">%</span> <span style="color:#f1fa8c">&#39;&#39;</span><span style="color:#ff79c6">.</span>join(buffer))
</span></span></code></pre></div><h2 id="asm2">asm2</h2>
<pre><code>What does asm2(0xb,0x2e) return?
</code></pre>
<p>This is how the stack looks like after the prolog:</p>
<pre><code>| 0x2e      | &lt;-- ebp+0xc (ebp+12)
| 0xb       | &lt;-- ebp+8
| ret       | &lt;-- ebp+4
| old ebp   | &lt;-- new ebp
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">asm2:</span>
</span></span><span style="display:flex;"><span>	&lt;+0&gt;:	<span style="color:#50fa7b">push</span>   ebp                      <span style="color:#6272a4">; prolog ;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	&lt;+1&gt;:	<span style="color:#50fa7b">mov</span>    ebp,esp                  <span style="color:#6272a4">; prolog ; ebp+8 = 0xb and ebp+0xc = 0x2e
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	&lt;+3&gt;:	<span style="color:#50fa7b">sub</span>    esp,<span style="color:#bd93f9">0x10</span>
</span></span><span style="display:flex;"><span>	&lt;+6&gt;:	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0xc</span>]  <span style="color:#6272a4">; eax = 0x2e
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	&lt;+9&gt;:	<span style="color:#50fa7b">mov</span>    DWORD PTR [ebp-0x4],eax  <span style="color:#6272a4">; tmp = 0x2e (let&#39;s label ebp-4 as tmp local variable)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	&lt;+12&gt;:	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]  <span style="color:#6272a4">; eax = 0xb
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	&lt;+15&gt;:	<span style="color:#50fa7b">mov</span>    DWORD PTR [ebp-0x8],eax  <span style="color:#6272a4">; tmp2 = 0xb (let&#39;s label ebp-8 as tmp2 local variable)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	&lt;+18&gt;:	<span style="color:#50fa7b">jmp</span>    <span style="color:#bd93f9">0x509</span> &lt;asm2+<span style="color:#bd93f9">28</span>&gt;
</span></span><span style="display:flex;"><span>	&lt;+20&gt;:	<span style="color:#50fa7b">add</span>    DWORD PTR [ebp-0x4],<span style="color:#bd93f9">0x1</span>          <span style="color:#6272a4">; tmp += 1
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	&lt;+24&gt;:	<span style="color:#50fa7b">sub</span>    DWORD PTR [ebp-0x8],<span style="color:#bd93f9">0xffffff80</span>   <span style="color:#6272a4">; tmp2 -= -128 (because 0xffffff80 = -128)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	&lt;+28&gt;:	<span style="color:#50fa7b">cmp</span>    DWORD PTR [ebp-0x8],<span style="color:#bd93f9">0x63f3</span>       <span style="color:#6272a4">; tmp2 &lt; 0x63f3
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	&lt;+35&gt;:	<span style="color:#50fa7b">jle</span>    <span style="color:#bd93f9">0x501</span> &lt;asm2+<span style="color:#bd93f9">20</span>&gt;                  <span style="color:#6272a4">; while(tmp2 &lt;= 0x63f3)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	&lt;+37&gt;:	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp-0x4]          <span style="color:#6272a4">; eax = tmp
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	&lt;+40&gt;:	<span style="color:#50fa7b">leave</span>
</span></span><span style="display:flex;"><span>	&lt;+41&gt;:	<span style="color:#50fa7b">ret</span>                                     <span style="color:#6272a4">; ret tmp
</span></span></span></code></pre></div><p>Note that <code>0xffffff80</code> is a signed integer with value <code>-128</code>.
This is because the most significant bit represents the sign (0 if positive, 1 if negative) and the remaining 7 bits are the actual value.
it can be represented in this table:</p>
<table>
<thead>
<tr>
<th style="text-align:right">byte4</th>
<th style="text-align:right">byte3</th>
<th style="text-align:right">byte2</th>
<th style="text-align:right">byte1</th>
<th style="text-align:left"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right">80</td>
<td style="text-align:left">8 bit signed</td>
</tr>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right">10000000</td>
<td style="text-align:left">8 bit signed</td>
</tr>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right">ff</td>
<td style="text-align:right">80</td>
<td style="text-align:left">16 bit signed</td>
</tr>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right">11111111</td>
<td style="text-align:right">10000000</td>
<td style="text-align:left">16 bit signed</td>
</tr>
<tr>
<td style="text-align:right">ff</td>
<td style="text-align:right">ff</td>
<td style="text-align:right">ff</td>
<td style="text-align:right">80</td>
<td style="text-align:left">32 bit signed</td>
</tr>
<tr>
<td style="text-align:right">11111111</td>
<td style="text-align:right">11111111</td>
<td style="text-align:right">11111111</td>
<td style="text-align:right">10000000</td>
<td style="text-align:left">32 bit signed</td>
</tr>
</tbody>
</table>
<p>The above assembly code translates into python:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">asm2</span>(arg1, arg2):
</span></span><span style="display:flex;"><span>    tmp  <span style="color:#ff79c6">=</span> arg2
</span></span><span style="display:flex;"><span>    tmp2 <span style="color:#ff79c6">=</span> arg1
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">while</span> tmp2 <span style="color:#ff79c6">&lt;=</span> <span style="color:#bd93f9">0x63f3</span>:
</span></span><span style="display:flex;"><span>      tmp <span style="color:#ff79c6">+=</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>      tmp2 <span style="color:#ff79c6">+=</span> <span style="color:#bd93f9">128</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> tmp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#8be9fd;font-style:italic">hex</span>(asm2(<span style="color:#bd93f9">0xb</span>, <span style="color:#bd93f9">0x2e</span>))
</span></span></code></pre></div><h2 id="vault-door-4">vault-door-4</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">boolean</span> <span style="color:#50fa7b">checkPassword</span><span style="color:#ff79c6">(</span>String password<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> passBytes <span style="color:#ff79c6">=</span> password<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getBytes</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> myBytes <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#bd93f9">106</span> <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">85</span>  <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">53</span>  <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">116</span> <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">95</span>  <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">52</span>  <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">95</span>  <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">98</span>  <span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#bd93f9">0x55</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x6e</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x43</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x68</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x5f</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x30</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x66</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x5f</span><span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#bd93f9">0142</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0131</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0164</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">063</span> <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0163</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0137</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0146</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">064</span> <span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;a&#39;</span> <span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#39;8&#39;</span> <span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#39;c&#39;</span> <span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#39;d&#39;</span> <span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#39;8&#39;</span> <span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#39;f&#39;</span> <span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#39;7&#39;</span> <span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#39;e&#39;</span> <span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">};</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> i<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">&lt;</span><span style="color:#bd93f9">32</span><span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">++)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>passBytes<span style="color:#ff79c6">[</span>i<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">!=</span> myBytes<span style="color:#ff79c6">[</span>i<span style="color:#ff79c6">])</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>python:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>password <span style="color:#ff79c6">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#bd93f9">106</span> , <span style="color:#bd93f9">85</span>  , <span style="color:#bd93f9">53</span>  , <span style="color:#bd93f9">116</span> , <span style="color:#bd93f9">95</span>  , <span style="color:#bd93f9">52</span>  , <span style="color:#bd93f9">95</span>  , <span style="color:#bd93f9">98</span>  ,
</span></span><span style="display:flex;"><span>    <span style="color:#bd93f9">0x55</span>, <span style="color:#bd93f9">0x6e</span>, <span style="color:#bd93f9">0x43</span>, <span style="color:#bd93f9">0x68</span>, <span style="color:#bd93f9">0x5f</span>, <span style="color:#bd93f9">0x30</span>, <span style="color:#bd93f9">0x66</span>, <span style="color:#bd93f9">0x5f</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#bd93f9">0o142</span>, <span style="color:#bd93f9">0o131</span>, <span style="color:#bd93f9">0o164</span>, <span style="color:#bd93f9">0o63</span> , <span style="color:#bd93f9">0o163</span>, <span style="color:#bd93f9">0o137</span>, <span style="color:#bd93f9">0o146</span>, <span style="color:#bd93f9">0o064</span> ,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#39;a&#39;</span> , <span style="color:#f1fa8c">&#39;8&#39;</span> , <span style="color:#f1fa8c">&#39;c&#39;</span> , <span style="color:#f1fa8c">&#39;d&#39;</span> , <span style="color:#f1fa8c">&#39;8&#39;</span> , <span style="color:#f1fa8c">&#39;f&#39;</span> , <span style="color:#f1fa8c">&#39;7&#39;</span> , <span style="color:#f1fa8c">&#39;e&#39;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>flag<span style="color:#ff79c6">.</span>extend([<span style="color:#8be9fd;font-style:italic">chr</span>(password[x]) <span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">8</span>)] )
</span></span><span style="display:flex;"><span>flag<span style="color:#ff79c6">.</span>extend([<span style="color:#8be9fd;font-style:italic">chr</span>(password[x]) <span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">8</span>,<span style="color:#bd93f9">16</span>)])
</span></span><span style="display:flex;"><span>flag<span style="color:#ff79c6">.</span>extend([<span style="color:#8be9fd;font-style:italic">chr</span>(password[x]) <span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">16</span>,<span style="color:#bd93f9">24</span>)])
</span></span><span style="display:flex;"><span>flag<span style="color:#ff79c6">.</span>extend([    password[x]  <span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">24</span>,<span style="color:#bd93f9">32</span>)])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;picoCTF{</span><span style="color:#f1fa8c">%s</span><span style="color:#f1fa8c">}&#34;</span> <span style="color:#ff79c6">%</span> <span style="color:#f1fa8c">&#39;&#39;</span><span style="color:#ff79c6">.</span>join(flag))
</span></span></code></pre></div><h2 id="droids0">droids0</h2>
<p>Hints:</p>
<ol>
<li>Try using an emulator or device</li>
<li><a href="https://developer.android.com/studio">https://developer.android.com/studio</a></li>
</ol>
<p>Pre-requisites (many GB download)</p>
<ol>
<li><code>brew install --cask android-studio</code></li>
<li>Open Android Device Manager</li>
<li><a href="https://medium.com/@vsburnett/how-to-set-up-an-android-emulator-in-windows-10-e0a3284b5f94">Create a new virtual device</a> with Pixel 5</li>
<li>You may have to download whichever version of <strong>android</strong> you want</li>
<li>Start your virtual device</li>
<li><a href="https://www.geeksforgeeks.org/how-to-install-an-apk-on-the-emulator-in-android-studio/">Install the applications</a> in the emulator (see cmd-line below)</li>
<li>Run the application</li>
<li>check the logs</li>
</ol>
<p>setup your profile</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">ANDROID_SDK</span><span style="color:#ff79c6">=</span>/Users/<span style="color:#f1fa8c">${</span><span style="color:#8be9fd;font-style:italic">USER</span><span style="color:#f1fa8c">}</span>/Library/Android/sdk
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">PATH</span><span style="color:#ff79c6">=</span><span style="color:#8be9fd;font-style:italic">$ANDROID_SDK</span>/platform-tools:<span style="color:#8be9fd;font-style:italic">$PATH</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">PATH</span><span style="color:#ff79c6">=</span><span style="color:#8be9fd;font-style:italic">$ANDROID_SDK</span>/emulator:<span style="color:#8be9fd;font-style:italic">$P</span>
</span></span></code></pre></div><p>start an emulator, install the app:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>emulator -list-avds     <span style="color:#6272a4"># my emulator name is Droids</span>
</span></span><span style="display:flex;"><span>emulator -avd Droids    <span style="color:#6272a4"># start emulator</span>
</span></span><span style="display:flex;"><span>adb devices -l
</span></span><span style="display:flex;"><span>adb install zero.apk
</span></span></code></pre></div><p>A new icon &ldquo;picoCTF&rdquo; shows up in the list of applications with a big &lsquo;Hello, I am a button&rsquo; button.
Clicking on it won&rsquo;t show the flag, but the app gives a hint: <code>Where else can output go?</code>:</p>
<p>Find the flag in the logs and Kill the emulatorprobably in the logs &hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>adb shell logcat | grep -i <span style="color:#f1fa8c">&#34;picoctf{&#34;</span>
</span></span><span style="display:flex;"><span>adb devices | grep emulator | cut -f1 | <span style="color:#ff79c6">while</span> <span style="color:#8be9fd;font-style:italic">read</span> line; <span style="color:#ff79c6">do</span> adb -s <span style="color:#8be9fd;font-style:italic">$line</span> emu kill; <span style="color:#ff79c6">done</span>
</span></span></code></pre></div><p>Kill emulator</p>
<h2 id="droids1">droids1</h2>
<blockquote>
<p>Hints: Try using <a href="https://ibotpeaches.github.io/Apktool/">apktool</a> and an emulator</p>
</blockquote>
<p>setup is identical as droids0 with <code>adb install zero.apk</code>;
however there is no log when running the app, instead we have an Editable Text Area and a button with a hint: <strong>Brute force not required</strong>.
Basically we have to find the right text input before clicking the button.</p>
<h3 id="using-apktool">using apktool</h3>
<p>Installation:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -LO https://raw.githubusercontent.com/iBotPeaches/Apktool/master/scripts/osx/apktool
</span></span><span style="display:flex;"><span>curl -LO https://bitbucket.org/iBotPeaches/apktool/downloads/apktool_2.6.1.jar
</span></span><span style="display:flex;"><span>chmod +x ./apktool*
</span></span><span style="display:flex;"><span>sudo mv apktool* /usr/local/bin/
</span></span><span style="display:flex;"><span>ln -s /usr/local/bin/apktool_2.6.1.jar /usr/local/bin/apktool.jar
</span></span><span style="display:flex;"><span>apktool
</span></span></code></pre></div><p>Execution:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apktool d one.apk
</span></span></code></pre></div><p>a folder is created with the pseudo-code in folder smali/com/hellocmu/picoctf/. The code is hard to read but we can guess:</p>
<ol>
<li>Main read the content of the text input and pass it to method FlagstaffHill;-&gt;getFlag(textinput)</li>
<li>This method compares the input with the password stored in <code>const v0, 0x7f0b002f; .local v0, &quot;password&quot;:Ljava/lang/String;</code></li>
<li>if the password is correct, we return the flag with `FlagstaffHill;-&gt;fenugreek(textinput)</li>
<li>A simple <code>grep 0x7f0b002f smali/com -Ri</code> permit to retrieve the name of the variable is <code>password</code></li>
<li>Another <code>grep password res/values -Ri</code>find the password: <strong><!-- raw HTML omitted -->opossum<!-- raw HTML omitted --></strong></li>
</ol>
<p>We can now run the app with android studio, and retrieve the flag after typing the password.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>adb install one.apk
</span></span></code></pre></div><h3 id="using-jadx">using jadx</h3>
<p>A better decompiler is <a href="https://github.com/skylot/jadx">https://github.com/skylot/jadx</a></p>
<pre tabindex="0"><code>brew install jadx
brew list jadx
/usr/local/Cellar/jadx/1.4.4/bin/jadx-gui
</code></pre><p>The decompiled code is simply beautiful and readable. MainActivity class:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">buttonClick</span><span style="color:#ff79c6">(</span>View view<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        String content <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">text_input</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">getText</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">toString</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">text_bottom</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span>FlagstaffHill<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getFlag</span><span style="color:#ff79c6">(</span>content<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">ctx</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>FlagStaffHill class:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> String <span style="color:#50fa7b">getFlag</span><span style="color:#ff79c6">(</span>String input<span style="color:#ff79c6">,</span> Context ctx<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        String password <span style="color:#ff79c6">=</span> ctx<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getString</span><span style="color:#ff79c6">(</span>R<span style="color:#ff79c6">.</span><span style="color:#50fa7b">string</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">password</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> input<span style="color:#ff79c6">.</span><span style="color:#50fa7b">equals</span><span style="color:#ff79c6">(</span>password<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">?</span> fenugreek<span style="color:#ff79c6">(</span>input<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;NOPE&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>Better then the UI, we can also uses the cli:</p>
<pre tabindex="0"><code>jadx -d . one.apk
</code></pre><p>We can solve this challenge without even installing Android Studio if we can decompile the fenugreek method.
The fenugreek method is static and can only be retrieved through disassembling libhellojni.so</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#50fa7b">objdump</span> --disassemble-functions=Java_com_hellocmu_picoctf_FlagstaffHill_fenugreek ./resources/lib/x86/libhellojni.so
</span></span></code></pre></div><h2 id="droids2">droids2</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -LO https://jupiter.challenges.picoctf.org/static/b7d30de6eaaf83e685aea7c10c5bdea8/two.apk
</span></span><span style="display:flex;"><span>jadx -d . two.apk
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">FlagstaffHill</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd;font-style:italic">native</span> String <span style="color:#50fa7b">sesame</span><span style="color:#ff79c6">(</span>String str<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> String <span style="color:#50fa7b">getFlag</span><span style="color:#ff79c6">(</span>String input<span style="color:#ff79c6">,</span> Context ctx<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        String<span style="color:#ff79c6">[]</span> witches <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span><span style="color:#f1fa8c">&#34;weatherwax&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;ogg&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;garlick&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;nitt&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;aching&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;dismass&#34;</span><span style="color:#ff79c6">};</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd">int</span> second <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">3</span> <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">3</span><span style="color:#ff79c6">;</span>                     <span style="color:#6272a4">// second = 0
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#8be9fd">int</span> third <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">(</span><span style="color:#bd93f9">3</span> <span style="color:#ff79c6">/</span> <span style="color:#bd93f9">3</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> second<span style="color:#ff79c6">;</span>           <span style="color:#6272a4">// third = 1
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#8be9fd">int</span> fourth <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">(</span>third <span style="color:#ff79c6">+</span> third<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">-</span> second<span style="color:#ff79c6">;</span>  <span style="color:#6272a4">// fourth = 2
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#8be9fd">int</span> fifth <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">3</span> <span style="color:#ff79c6">+</span> fourth<span style="color:#ff79c6">;</span>                 <span style="color:#6272a4">// fifth = 5
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#8be9fd">int</span> sixth <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">(</span>fifth <span style="color:#ff79c6">+</span> second<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">-</span> third<span style="color:#ff79c6">;</span>   <span style="color:#6272a4">// sixth = 4
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        String password <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span>witches<span style="color:#ff79c6">[</span>fifth<span style="color:#ff79c6">]).</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;.&#34;</span><span style="color:#ff79c6">).</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span>witches<span style="color:#ff79c6">[</span>third<span style="color:#ff79c6">]).</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;.&#34;</span><span style="color:#ff79c6">).</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span>witches<span style="color:#ff79c6">[</span>second<span style="color:#ff79c6">]).</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;.&#34;</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">.</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span>witches<span style="color:#ff79c6">[</span>sixth<span style="color:#ff79c6">]).</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;.&#34;</span><span style="color:#ff79c6">).</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span>witches<span style="color:#ff79c6">[</span><span style="color:#bd93f9">3</span><span style="color:#ff79c6">]).</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;.&#34;</span><span style="color:#ff79c6">).</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span>witches<span style="color:#ff79c6">[</span>fourth<span style="color:#ff79c6">]);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> input<span style="color:#ff79c6">.</span><span style="color:#50fa7b">equals</span><span style="color:#ff79c6">(</span>password<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">?</span> sesame<span style="color:#ff79c6">(</span>input<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;NOPE&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>The password is the concatenation of:</p>
<ul>
<li>witches[5] and &lsquo;.&rsquo; = &lsquo;dismass.&rsquo;</li>
<li>witches[1] and &lsquo;.&rsquo; = &lsquo;ogg.&rsquo;</li>
<li>witches[0] and &lsquo;.&rsquo; = &lsquo;weatherwax.&rsquo;</li>
<li>witches[4] and &lsquo;.&rsquo; = &lsquo;aching.&rsquo;</li>
<li>witches[3] and &lsquo;.&rsquo; = &rsquo;nitt.&rsquo;</li>
<li>witches[2] = &lsquo;garlick&rsquo;</li>
</ul>
<p>Run the apk and type the password = &lsquo;dismass.ogg.weatherwax.aching.nitt.garlick&rsquo;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>adb install two.apk
</span></span></code></pre></div><h2 id="droids3">droids3</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -LO https://jupiter.challenges.picoctf.org/static/06318765139795831859f843dd56ce60/three.apk
</span></span></code></pre></div><p>On this challenge, the <code>getFlag</code> method always return &ldquo;don&rsquo;t wanna&rdquo;.
The solution is to modify the code row 12 to execute execute <code>yep</code> method instead of <code>nope</code>
then rebuild the project.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">FlagstaffHill</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd;font-style:italic">native</span> String <span style="color:#50fa7b">cilantro</span><span style="color:#ff79c6">(</span>String str<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> String <span style="color:#50fa7b">nope</span><span style="color:#ff79c6">(</span>String input<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;don&#39;t wanna&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> String <span style="color:#50fa7b">yep</span><span style="color:#ff79c6">(</span>String input<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> cilantro<span style="color:#ff79c6">(</span>input<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> String <span style="color:#50fa7b">getFlag</span><span style="color:#ff79c6">(</span>String input<span style="color:#ff79c6">,</span> Context ctx<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// String flag = nope(input);
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        String flag <span style="color:#ff79c6">=</span> yep<span style="color:#ff79c6">(</span>input<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> flag<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>Decompile:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apktool d three.apk
</span></span><span style="display:flex;"><span>nvim smali/com/hellocmu/picoctf/FlagstaffHill.smali
</span></span></code></pre></div><p>Modify the source code</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span># invoke<span style="color:#ff79c6">-</span><span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#ff79c6">{</span>p0<span style="color:#ff79c6">},</span> Lcom<span style="color:#ff79c6">/</span>hellocmu<span style="color:#ff79c6">/</span>picoctf<span style="color:#ff79c6">/</span>FlagstaffHill<span style="color:#ff79c6">;-&gt;</span>nope<span style="color:#ff79c6">(</span>Ljava<span style="color:#ff79c6">/</span>lang<span style="color:#ff79c6">/</span>String<span style="color:#ff79c6">;)</span>Ljava<span style="color:#ff79c6">/</span>lang<span style="color:#ff79c6">/</span>String<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>  invoke<span style="color:#ff79c6">-</span><span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#ff79c6">{</span>p0<span style="color:#ff79c6">},</span> Lcom<span style="color:#ff79c6">/</span>hellocmu<span style="color:#ff79c6">/</span>picoctf<span style="color:#ff79c6">/</span>FlagstaffHill<span style="color:#ff79c6">;-&gt;</span>yep<span style="color:#ff79c6">(</span>Ljava<span style="color:#ff79c6">/</span>lang<span style="color:#ff79c6">/</span>String<span style="color:#ff79c6">;)</span>Ljava<span style="color:#ff79c6">/</span>lang<span style="color:#ff79c6">/</span>String<span style="color:#ff79c6">;</span>
</span></span></code></pre></div><p>We will need this tool <a href="https://github.com/patrickfav/uber-apk-signer/">https://github.com/patrickfav/uber-apk-signer/</a> to Sign the application:</p>
<pre><code>wget https://github.com/patrickfav/uber-apk-signer/releases/download/v1.1.0/uber-apk-signer-1.1.0.jar
</code></pre>
<p>Rebuild, sign and Launch the Application:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apktool b three
</span></span><span style="display:flex;"><span>java -jar uber-apk-signer-1.1.0.jar --apks three/dist
</span></span><span style="display:flex;"><span>adb install three/dist/three-aligned-debugSigned.apk
</span></span></code></pre></div><p>Flag: picoCTF{tis.but.a.scratch}</p>
<h2 id="droids4">droids4</h2>
<pre tabindex="0"><code>curl -LO https://jupiter.challenges.picoctf.org/static/926d4bfd7030b13dbc98ca26e608c740/four.apk
</code></pre><p>jadx four.apk
nvim</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">FlagstaffHill</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd;font-style:italic">native</span> String <span style="color:#50fa7b">cardamom</span><span style="color:#ff79c6">(</span>String str<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> String <span style="color:#50fa7b">getFlag</span><span style="color:#ff79c6">(</span>String input<span style="color:#ff79c6">,</span> Context ctx<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        StringBuilder ace <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> StringBuilder<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;aaa&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        StringBuilder jack <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> StringBuilder<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;aaa&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        StringBuilder queen <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> StringBuilder<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;aaa&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        StringBuilder king <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> StringBuilder<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;aaa&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        ace<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCharAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">char</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>ace<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">4</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        ace<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCharAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">char</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>ace<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">19</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        ace<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCharAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">char</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>ace<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">18</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        jack<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCharAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">char</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>jack<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">7</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        jack<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCharAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">char</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>jack<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">0</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        jack<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCharAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">char</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>jack<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        queen<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCharAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">char</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>queen<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">0</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        queen<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCharAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">char</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>queen<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">11</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        queen<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCharAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">char</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>queen<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">15</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        king<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCharAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">char</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>king<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">14</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        king<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCharAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">char</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>king<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">20</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        king<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCharAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">char</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>king<span style="color:#ff79c6">.</span><span style="color:#50fa7b">charAt</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">15</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        String password <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span>queen<span style="color:#ff79c6">.</span><span style="color:#50fa7b">toString</span><span style="color:#ff79c6">()).</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span>jack<span style="color:#ff79c6">.</span><span style="color:#50fa7b">toString</span><span style="color:#ff79c6">()).</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span>ace<span style="color:#ff79c6">.</span><span style="color:#50fa7b">toString</span><span style="color:#ff79c6">()).</span><span style="color:#50fa7b">concat</span><span style="color:#ff79c6">(</span>king<span style="color:#ff79c6">.</span><span style="color:#50fa7b">toString</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> input<span style="color:#ff79c6">.</span><span style="color:#50fa7b">equals</span><span style="color:#ff79c6">(</span>password<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">?</span> <span style="color:#f1fa8c">&#34;call it&#34;</span> <span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;NOPE&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><ul>
<li>We want to change the code to execute cardamon(input)</li>
<li>Our input is p0</li>
<li>We dont need to bruteforce the password, we can simply replace &ldquo;NOPE&rdquo; with the cardamaon function</li>
</ul>
<p>Replace with this code to invoke cardamon:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    # <span style="color:#8be9fd;font-style:italic">const</span><span style="color:#ff79c6">-</span>string v5<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;call it&#34;</span>
</span></span><span style="display:flex;"><span>    invoke<span style="color:#ff79c6">-</span><span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#ff79c6">{</span>p0<span style="color:#ff79c6">},</span> Lcom<span style="color:#ff79c6">/</span>hellocmu<span style="color:#ff79c6">/</span>picoctf<span style="color:#ff79c6">/</span>FlagstaffHill<span style="color:#ff79c6">;-&gt;</span>cardamon<span style="color:#ff79c6">(</span>Ljava<span style="color:#ff79c6">/</span>lang<span style="color:#ff79c6">/</span>String<span style="color:#ff79c6">;)</span>Ljava<span style="color:#ff79c6">/</span>lang<span style="color:#ff79c6">/</span>String<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    move<span style="color:#ff79c6">-</span>result<span style="color:#ff79c6">-</span>object v0
</span></span></code></pre></div><p>Rebuild and deploy</p>
<pre tabindex="0"><code>apktool b four
java -jar uber-apk-signer-1.1.0.jar --apks four/dist
adb install four/dist/four-aligned-debugSigned.apk
</code></pre><p>The password is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>ace   <span style="color:#ff79c6">=</span> [x <span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> <span style="color:#f1fa8c">&#34;aaa&#34;</span>]
</span></span><span style="display:flex;"><span>jack  <span style="color:#ff79c6">=</span>  [x <span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> <span style="color:#f1fa8c">&#34;aaa&#34;</span>]
</span></span><span style="display:flex;"><span>queen <span style="color:#ff79c6">=</span>  [x <span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> <span style="color:#f1fa8c">&#34;aaa&#34;</span>]
</span></span><span style="display:flex;"><span>king  <span style="color:#ff79c6">=</span>  [x <span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> <span style="color:#f1fa8c">&#34;aaa&#34;</span>]
</span></span><span style="display:flex;"><span>ace[<span style="color:#bd93f9">0</span>]<span style="color:#ff79c6">=</span>   <span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(ace[<span style="color:#bd93f9">0</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">4</span>)
</span></span><span style="display:flex;"><span>ace[<span style="color:#bd93f9">1</span>]<span style="color:#ff79c6">=</span>   <span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(ace[<span style="color:#bd93f9">1</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">19</span>)
</span></span><span style="display:flex;"><span>ace[<span style="color:#bd93f9">2</span>]<span style="color:#ff79c6">=</span>   <span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(ace[<span style="color:#bd93f9">2</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">18</span>)
</span></span><span style="display:flex;"><span>jack[<span style="color:#bd93f9">0</span>]<span style="color:#ff79c6">=</span>  <span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(jack[<span style="color:#bd93f9">0</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">7</span>)
</span></span><span style="display:flex;"><span>jack[<span style="color:#bd93f9">1</span>]<span style="color:#ff79c6">=</span>  <span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(jack[<span style="color:#bd93f9">1</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">0</span>)
</span></span><span style="display:flex;"><span>jack[<span style="color:#bd93f9">2</span>]<span style="color:#ff79c6">=</span>  <span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(jack[<span style="color:#bd93f9">2</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>)
</span></span><span style="display:flex;"><span>queen[<span style="color:#bd93f9">0</span>]<span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(queen[<span style="color:#bd93f9">0</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">0</span>)
</span></span><span style="display:flex;"><span>queen[<span style="color:#bd93f9">1</span>]<span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(queen[<span style="color:#bd93f9">1</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">11</span>)
</span></span><span style="display:flex;"><span>queen[<span style="color:#bd93f9">2</span>]<span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(queen[<span style="color:#bd93f9">2</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">15</span>)
</span></span><span style="display:flex;"><span>king[<span style="color:#bd93f9">0</span>]<span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(king[<span style="color:#bd93f9">0</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">14</span>)
</span></span><span style="display:flex;"><span>king[<span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(king[<span style="color:#bd93f9">1</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">20</span>)
</span></span><span style="display:flex;"><span>king[<span style="color:#bd93f9">2</span>] <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(king[<span style="color:#bd93f9">2</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">15</span>)
</span></span><span style="display:flex;"><span>ace <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join(ace)
</span></span><span style="display:flex;"><span>jack <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join(jack)
</span></span><span style="display:flex;"><span>queen <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join(queen)
</span></span><span style="display:flex;"><span>king <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join(king)
</span></span><span style="display:flex;"><span>password <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join([queen, jack, ace, king])
</span></span></code></pre></div><p>password: <code>alphabetsoup</code></p>
<p>Flag: picoCTF{not.particularly.silly}</p>
<h3 id="method-frida">Method Frida</h3>
<ul>
<li><a href="https://medium.com/android-news/hacking-android-app-with-frida-a85516f4f8b7">Hacking android app with frida</a></li>
<li><a href="https://medium.com/@parfaitayassor/get-started-with-frida-android-dynamic-analysis-cf10b18d5e67">Get started with frida android dynamic analysis</a></li>
</ul>
<p>Lets try with <a href="https://frida.re/docs/examples/android/">Frida</a> instead:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install frida-tools
</span></span><span style="display:flex;"><span>curl -LO https://github.com/frida/frida/releases/download/15.2.2/frida-server-15.2.2-android-x86_64.xz
</span></span><span style="display:flex;"><span>unxz frida-server-15.2.2-android-x86_64.xz
</span></span><span style="display:flex;"><span>adb root
</span></span><span style="display:flex;"><span>adb push frida-server-15.2.2-android-x86_64
</span></span><span style="display:flex;"><span>adb shell
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> /data/local/tmp
</span></span><span style="display:flex;"><span>chmod <span style="color:#bd93f9">755</span> frida*
</span></span><span style="display:flex;"><span>./frida-server-15.2.2-android-x86_64
</span></span></code></pre></div><p>script.js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Java<span style="color:#ff79c6">.</span><span style="color:#50fa7b">perform</span><span style="color:#ff79c6">(</span>function <span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>  console<span style="color:#ff79c6">.</span><span style="color:#50fa7b">log</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;[-] Starting hooks com.hellocmu.picoctf.FlagstaffHill&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>  var getFlag <span style="color:#ff79c6">=</span> Java<span style="color:#ff79c6">.</span><span style="color:#50fa7b">use</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;com.hellocmu.picoctf.FlagstaffHill&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>  getFlag<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getFlag</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">implementation</span> <span style="color:#ff79c6">=</span> function <span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    var flag <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">cardamom</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;alphabetsoup&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    console<span style="color:#ff79c6">.</span><span style="color:#50fa7b">log</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;GOT FLAG: &#34;</span> <span style="color:#ff79c6">+</span> flag<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> flag<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">};</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">});</span>
</span></span></code></pre></div><p>Use the app on simulator, and whatever you type, the getFlag will always execute cardamon(&ldquo;alphabetsoup&rdquo;) :)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>frida -U --no-pause -l ./script.js -f com.hellocmu.picoctf
</span></span></code></pre></div><p>output:</p>
<pre><code>     ____
    / _  |   Frida 15.2.2 - A world-class dynamic instrumentation toolkit
   | (_| |
    &gt; _  |   Commands:
   /_/ |_|       help      -&gt; Displays the help system
   . . . .       object?   -&gt; Display information about 'object'
   . . . .       exit/quit -&gt; Exit
   . . . .
   . . . .   More info at https://frida.re/docs/home/
   . . . .
   . . . .   Connected to Android Emulator 5554 (id=emulator-5554)
Spawned `com.hellocmu.picoctf`. Resuming main thread!
[Android Emulator 5554::com.hellocmu.picoctf ]-&gt; [-] Starting hooks com.hellocmu.picoctf.FlagstaffHill
GOT FLAG: picoCTF{not.particularly.silly}
</code></pre>
<h2 id="asm3">asm3</h2>
<blockquote>
<p>What does asm3(0xba6c5a02,0xd101e3dd,0xbb86a173) return</p>
</blockquote>
<p>After the prolog, the stack looks like this:</p>
<pre><code>| arg3      | &lt;-- ebp+0x10 = 0xbb86a173
| arg2      | &lt;-- ebp+0xc  = 0xd101e3dd
| arg1      | &lt;-- ebp+8    = 0xba6c5a02
| ret       |
| old ebp   | &lt;--new ebp
</code></pre>
<h3 id="internals">Internals</h3>
<p>Lets represent a table with offset relatively to ebp:</p>
<pre><code>&lt;--most significant/least significant-&gt;
offset |    | x12 |    |    |    |    | xd | xc | xb |    |    | x8 |
Bytes  | bb | 86  | a1 | 73 | d1 | 01 | e3 | dd | ba | 6c | 5a | 02 |
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">asm3:</span>
</span></span><span style="display:flex;"><span>        &lt;+0&gt;:   <span style="color:#50fa7b">push</span>   ebp      <span style="color:#6272a4">; prolog ;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+1&gt;:   <span style="color:#50fa7b">mov</span>    ebp,esp  <span style="color:#6272a4">; prolog ;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+3&gt;:   <span style="color:#50fa7b">xor</span>    eax,eax                  <span style="color:#6272a4">; eax =0
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+5&gt;:   <span style="color:#50fa7b">mov</span>    ah,BYTE PTR [ebp+<span style="color:#bd93f9">0xb</span>]    <span style="color:#6272a4">; ah = xba
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+8&gt;:   <span style="color:#50fa7b">shl</span>    ax,<span style="color:#bd93f9">0x10</span>                  <span style="color:#6272a4">; ax = ax &lt;&lt; 16
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+12&gt;:  <span style="color:#50fa7b">sub</span>    al,BYTE PTR [ebp+<span style="color:#bd93f9">0xd</span>]    <span style="color:#6272a4">; al -= xe3
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+15&gt;:  <span style="color:#50fa7b">add</span>    ah,BYTE PTR [ebp+<span style="color:#bd93f9">0xc</span>]    <span style="color:#6272a4">; ah += xdd
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+18&gt;:  <span style="color:#50fa7b">xor</span>    ax,WORD PTR [ebp+<span style="color:#bd93f9">0x12</span>]   <span style="color:#6272a4">; ax = ax ^ xbb86
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+22&gt;:  <span style="color:#50fa7b">nop</span>
</span></span><span style="display:flex;"><span>        &lt;+23&gt;:  <span style="color:#50fa7b">pop</span>    ebp
</span></span><span style="display:flex;"><span>        &lt;+24&gt;:  <span style="color:#50fa7b">ret</span>
</span></span></code></pre></div><p>Now let&rsquo;s examine the 32 bits EAX register at each step:</p>
<pre><code>&lt;--most significant/least significant-&gt;
|   operation    |       |    AX   |
|                |       | AH | AL |
+----------------+-------+----+----+
|  eax=0         | 00 00 | 00 | 00 |
|  ah=xba        | 00 00 | ba | 00 |
|  ax=ax&lt;&lt;16     | 00 00 | 00 | 00 |
|  al-=0xe3      | 00 00 | 00 | 1d | (2's Complement)
|  ah+=xdd       | 00 00 | dd | 1d |
|  ax=ax^x86a1   | 00 00 | 66 | 9b | hex(0xdd1d ^ 0xbb86) = 0x669b
</code></pre>
<p>x86 utilizes <a href="https://www.tutorialspoint.com/two-s-complement"><strong>2&rsquo;s Complement</strong></a> to represent negative numbers.
To calculate the 2&rsquo;s Complement given a certain binary:</p>
<ol>
<li>invert all the bits to obtain the 1&rsquo;s Complement</li>
<li>add +1 to obtain the 2&rsquo;s Complement</li>
</ol>
<table>
<thead>
<tr>
<th>hex</th>
<th>dec</th>
<th>binary</th>
<th>1&rsquo;s complement</th>
<th>2&rsquo;s complement</th>
</tr>
</thead>
<tbody>
<tr>
<td>0xe3</td>
<td>227</td>
<td>1110 0011</td>
<td>0001 1100 (0x1c)</td>
<td>0001 1101 (0x1d)</td>
</tr>
</tbody>
</table>
<h3 id="radare2-way">Radare2 way</h3>
<p>Rewrite the code so that you can compile it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#6272a4">;intel_syntax noprefix
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">;bits 32
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">SECTION</span> .data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">SECTION</span> .text
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">global</span>  _start
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">_start:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">push</span> <span style="color:#bd93f9">0xbb86a173</span>		<span style="color:#6272a4">; push arg3
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	<span style="color:#50fa7b">push</span> <span style="color:#bd93f9">0xd101e3dd</span>		<span style="color:#6272a4">; push arg2
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	<span style="color:#50fa7b">push</span> <span style="color:#bd93f9">0xba6c5a02</span>		<span style="color:#6272a4">; push arg1
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	<span style="color:#50fa7b">call</span> asm3
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">asm3:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#50fa7b">push</span>   ebp      <span style="color:#6272a4">; prolog ;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#50fa7b">mov</span>    ebp,esp  <span style="color:#6272a4">; prolog ;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#50fa7b">xor</span>    eax,eax                  <span style="color:#6272a4">; eax =0
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#50fa7b">mov</span>    ah,BYTE [ebp+<span style="color:#bd93f9">0xb</span>]    <span style="color:#6272a4">; ah = x02
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#50fa7b">shl</span>    ax,<span style="color:#bd93f9">0x10</span>                  <span style="color:#6272a4">; ax = ax &lt;&lt; 16
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#50fa7b">sub</span>    al,BYTE [ebp+<span style="color:#bd93f9">0xd</span>]    <span style="color:#6272a4">; al -= x01
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#50fa7b">add</span>    ah,BYTE [ebp+<span style="color:#bd93f9">0xc</span>]    <span style="color:#6272a4">; ah += xd1
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#50fa7b">xor</span>    ax,WORD [ebp+<span style="color:#bd93f9">0x12</span>]   <span style="color:#6272a4">; ax = ax ^ xa173
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#50fa7b">nop</span>
</span></span><span style="display:flex;"><span>        <span style="color:#50fa7b">pop</span>    ebp
</span></span><span style="display:flex;"><span>        <span style="color:#50fa7b">ret</span>
</span></span></code></pre></div><p>compile and run</p>
<pre><code>nasm -f elf32 asm3.asm
ld -m elf_i386 asm3.o -o asm3
radare2 ./asm3
</code></pre>
<p>On radare2, analyze <code>aaaa</code> and type <code>pdf</code> to read the assembly code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span>|           <span style="color:#6272a4">; arg int32_t arg_bh @ ebp+0xb
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>|           <span style="color:#6272a4">; arg int32_t arg_ch @ ebp+0xc
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>|           <span style="color:#6272a4">; arg int32_t arg_dh @ ebp+0xd
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>|           <span style="color:#6272a4">; arg int32_t arg_12h @ ebp+0x12
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>|           0<span style="color:#50fa7b">x08049000</span>      <span style="color:#bd93f9">6873</span>a186bb     push <span style="color:#bd93f9">0xbb86a173</span>             <span style="color:#6272a4">; [01] -r-x section size 45 named .text
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>|           0<span style="color:#50fa7b">x08049005</span>      <span style="color:#bd93f9">68</span>dde301d1     push <span style="color:#bd93f9">0xd101e3dd</span>
</span></span><span style="display:flex;"><span>|           0<span style="color:#50fa7b">x0804900a</span>      <span style="color:#bd93f9">68025</span>a6cba     push <span style="color:#bd93f9">0xba6c5a02</span>
</span></span><span style="display:flex;"><span>|           0<span style="color:#50fa7b">x0804900f</span>      e800000000     call loc.asm3
</span></span><span style="display:flex;"><span>|           <span style="color:#6272a4">; CALL XREF from entry0 @ 0x804900f
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>|           <span style="color:#6272a4">;-- asm3:
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>|           0<span style="color:#50fa7b">x08049014</span>      <span style="color:#bd93f9">55</span>             push ebp
</span></span><span style="display:flex;"><span>|           0<span style="color:#50fa7b">x08049015</span>      <span style="color:#bd93f9">89</span>e5           mov ebp, esp
</span></span><span style="display:flex;"><span>|           0<span style="color:#50fa7b">x08049017</span>      <span style="color:#bd93f9">31</span>c0           xor eax, eax
</span></span><span style="display:flex;"><span>|           0<span style="color:#50fa7b">x08049019</span>      <span style="color:#bd93f9">8</span>a650b         mov ah, byte [arg_bh]
</span></span><span style="display:flex;"><span>|           0<span style="color:#50fa7b">x0804901c</span>      <span style="color:#bd93f9">66</span>c1e010       shl ax, <span style="color:#bd93f9">0x10</span>
</span></span><span style="display:flex;"><span>|           0<span style="color:#50fa7b">x08049020</span>      <span style="color:#bd93f9">2</span>a450d         sub al, byte [arg_dh]
</span></span><span style="display:flex;"><span>|           0<span style="color:#50fa7b">x08049023</span>      <span style="color:#bd93f9">02650</span>c         add ah, byte [arg_ch]
</span></span><span style="display:flex;"><span>|           0<span style="color:#50fa7b">x08049026</span>      <span style="color:#bd93f9">66334512</span>       xor ax, word [arg_12h]
</span></span><span style="display:flex;"><span>|           0<span style="color:#50fa7b">x0804902a</span>      <span style="color:#bd93f9">90</span>             nop
</span></span><span style="display:flex;"><span>|           0<span style="color:#50fa7b">x0804902b</span>      <span style="color:#bd93f9">5</span>d             pop ebp
</span></span><span style="display:flex;"><span>\           0<span style="color:#50fa7b">x0804902c</span>      c3             ret
</span></span></code></pre></div><p>Set a breakpoint at the nop, then launch the program in debug mode, to retrieve the result in EAX register:</p>
<pre><code>db 0x0804902a       ; breakpoint
ood                 ; launch programme in debug mode
dc                  ; continue until next breakpoint
dr eax              ; check eax register, this is your solution
</code></pre>
<p>Some more useful commands to troubleshoot:</p>
<pre><code>ds                  ; next step (when in debugger mode)
p8 4 @ ebp+0x8      ; verify arg1
p8 4 @ ebp+0xc      ; verify arg2
p8 4 @ ebp+0x10     ; verify arg3
px 20 @ ebp         ; dump 20 bytes above ebp
</code></pre>
<h2 id="vault-door-5">vault-door-5</h2>
<p>At line 4, the <code>%%</code> is an escape charcter to write &lsquo;%&rsquo; instead of using it as a format string, then the following %2x will write the hex representation of the ascii character.
In other term, if we encode <strong>AAAA</strong>, the output will be <strong>%41%41%41%41</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> String <span style="color:#50fa7b">urlEncode</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> input<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    StringBuffer buf <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> StringBuffer<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> i<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">&lt;</span>input<span style="color:#ff79c6">.</span><span style="color:#50fa7b">length</span><span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">++)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        buf<span style="color:#ff79c6">.</span><span style="color:#50fa7b">append</span><span style="color:#ff79c6">(</span>String<span style="color:#ff79c6">.</span><span style="color:#50fa7b">format</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;%%%2x&#34;</span><span style="color:#ff79c6">,</span> input<span style="color:#ff79c6">[</span>i<span style="color:#ff79c6">]));</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> buf<span style="color:#ff79c6">.</span><span style="color:#50fa7b">toString</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">boolean</span> <span style="color:#50fa7b">checkPassword</span><span style="color:#ff79c6">(</span>String password<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    String urlEncoded <span style="color:#ff79c6">=</span> urlEncode<span style="color:#ff79c6">(</span>password<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getBytes</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>    String base64Encoded <span style="color:#ff79c6">=</span> base64Encode<span style="color:#ff79c6">(</span>urlEncoded<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getBytes</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>    String expected <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;JTYzJTMwJTZlJTc2JTMzJTcyJTc0JTMxJTZlJTY3JTVm&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;JTY2JTcyJTMwJTZkJTVmJTYyJTYxJTM1JTY1JTVmJTM2&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;JTM0JTVmJTM4JTM0JTY2JTY0JTM1JTMwJTM5JTM1&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> base64Encoded<span style="color:#ff79c6">.</span><span style="color:#50fa7b">equals</span><span style="color:#ff79c6">(</span>expected<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>We can base64 decode and get rid of the &lsquo;%&rsquo; characters</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">enc</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;JTYzJTMwJTZlJTc2JTMzJTcyJTc0JTMxJTZlJTY3JTVmJTY2JTcyJTMwJTZkJTVmJTYyJTYxJTM1JTY1JTVmJTM2JTM0JTVmJTM4JTM0JTY2JTY0JTM1JTMwJTM5JTM1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#8be9fd;font-style:italic">$enc</span> | base64 -d | tr -d <span style="color:#f1fa8c">&#39;%&#39;</span>
</span></span><span style="display:flex;"><span>63306e76337274316e675f6672306d5f626135655f36345f3834666435303935
</span></span></code></pre></div><p>Then unhexlify:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>m <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;63306e76337274316e675f6672306d5f626135655f36345f3834666435303935&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> binascii <span style="color:#ff79c6">import</span> unhexlify
</span></span><span style="display:flex;"><span>unhexlify(m)
</span></span></code></pre></div><h2 id="reverse_cipher">reverse_cipher</h2>
<pre><code>cat rev_this &amp;&amp; echo
picoCTF{w1{1wq8/7376j.:}
</code></pre>
<p>Using radare2, we see the _rev__ binary requires a flag.txt in input. I first create this file with a false flag having same size rev_this:</p>
<pre><code>cat &lt;&lt; EOF &gt;&gt; flag.txt
picoCTF{ABCDEFGHIJKLMNO}
EOF
./rev flag.txt
</code></pre>
<p>Open rev_this and see the new encrypted flag appended at the end:</p>
<pre><code>cat rev_this &amp;&amp; echo
picoCTF{w1{1wq8/7376j.:}picoCTF{F@HBJDLFNHPJRLT}
</code></pre>
<p>I can try multiple value to bruteforce:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rm rev_this <span style="color:#ff79c6">&amp;&amp;</span> <span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;picoCTF{AAAAAAAAAAAAAAA}&#34;</span> &gt; flag.txt <span style="color:#ff79c6">&amp;&amp;</span> ./rev flag.txt <span style="color:#ff79c6">&amp;&amp;</span> cat rev_this <span style="color:#ff79c6">&amp;&amp;</span> <span style="color:#8be9fd;font-style:italic">echo</span>
</span></span><span style="display:flex;"><span>picoCTF<span style="color:#ff79c6">{</span>F?F?F?F?F?F?F?F<span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>rm rev_this <span style="color:#ff79c6">&amp;&amp;</span> <span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;picoCTF{AAAAAAAAAAAAAAB}&#34;</span> &gt; flag.txt <span style="color:#ff79c6">&amp;&amp;</span> ./rev flag.txt <span style="color:#ff79c6">&amp;&amp;</span> cat rev_this <span style="color:#ff79c6">&amp;&amp;</span> <span style="color:#8be9fd;font-style:italic">echo</span>
</span></span><span style="display:flex;"><span>picoCTF<span style="color:#ff79c6">{</span>F?F?F?F?F?F?F?G<span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>it looks like there is a different caesar pattern depending if the char is on an odd or even number:</p>
<ul>
<li>to decrypt odd number remove 5 to the ascii value: 5 = ord(&lsquo;F&rsquo;)-ord(&lsquo;A&rsquo;)</li>
<li>to decrypt even char add +2 to the ascci value: -2 = ord(&lsquo;B&rsquo;)-ord(&lsquo;D)&rsquo;)</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>plaintext</td>
<td>A</td>
<td>B</td>
<td>C</td>
<td>D</td>
<td>E</td>
<td>etc</td>
</tr>
<tr>
<td>encrypted if even</td>
<td>F</td>
<td>G</td>
<td>H</td>
<td>I</td>
<td>J</td>
<td>etc</td>
</tr>
<tr>
<td>encrypted if odd</td>
<td>?</td>
<td>@</td>
<td>A</td>
<td>B</td>
<td>C</td>
<td>etc</td>
</tr>
</tbody>
</table>
<p>to make it easier to code, I need a cipher having an even number of characters, so Iwill pad it with an additional &lsquo;A&rsquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>c <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;w1{1wq8/7376j.:&#39;</span> <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#39;A&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> [ <span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join([<span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(c[x])<span style="color:#ff79c6">-</span><span style="color:#bd93f9">5</span>) ,<span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(c[x<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>])<span style="color:#ff79c6">+</span><span style="color:#bd93f9">2</span>)]) <span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, <span style="color:#8be9fd;font-style:italic">len</span>(c), <span style="color:#bd93f9">2</span>)]
</span></span><span style="display:flex;"><span>[<span style="color:#f1fa8c">&#39;r3&#39;</span>, <span style="color:#f1fa8c">&#39;v3&#39;</span>, <span style="color:#f1fa8c">&#39;rs&#39;</span>, <span style="color:#f1fa8c">&#39;31&#39;</span>, <span style="color:#f1fa8c">&#39;25&#39;</span>, <span style="color:#f1fa8c">&#39;28&#39;</span>, <span style="color:#f1fa8c">&#39;e0&#39;</span>, <span style="color:#f1fa8c">&#39;5C&#39;</span>]
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> <span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join([ <span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join([<span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(c[x])<span style="color:#ff79c6">-</span><span style="color:#bd93f9">5</span>) ,<span style="color:#8be9fd;font-style:italic">chr</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(c[x<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>])<span style="color:#ff79c6">+</span><span style="color:#bd93f9">2</span>)]) <span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, <span style="color:#8be9fd;font-style:italic">len</span>(c), <span style="color:#bd93f9">2</span>)])
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#39;r3v3rs312528e05C&#39;</span>
</span></span></code></pre></div><p>of course we have to get rid of the final character &lsquo;C&rsquo; because this is our additional &lsquo;A&rsquo; used to pad the cipher</p>
<h2 id="vault-door-6">vault-door-6</h2>
<p>The password is 32 characters and must match the mBytes sequence below after being XOR 0x55.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">boolean</span> <span style="color:#50fa7b">checkPassword</span><span style="color:#ff79c6">(</span>String password<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>password<span style="color:#ff79c6">.</span><span style="color:#50fa7b">length</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">!=</span> <span style="color:#bd93f9">32</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> passBytes <span style="color:#ff79c6">=</span> password<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getBytes</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> myBytes <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#bd93f9">0x3b</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x65</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x21</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0xa</span> <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x38</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x0</span> <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x36</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x1d</span><span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#bd93f9">0xa</span> <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x3d</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x61</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x27</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x11</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x66</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x27</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0xa</span> <span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#bd93f9">0x21</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x1d</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x61</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x3b</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0xa</span> <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x2d</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x65</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x27</span><span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#bd93f9">0xa</span> <span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x66</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x36</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x30</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x67</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x6c</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x64</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0x6c</span><span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">};</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> i<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">&lt;</span><span style="color:#bd93f9">32</span><span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">++)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(((</span>passBytes<span style="color:#ff79c6">[</span>i<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">^</span> <span style="color:#bd93f9">0x55</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">-</span> myBytes<span style="color:#ff79c6">[</span>i<span style="color:#ff79c6">])</span> <span style="color:#ff79c6">!=</span> <span style="color:#bd93f9">0</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>to decrypt XOR, you simply have to XOR 0x55 a second time, because of the XOR arithmetic:</p>
<ul>
<li>p ^ 0x55 = m</li>
<li>p ^ 0x55 ^0x55 = m ^ 0x55</li>
<li>p = m ^ 0x55</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>mBytes <span style="color:#ff79c6">=</span> [<span style="color:#bd93f9">0x3b</span>, <span style="color:#bd93f9">0x65</span>, <span style="color:#bd93f9">0x21</span>, <span style="color:#bd93f9">0xa</span> , <span style="color:#bd93f9">0x38</span>, <span style="color:#bd93f9">0x0</span> , <span style="color:#bd93f9">0x36</span>, <span style="color:#bd93f9">0x1d</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#bd93f9">0xa</span> , <span style="color:#bd93f9">0x3d</span>, <span style="color:#bd93f9">0x61</span>, <span style="color:#bd93f9">0x27</span>, <span style="color:#bd93f9">0x11</span>, <span style="color:#bd93f9">0x66</span>, <span style="color:#bd93f9">0x27</span>, <span style="color:#bd93f9">0xa</span> ,
</span></span><span style="display:flex;"><span>        <span style="color:#bd93f9">0x21</span>, <span style="color:#bd93f9">0x1d</span>, <span style="color:#bd93f9">0x61</span>, <span style="color:#bd93f9">0x3b</span>, <span style="color:#bd93f9">0xa</span> , <span style="color:#bd93f9">0x2d</span>, <span style="color:#bd93f9">0x65</span>, <span style="color:#bd93f9">0x27</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#bd93f9">0xa</span> , <span style="color:#bd93f9">0x66</span>, <span style="color:#bd93f9">0x36</span>, <span style="color:#bd93f9">0x30</span>, <span style="color:#bd93f9">0x67</span>, <span style="color:#bd93f9">0x6c</span>, <span style="color:#bd93f9">0x64</span>, <span style="color:#bd93f9">0x6c</span>]
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join([<span style="color:#8be9fd;font-style:italic">chr</span>(x <span style="color:#ff79c6">^</span> <span style="color:#bd93f9">0x55</span>) <span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> mBytes])
</span></span></code></pre></div><h2 id="asm4">asm4</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span>        &lt;+0&gt;:   <span style="color:#50fa7b">push</span>   ebp                              <span style="color:#6272a4">;prolog
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+1&gt;:   <span style="color:#50fa7b">mov</span>    ebp,esp                          <span style="color:#6272a4">;prolog
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+3&gt;:   <span style="color:#50fa7b">push</span>   ebx                              <span style="color:#6272a4">;save ebs in stack
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+4&gt;:   <span style="color:#50fa7b">sub</span>    esp,<span style="color:#bd93f9">0x10</span>                         <span style="color:#6272a4">;reserve some space in the stack for locals
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+7&gt;:   <span style="color:#50fa7b">mov</span>    DWORD PTR [ebp-0x10],<span style="color:#bd93f9">0x27a</span>       <span style="color:#6272a4">;ebp10  = 0x27a
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+14&gt;:  <span style="color:#50fa7b">mov</span>    DWORD PTR [ebp-0xc],<span style="color:#bd93f9">0x0</span>          <span style="color:#6272a4">;ebpc   = 0
</span></span></span></code></pre></div><p>View of our stack trace:</p>
<table>
<thead>
<tr>
<th>stack</th>
<th>address</th>
</tr>
</thead>
<tbody>
<tr>
<td>argument</td>
<td>&lt;&ndash; ebp+8</td>
</tr>
<tr>
<td>ret</td>
<td>&lt;&ndash; ebp+4</td>
</tr>
<tr>
<td>old ebp</td>
<td>&lt;&ndash; ebp</td>
</tr>
<tr>
<td>saved ebx</td>
<td></td>
</tr>
<tr>
<td></td>
<td>&lt;&ndash; ebp8</td>
</tr>
<tr>
<td>0x0</td>
<td>&lt;&ndash; ebpc (ebp-0xc)</td>
</tr>
<tr>
<td>0x27a</td>
<td>&lt;&ndash; esp = ebp10 (ebp-0x10)</td>
</tr>
</tbody>
</table>
<p>The next section aims to count the number of characters of our argument, by incrementing ebp-c by 1 for every characters until we find the NULL-string 0x00 that marks the end of our String.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span>        &lt;+21&gt;:  <span style="color:#50fa7b">jmp</span>    <span style="color:#bd93f9">0x518</span> &lt;asm4+<span style="color:#bd93f9">27</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;+23&gt;:  <span style="color:#50fa7b">add</span>    DWORD PTR [ebp-0xc],<span style="color:#bd93f9">0x1</span>          <span style="color:#6272a4">;do { ebpc += 1
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+27&gt;:  <span style="color:#50fa7b">mov</span>    edx,DWORD PTR [ebp-0xc]          <span style="color:#6272a4">;edx = ebpc
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+30&gt;:  <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]          <span style="color:#6272a4">;eax = pointer to our argument &#34;picoCTF_f97bb&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+33&gt;:  <span style="color:#50fa7b">add</span>    eax,edx                          <span style="color:#6272a4">;eax = eax + edx
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+35&gt;:  <span style="color:#50fa7b">movzx</span>  eax,BYTE PTR [eax]               <span style="color:#6272a4">;eax = argument[eax]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+38&gt;:  <span style="color:#50fa7b">test</span>   al,al                            <span style="color:#6272a4">;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+40&gt;:  <span style="color:#50fa7b">jne</span>    <span style="color:#bd93f9">0x514</span> &lt;asm4+<span style="color:#bd93f9">23</span>&gt;                  <span style="color:#6272a4">;} while(eax != ######00) jump to label (detect end of string)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+42&gt;:  <span style="color:#50fa7b">mov</span>    DWORD PTR [ebp-0x8],<span style="color:#bd93f9">0x1</span>          <span style="color:#6272a4">; ebp8 = 1
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        &lt;+49&gt;:  <span style="color:#50fa7b">jmp</span>    <span style="color:#bd93f9">0x587</span> &lt;asm4+<span style="color:#bd93f9">138</span>&gt;
</span></span></code></pre></div><table>
<thead>
<tr>
<th>stack</th>
<th>address</th>
</tr>
</thead>
<tbody>
<tr>
<td>argument</td>
<td>&lt;&ndash; ebp+8</td>
</tr>
<tr>
<td>ret</td>
<td>&lt;&ndash; ebp+4</td>
</tr>
<tr>
<td>old ebp</td>
<td>&lt;&ndash; ebp</td>
</tr>
<tr>
<td>saved ebx</td>
<td></td>
</tr>
<tr>
<td>0x1</td>
<td>&lt;&ndash; ebp8</td>
</tr>
<tr>
<td>0xd</td>
<td>&lt;&ndash; ebpc (ebp-0xc) = len(argument)</td>
</tr>
<tr>
<td>0x27a</td>
<td>&lt;&ndash; esp = ebp10 (ebp-0x10)</td>
</tr>
</tbody>
</table>
<p>We can examine a certain portion of the code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span>&lt;+51&gt;:  <span style="color:#50fa7b">mov</span>    edx,DWORD PTR [ebp-0x8]  <span style="color:#6272a4">;for(ebp8=1; ebp8 &lt; len(argument)-1; ebp8++) { edx= current index)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+54&gt;:  <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]  <span style="color:#6272a4">;eax points to adress of argument[ebp8]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+57&gt;:  <span style="color:#50fa7b">add</span>    eax,edx                  <span style="color:#6272a4">;eax += edx                ; offset of current character
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+59&gt;:  <span style="color:#50fa7b">movzx</span>  eax,BYTE PTR [eax]       <span style="color:#6272a4">;eax  = argument[eax]      ; current character value
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+62&gt;:  <span style="color:#50fa7b">movsx</span>  edx,al                   <span style="color:#6272a4">;edx  = al = argument[eax] ; current character
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>[<span style="color:#50fa7b">..snip..</span>]
</span></span><span style="display:flex;"><span>&lt;+134&gt;: <span style="color:#50fa7b">add</span>    DWORD PTR [ebp-0x8],<span style="color:#bd93f9">0x1</span>  <span style="color:#6272a4">;ebp8++ ; this is the increment for the loop
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+138&gt;: <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp-0xc]  <span style="color:#6272a4">;eax = len(argument)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+141&gt;: <span style="color:#50fa7b">sub</span>    eax,<span style="color:#bd93f9">0x1</span>                  <span style="color:#6272a4">;eax-=1
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+144&gt;: <span style="color:#50fa7b">cmp</span>    DWORD PTR [ebp-0x8],eax  <span style="color:#6272a4">;eax                    ;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+147&gt;: <span style="color:#50fa7b">jl</span>     <span style="color:#bd93f9">0x530</span> &lt;asm4+<span style="color:#bd93f9">51</span>&gt;          <span style="color:#6272a4">;} // keep the loop while  ebp8 &lt; len(argument)-1
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+149&gt;: <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp-0x10] <span style="color:#6272a4">;return ebp10
</span></span></span></code></pre></div><p>This portion of code translate into:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>ebp10 <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0x27a</span>
</span></span><span style="display:flex;"><span>argument <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;picoCTF_f97bb&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">1</span>, <span style="color:#8be9fd;font-style:italic">len</span>(argument)<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>):
</span></span><span style="display:flex;"><span>    current <span style="color:#ff79c6">=</span> argument[i]
</span></span><span style="display:flex;"><span>    [<span style="color:#ff79c6">..</span>snip<span style="color:#ff79c6">..</span>]
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">return</span> ebp10
</span></span></code></pre></div><p>Next portion of code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span>&lt;+65&gt;:  <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp-0x8]  <span style="color:#6272a4">;eax  = ebp8            ;eax=current char index
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+68&gt;:  <span style="color:#50fa7b">lea</span>    ecx,[eax-0x1]            <span style="color:#6272a4">;ecx  = ebp8 -1         ;ecx=previous char index
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+71&gt;:  <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]  <span style="color:#6272a4">;eax points to argument
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+74&gt;:  <span style="color:#50fa7b">add</span>    eax,ecx                  <span style="color:#6272a4">;eax point to adress of previous char
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+76&gt;:  <span style="color:#50fa7b">movzx</span>  eax,BYTE PTR [eax]       <span style="color:#6272a4">;eax = argument[prev]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+79&gt;:  <span style="color:#50fa7b">movsx</span>  eax,al                   <span style="color:#6272a4">;eax = argument[prev]   ;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+82&gt;:  <span style="color:#50fa7b">sub</span>    edx,eax                  <span style="color:#6272a4">;edx = ord(current) - ord(previous)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+84&gt;:  <span style="color:#50fa7b">mov</span>    eax,edx                  <span style="color:#6272a4">;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+86&gt;:  <span style="color:#50fa7b">mov</span>    edx,eax                  <span style="color:#6272a4">;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+88&gt;:  <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp-0x10] <span style="color:#6272a4">;eax = ebp10
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+91&gt;:  <span style="color:#50fa7b">lea</span>    ebx,[edx+eax*<span style="color:#bd93f9">1</span>]          <span style="color:#6272a4">;                       ;ebx = ord(current) -ord(previous) + ebp10
</span></span></span></code></pre></div><p>This code translates into</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>previous <span style="color:#ff79c6">=</span> argument[i<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>]
</span></span><span style="display:flex;"><span>ebx <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">ord</span>(current) <span style="color:#ff79c6">-</span> <span style="color:#8be9fd;font-style:italic">ord</span>(previous) <span style="color:#ff79c6">+</span> ebp10
</span></span></code></pre></div><p>Next portion of code</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span>&lt;+94&gt;:  <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp-0x8]  <span style="color:#6272a4">;eax = index of current char
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+97&gt;:  <span style="color:#50fa7b">lea</span>    edx,[eax+<span style="color:#bd93f9">0x1</span>]            <span style="color:#6272a4">;edx = ebp8+1 (index of next char)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+100&gt;: <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]  <span style="color:#6272a4">;eax points to argument ;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+103&gt;: <span style="color:#50fa7b">add</span>    eax,edx                  <span style="color:#6272a4">;eax = next char index
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+105&gt;: <span style="color:#50fa7b">movzx</span>  eax,BYTE PTR [eax]       <span style="color:#6272a4">;eax = argument[next]   ;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+108&gt;: <span style="color:#50fa7b">movsx</span>  edx,al                   <span style="color:#6272a4">;edx = argument[next]   ; edx = next char
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+111&gt;: <span style="color:#50fa7b">mov</span>    ecx,DWORD PTR [ebp-0x8]  <span style="color:#6272a4">;ecx = ebp8 (current char index)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+114&gt;: <span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]  <span style="color:#6272a4">;eax points to argument ;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+117&gt;: <span style="color:#50fa7b">add</span>    eax,ecx                  <span style="color:#6272a4">;eax =  current char index
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+119&gt;: <span style="color:#50fa7b">movzx</span>  eax,BYTE PTR [eax]       <span style="color:#6272a4">;eax =  current char value
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+122&gt;: <span style="color:#50fa7b">movsx</span>  eax,al                   <span style="color:#6272a4">;eax = ord(current)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+125&gt;: <span style="color:#50fa7b">sub</span>    edx,eax                  <span style="color:#6272a4">;edx -= ord(current)    ; edx = ord(next) - ord(current)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+127&gt;: <span style="color:#50fa7b">mov</span>    eax,edx                  <span style="color:#6272a4">;eax = edx              ; eax = ord(next) - ord(current)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+129&gt;: <span style="color:#50fa7b">add</span>    eax,ebx                  <span style="color:#6272a4">;eax += ebx             ; eax   = ord(next) - ord(&#39;current&#39;) + ebx
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>&lt;+131&gt;: <span style="color:#50fa7b">mov</span>    DWORD PTR [ebp-0x10],eax <span style="color:#6272a4">;ebp10 = eax            ; ebp10 = ord(next) - ord(&#39;current&#39;) + ebx
</span></span></span></code></pre></div><p>translates into:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">next</span>  <span style="color:#ff79c6">=</span> argument[i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>]
</span></span><span style="display:flex;"><span>ebp10 <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">ord</span>(<span style="color:#8be9fd;font-style:italic">next</span>) <span style="color:#ff79c6">-</span> <span style="color:#8be9fd;font-style:italic">ord</span>(current) <span style="color:#ff79c6">+</span> ebx
</span></span></code></pre></div><p>We can reconstitute the whole algorithm:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>ebp10 <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0x27a</span>
</span></span><span style="display:flex;"><span>argument <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;picoCTF_f97bb&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">1</span>, <span style="color:#8be9fd;font-style:italic">len</span>(argument)<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>):
</span></span><span style="display:flex;"><span>    current <span style="color:#ff79c6">=</span> argument[i]
</span></span><span style="display:flex;"><span>    previous <span style="color:#ff79c6">=</span> argument[i<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>]
</span></span><span style="display:flex;"><span>    ebx <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">ord</span>(current) <span style="color:#ff79c6">-</span> <span style="color:#8be9fd;font-style:italic">ord</span>(previous) <span style="color:#ff79c6">+</span> ebp10
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">next</span>  <span style="color:#ff79c6">=</span> argument[i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>]
</span></span><span style="display:flex;"><span>    ebp10 <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">ord</span>(<span style="color:#8be9fd;font-style:italic">next</span>) <span style="color:#ff79c6">-</span> <span style="color:#8be9fd;font-style:italic">ord</span>(current) <span style="color:#ff79c6">+</span> ebx
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#8be9fd;font-style:italic">hex</span>(ebp10))
</span></span></code></pre></div><h3 id="method-compilation-with-dedicated-assembly-file">Method: compilation with dedicated assembly file</h3>
<ol>
<li>We have to remove the line numbers</li>
<li>Rewrite all branches, as an example <code>jmp 0x518 &lt;asm4+27</code> to match instead: <code>jmp asm4+27</code></li>
<li>We also have to add the below at the beginning of the file so that we can compile it with gcc and call it from a C programme:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#50fa7b">.intel_syntax</span> noprefix
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">.global</span> asm4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">asm4:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">push</span>   ebp
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    ebp,esp
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">push</span>   ebx
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">sub</span>    esp,<span style="color:#bd93f9">0x10</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    DWORD PTR [ebp-0x10],<span style="color:#bd93f9">0x27a</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    DWORD PTR [ebp-0xc],<span style="color:#bd93f9">0x0</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">jmp</span>    asm4+<span style="color:#bd93f9">27</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">add</span>    DWORD PTR [ebp-0xc],<span style="color:#bd93f9">0x1</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    edx,DWORD PTR [ebp-0xc]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">add</span>    eax,edx
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">movzx</span>  eax,BYTE PTR [eax]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">test</span>   al,al
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">jne</span>    asm4+<span style="color:#bd93f9">23</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    DWORD PTR [ebp-0x8],<span style="color:#bd93f9">0x1</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">jmp</span>    asm4+<span style="color:#bd93f9">138</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    edx,DWORD PTR [ebp-0x8]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">add</span>    eax,edx
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">movzx</span>  eax,BYTE PTR [eax]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">movsx</span>  edx,al
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp-0x8]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">lea</span>    ecx,[eax-0x1]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">add</span>    eax,ecx
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">movzx</span>  eax,BYTE PTR [eax]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">movsx</span>  eax,al
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">sub</span>    edx,eax
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    eax,edx
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    edx,eax
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp-0x10]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">lea</span>    ebx,[edx+eax*<span style="color:#bd93f9">1</span>]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp-0x8]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">lea</span>    edx,[eax+<span style="color:#bd93f9">0x1</span>]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">add</span>    eax,edx
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">movzx</span>  eax,BYTE PTR [eax]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">movsx</span>  edx,al
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    ecx,DWORD PTR [ebp-0x8]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp+<span style="color:#bd93f9">0x8</span>]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">add</span>    eax,ecx
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">movzx</span>  eax,BYTE PTR [eax]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">movsx</span>  eax,al
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">sub</span>    edx,eax
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    eax,edx
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">add</span>    eax,ebx
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    DWORD PTR [ebp-0x10],eax
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">add</span>    DWORD PTR [ebp-0x8],<span style="color:#bd93f9">0x1</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp-0xc]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">sub</span>    eax,<span style="color:#bd93f9">0x1</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">cmp</span>    DWORD PTR [ebp-0x8],eax
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">jl</span>     asm4+<span style="color:#bd93f9">51</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span>    eax,DWORD PTR [ebp-0x10]
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">add</span>    esp,<span style="color:#bd93f9">0x10</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">pop</span>    ebx
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">pop</span>    ebp
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">ret</span>
</span></span></code></pre></div><p>solver.c</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;stdio.h&gt;</span><span style="color:#ff79c6">
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6"></span><span style="color:#8be9fd">int</span> <span style="color:#50fa7b">main</span>(<span style="color:#8be9fd">int</span> argc, <span style="color:#8be9fd">char</span> <span style="color:#ff79c6">const</span> <span style="color:#ff79c6">*</span>argv[])
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">    1. Call asm4(). Passing the argument &#34;picoCTF_f97bb&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">    2. Now print the result after calling the function.
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">    3. Note: %x denotes hex output
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">    */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">printf</span>(<span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">Output =&gt; 0x%x</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, <span style="color:#50fa7b">asm4</span>(<span style="color:#f1fa8c">&#34;picoCTF_f97bb&#34;</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>makefile (use TAB to indent)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#50fa7b">all</span><span style="color:#ff79c6">:</span>
</span></span><span style="display:flex;"><span>    gcc -m32 -c test.S -o test.o -fno-stack-protector -no-pie
</span></span><span style="display:flex;"><span>    gcc -m32 -c solve.c -o solve.o -fno-stack-protector -no-pie
</span></span><span style="display:flex;"><span>    gcc -m32 -o a.out solve.o test.o -fno-stack-protector -no-pie
</span></span><span style="display:flex;"><span>    ./a.out
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">clean</span><span style="color:#ff79c6">:</span>
</span></span><span style="display:flex;"><span>    rm a.out *.o
</span></span></code></pre></div><p>now the file can be compiled and executed:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>make
</span></span><span style="display:flex;"><span>./a.out
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">Output</span> <span style="color:#ff79c6">=</span>&gt; 0x265
</span></span></code></pre></div>
      </div>
    </article>

    <hr />

    <div class="post-info">
      
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft/series/picoctf/">picoCTF</a></span>
        


      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft/categories/picoctf/">picoCTF</a></span>
        
    </p>


      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        4193 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2022-08-16 
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=PicoCTF2019%20-%20Reverse%20Engineering&amp;caption=PicoCTF2019%20-%20Reverse%20Engineering&amp;canonicalUrl=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=PicoCTF2019%20-%20Reverse%20Engineering&amp;body=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f&amp;media=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f;description=PicoCTF2019%20-%20Reverse%20Engineering" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f&amp;title=PicoCTF2019%20-%20Reverse%20Engineering&amp;summary=PicoCTF2019%20-%20Reverse%20Engineering&amp;source=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f&amp;resubmit=true&amp;title=PicoCTF2019%20-%20Reverse%20Engineering" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f;title=PicoCTF2019%20-%20Reverse%20Engineering" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=PicoCTF2019%20-%20Reverse%20Engineering%20https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f&amp;t=PicoCTF2019%20-%20Reverse%20Engineering" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=PicoCTF2019%20-%20Reverse%20Engineering&amp;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2022%2f08%2fpicoctf2019-reverse-engineering%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
<div class="pagination">
  
  <hr />
  <div class="pagination__buttons">
    
    <a href="https://0xade1.github.io/devdraft/posts/2022/08/picoctf2019-general-skills/" class="button next">
      <span class="button__icon">←</span>
      <span class="button__text">PicoCTF2019 - General Skills</span>
    </a>
     
    <a href="https://0xade1.github.io/devdraft/posts/2022/08/picoctf2019-web-exploitation/" class="button previous">
      <span class="button__text">PicoCTF2019 - Web-Exploitation</span>
      <span class="button__icon">→</span>
    </a>
    
  </div>
  <hr />
</div>



    

    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            <span><a href="https://0xade1.github.io/devdraft"></a></span>
            <span></span>
            <span><a href="https://0xade1.github.io/devdraft/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span><span>Made with &#10084;</span>
        </div>
    </div>
    
</footer>

            
        </div>

    



<script type="text/javascript" src="https://0xade1.github.io/devdraft/bundle.min.4037dc94fd1565c4fd3354e2b4a2d1ff11842c906242435350b4d2d8d6e8b7890da46c0a865173f543a6161c1f4d1c94147f1b907db36489fc2bf5e20d4af75c.js" integrity="sha512-QDfclP0VZcT9M1TitKLR/xGELJBiQkNTULTS2Nbot4kNpGwKhlFz9UOmFhwfTRyUFH8bkH2zZIn8K/XiDUr3XA=="></script>




    
    <div id="fastSearch">
      <ul id="searchResults"></ul>
      <input id="searchInput" tabindex="0" />
    </div>
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js"></script>
    
    <script src="https://0xade1.github.io/devdraft/js/fastsearch.js"></script>
  </body>
</html>
